(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{75557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(12270)}])},12270:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Home}});var r=n(85893),i=n(67294),o=n(22338),s=n(48783),a=n(57747),c=n(22757),l=n(14e3),d=n(70959),h=n(44461),u=n(24124),p=n(84028),x=n(90889),g=n(7963),m=n(14225),w=n(74926);let f={DEPOSIT_AMOUNT:{amount:"1000000",denom:"ujuno"},CONTRACT_ADDRESS:"juno15vm69hpaze0njycf2u2zm30dh39hjtqvd75snhzz447arftqvrcs6hjthg",CHAIN_CONFIG:{chainId:"juno-1",chainName:"Juno",rpcEndpoint:"https://rpc-juno.itastakers.com:443/",gasPrice:{amount:"0.025",denom:"ujuno"}}};var components_WalletConnect=e=>{let{onConnect:t}=e,[n,o]=(0,i.useState)(!1),s=(0,g.p)(),connectKeplr=async()=>{try{if(o(!0),!window.keplr)throw Error("Please install Keplr extension");await window.keplr.enable(f.CHAIN_CONFIG.chainId);let e=await window.keplr.getOfflineSignerAuto(f.CHAIN_CONFIG.chainId),n=await e.getAccounts();if(!n||0===n.length)throw Error("No accounts found");let r=await w.Fl.connectWithSigner(f.CHAIN_CONFIG.rpcEndpoint,e,{gasPrice:f.CHAIN_CONFIG.gasPrice}),i=await e.getAccounts();if(!i||0===i.length)throw Error("Failed to get accounts from signer");t({client:r,address:n[0].address,signer:e}),s({title:"Connected!",description:"Connected to ".concat(n[0].address.slice(0,8),"...").concat(n[0].address.slice(-8)),status:"success",duration:5e3,isClosable:!0})}catch(e){console.error("Connection error:",e),s({title:"Connection Failed",description:e.message,status:"error",duration:5e3,isClosable:!0})}finally{o(!1)}};return(0,r.jsx)(m.z,{colorScheme:"teal",onClick:connectKeplr,isLoading:n,loadingText:"Connecting...",children:"Connect Wallet"})},j=n(74153),C=n(7405),S=n(85970),y=n(5418),N=n(71025),b=n(34292),D=n(3536),_=n(21876).Buffer,mixer_Deposit=e=>{let{client:t,contractAddress:n}=e,[o,c]=(0,i.useState)(!1),[d,h]=(0,i.useState)(""),u=(0,D.N)(),p=(0,g.p)(),handleDeposit=async()=>{try{if(c(!0),!t)throw Error("Wallet is not connected");if(!d)throw Error("Please generate a secret first");let[e]=await t.signer.getAccounts();if(!e)throw Error("No account found. Please check your wallet connection");let r=BigInt("0x"+d),i=u.F.toString(u([r])),o=i.toString();console.log("Secret:",d),console.log("Commitment:",o),console.log("Sender Address:",e.address);let s={amount:[{denom:f.DEPOSIT_AMOUNT.denom,amount:"500000"}],gas:"200000"};await t.execute(e.address,n,{deposit:{commitment:o}},s,"Deposit to privacy mixer",[f.DEPOSIT_AMOUNT]),p({title:"Deposit Successful!",description:"Please download your secret if you haven't already.",status:"success",duration:5e3,isClosable:!0});let a={secret:d,commitment:o,timestamp:Date.now()},l=JSON.parse(localStorage.getItem("deposits")||"[]");l.push(a),localStorage.setItem("deposits",JSON.stringify(l))}catch(e){console.error("Deposit error:",e),p({title:"Deposit Failed",description:e.message,status:"error",duration:5e3,isClosable:!0})}finally{c(!1)}};return t?(0,r.jsx)(a.xu,{p:6,borderWidth:1,borderRadius:"lg",children:(0,r.jsxs)(s.g,{spacing:4,align:"stretch",children:[(0,r.jsx)(l.x,{fontSize:"xl",fontWeight:"bold",children:"Deposit Funds"}),(0,r.jsxs)(S.NI,{children:[(0,r.jsx)(y.l,{children:"Secret"}),(0,r.jsx)(N.I,{value:d,isReadOnly:!0,placeholder:"Generate a random secret"})]}),(0,r.jsxs)(l.x,{fontSize:"sm",color:"gray.600",children:["Deposit amount: ",parseInt(f.DEPOSIT_AMOUNT.amount)/1e6," ",f.DEPOSIT_AMOUNT.denom.replace("u","").toUpperCase()]}),(0,r.jsxs)(b.U,{spacing:4,children:[(0,r.jsx)(m.z,{colorScheme:"blue",onClick:()=>{let e=new Uint8Array(32);crypto.getRandomValues(e);let t=_.from(e).toString("hex");h(t)},isDisabled:o,flex:"1",children:"Generate Random Secret"}),(0,r.jsx)(m.z,{colorScheme:"teal",onClick:()=>{if(!d)return;let e=new Blob([d],{type:"text/plain"}),t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="mixer-secret-".concat(Date.now(),".txt"),document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(t),document.body.removeChild(n),p({title:"Secret Downloaded",description:"Keep this file safe! You will need it to withdraw your funds.",status:"success",duration:5e3,isClosable:!0})},isDisabled:!d,flex:"1",children:"Download Secret"})]}),(0,r.jsx)(m.z,{colorScheme:"green",onClick:handleDeposit,isLoading:o,loadingText:"Depositing...",isDisabled:!d,children:"Deposit"})]})}):(0,r.jsx)(a.xu,{p:6,borderWidth:1,borderRadius:"lg",children:(0,r.jsxs)(j.b,{status:"warning",children:[(0,r.jsx)(C.z,{}),"Please connect your wallet to make a deposit"]})})},mixer_Withdraw=e=>{let{client:t,contractAddress:n}=e,[o,c]=(0,i.useState)(""),[l,d]=(0,i.useState)(""),[h,u]=(0,i.useState)(!1),p=(0,D.N)(),x=(0,g.p)(),handleWithdraw=async()=>{if(o&&l)try{u(!0);let e=BigInt("0x"+o);p.F.toString(p([e]));let t=await fetch("".concat("http://localhost:3001","/relay-withdrawal"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({note:{secret:o,recipient:l}})});if(!t.ok){let e=await t.json();throw Error(e.details||e.error||"Failed to process withdrawal")}let n=await t.json();x({title:"Withdrawal successful",description:"Transaction hash: ".concat(n.txHash),status:"success",duration:5e3}),c(""),d("")}catch(e){console.error("Withdrawal error:",e),x({title:"Withdrawal failed",description:e.message,status:"error",duration:5e3})}finally{u(!1)}};return(0,r.jsx)(a.xu,{p:4,children:(0,r.jsxs)(s.g,{spacing:4,align:"stretch",children:[(0,r.jsxs)(S.NI,{children:[(0,r.jsx)(y.l,{children:"Upload Secret File"}),(0,r.jsx)(N.I,{type:"file",accept:".txt",onChange:e=>{let t=e.target.files[0];if(t){let e=new FileReader;e.onload=e=>{try{let t=e.target.result.trim();c(t)}catch(e){x({title:"Error reading file",description:"Could not read the secret file",status:"error",duration:5e3})}},e.readAsText(t)}},p:1})]}),(0,r.jsxs)(S.NI,{children:[(0,r.jsx)(y.l,{children:"Recipient Address"}),(0,r.jsx)(N.I,{value:l,onChange:e=>d(e.target.value),placeholder:"juno..."})]}),(0,r.jsx)(m.z,{colorScheme:"blue",onClick:handleWithdraw,isLoading:h,loadingText:"Withdrawing...",isDisabled:!o||!l,children:"Withdraw"})]})})};function Home(){let[e,t]=(0,i.useState)(null);return(0,r.jsx)(o.W,{maxW:"container.xl",py:10,children:(0,r.jsxs)(s.g,{spacing:8,children:[(0,r.jsxs)(a.xu,{textAlign:"center",children:[(0,r.jsx)(c.X,{mb:4,children:"Privacy Mixer"}),(0,r.jsx)(l.x,{mb:8,children:"A secure way to maintain transaction privacy on the blockchain"}),!e&&(0,r.jsx)(components_WalletConnect,{onConnect:e=>{t(e)}}),e&&(0,r.jsxs)(l.x,{mb:4,children:["Connected: ",e.address.slice(0,8),"...",e.address.slice(-8)]})]}),e&&(0,r.jsxs)(d.m,{isFitted:!0,variant:"enclosed",width:"100%",children:[(0,r.jsxs)(h.t,{mb:"1em",children:[(0,r.jsx)(u.O,{children:"Deposit"}),(0,r.jsx)(u.O,{children:"Withdraw"})]}),(0,r.jsxs)(p.n,{children:[(0,r.jsx)(x.x,{children:(0,r.jsx)(mixer_Deposit,{client:e.client,contractAddress:"juno15vm69hpaze0njycf2u2zm30dh39hjtqvd75snhzz447arftqvrcs6hjthg"})}),(0,r.jsx)(x.x,{children:(0,r.jsx)(mixer_Withdraw,{client:e.client,contractAddress:f.CONTRACT_ADDRESS})})]})]})]})})}},46601:function(){},89214:function(){},85568:function(){},20131:function(){},16026:function(){}},function(e){e.O(0,[631,714,417,35,794,286,774,888,179],function(){return e(e.s=75557)}),_N_E=e.O()}]);