"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[494],{44913:function(t,a,e){e.d(a,{FX:function(){return ZqField},Ru:function(){return z},qM:function(){return getCurveFromName},utils:function(){return R}});let l=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function fromString(t,a){return a&&10!=a?16==a?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}function bitLength$6(t){let a=t.toString(16);return(a.length-1)*4+l[parseInt(a[0],16)]}function isNegative$4(t){return BigInt(t)<BigInt(0)}function isZero$1(t){return!t}function shiftLeft(t,a){return BigInt(t)<<BigInt(a)}function shiftRight(t,a){return BigInt(t)>>BigInt(a)}function isOdd$5(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function bits(t){let a=BigInt(t),e=[];for(;a;)a&BigInt(1)?e.push(1):e.push(0),a>>=BigInt(1);return e}function toNumber$1(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw Error("Number too big");return Number(t)}function add(t,a){return BigInt(t)+BigInt(a)}function sub(t,a){return BigInt(t)-BigInt(a)}function neg(t){return-BigInt(t)}function mul(t,a){return BigInt(t)*BigInt(a)}function pow(t,a){return BigInt(t)**BigInt(a)}function div(t,a){return BigInt(t)/BigInt(a)}function mod(t,a){return BigInt(t)%BigInt(a)}function eq(t,a){return BigInt(t)==BigInt(a)}function gt(t,a){return BigInt(t)>BigInt(a)}function geq(t,a){return BigInt(t)>=BigInt(a)}function band(t,a){return BigInt(t)&BigInt(a)}function toRprLE(t,a,e,l){let o="0000000"+e.toString(16),i=new Uint32Array(t.buffer,t.byteOffset+a,l/4),c=((o.length-7)*4-1>>5)+1;for(let t=0;t<c;t++)i[t]=parseInt(o.substring(o.length-8*t-8,o.length-8*t),16);for(let t=c;t<i.length;t++)i[t]=0;for(let a=4*i.length;a<l;a++)t[a]=toNumber$1(band(shiftRight(e,8*a),255))}function toRprBE(t,a,e,l){let o="0000000"+e.toString(16),i=new DataView(t.buffer,t.byteOffset+a,l),c=((o.length-7)*4-1>>5)+1;for(let t=0;t<c;t++)i.setUint32(l-4*t-4,parseInt(o.substring(o.length-8*t-8,o.length-8*t),16),!1);for(let t=0;t<l/4-c;t++)i[t]=0}function fromRprLE(t,a,e){e=e||t.byteLength,a=a||0;let l=new Uint32Array(t.buffer,t.byteOffset+a,e/4),o=Array(e/4);return l.forEach((t,a)=>o[o.length-a-1]=t.toString(16).padStart(8,"0")),fromString(o.join(""),16)}function fromRprBE(t,a,e){e=e||t.byteLength,a=a||0;let l=new DataView(t.buffer,t.byteOffset+a,e),o=Array(e/4);for(let t=0;t<e/4;t++)o[t]=l.getUint32(4*t,!1).toString(16).padStart(8,"0");return fromString(o.join(""),16)}function toString(t,a){return t.toString(a)}function toLEBuff(t){let a=new Uint8Array(Math.floor((bitLength$6(t)-1)/8)+1);return toRprLE(a,0,t,a.byteLength),a}let o=fromString(0),i=fromString(1);var c,n=Object.freeze({__proto__:null,abs:function(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)},add:add,band:band,bitLength:bitLength$6,bits:bits,bor:function(t,a){return BigInt(t)|BigInt(a)},bxor:function(t,a){return BigInt(t)^BigInt(a)},div:div,e:fromString,eq:eq,exp:function(t,a){return BigInt(t)**BigInt(a)},fromArray:function(t,a){let e=BigInt(0);a=BigInt(a);for(let l=0;l<t.length;l++)e=e*a+BigInt(t[l]);return e},fromRprBE:fromRprBE,fromRprLE:fromRprLE,fromString:fromString,geq:geq,gt:gt,isNegative:isNegative$4,isOdd:isOdd$5,isZero:isZero$1,land:function(t,a){return BigInt(t)&&BigInt(a)},leq:function(t,a){return BigInt(t)<=BigInt(a)},lnot:function(t){return!BigInt(t)},lor:function(t,a){return BigInt(t)||BigInt(a)},lt:function(t,a){return BigInt(t)<BigInt(a)},mod:mod,mul:mul,naf:function(t){let a=BigInt(t),e=[];for(;a;){if(a&BigInt(1)){let t=2-Number(a%BigInt(4));e.push(t),a-=BigInt(t)}else e.push(0);a>>=BigInt(1)}return e},neg:neg,neq:function(t,a){return BigInt(t)!=BigInt(a)},one:i,pow:pow,shiftLeft:shiftLeft,shiftRight:shiftRight,shl:shiftLeft,shr:shiftRight,square:function(t){return BigInt(t)*BigInt(t)},sub:sub,toArray:function(t,a){let e=[],l=BigInt(t);for(a=BigInt(a);l;)e.unshift(Number(l%a)),l/=a;return e},toLEBuff:toLEBuff,toNumber:toNumber$1,toRprBE:toRprBE,toRprLE:toRprLE,toString:toString,zero:o});let d=[];for(let t=0;t<256;t++)d[t]=function(t,a){let e=0,l=t;for(let t=0;t<8;t++)e<<=1,e|=1&l,l>>=1;return e}(t,0);function exp(t,a,e){if(isZero$1(e))return t.one;let l=bits(e);if(0==l.length)return t.one;let o=a;for(let e=l.length-2;e>=0;e--)o=t.square(o),l[e]&&(o=t.mul(o,a));return o}function quarterRound(t,a,e,l,o){t[a]=t[a]+t[e]>>>0,t[o]=(t[o]^t[a])>>>0,t[o]=(t[o]<<16|t[o]>>>16&65535)>>>0,t[l]=t[l]+t[o]>>>0,t[e]=(t[e]^t[l])>>>0,t[e]=(t[e]<<12|t[e]>>>20&4095)>>>0,t[a]=t[a]+t[e]>>>0,t[o]=(t[o]^t[a])>>>0,t[o]=(t[o]<<8|t[o]>>>24&255)>>>0,t[l]=t[l]+t[o]>>>0,t[e]=(t[e]^t[l])>>>0,t[e]=(t[e]<<7|t[e]>>>25&127)>>>0}let ChaCha=class ChaCha{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return add(mul(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(1&this.nextU32())==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let a=0;a<10;a++){var t;quarterRound(t=this.buff,0,4,8,12),quarterRound(t,1,5,9,13),quarterRound(t,2,6,10,14),quarterRound(t,3,7,11,15),quarterRound(t,0,5,10,15),quarterRound(t,1,6,11,12),quarterRound(t,2,7,8,13),quarterRound(t,3,4,9,14)}for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}};function getRandomBytes(t){let a=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(a);else for(let e=0;e<t;e++)a[e]=4294967296*Math.random()>>>0;return a}let r=null;function getThreadRng(){return r||(r=new ChaCha(function(){let t=getRandomBytes(32),a=new Uint32Array(t.buffer),e=[];for(let t=0;t<8;t++)e.push(a[t]);return e}()))}let FFT=class FFT{constructor(t,a,e){this.F=a,this.G=t,this.opMulGF=e;let l=a.sqrt_t||a.t,o=a.sqrt_s||a.s,i=a.one;for(;a.eq(a.pow(i,a.half),a.one);)i=a.add(i,a.one);this.w=Array(o+1),this.wi=Array(o+1),this.w[o]=this.F.pow(i,l),this.wi[o]=this.F.inv(this.w[o]);let c=o-1;for(;c>=0;)this.w[c]=this.F.square(this.w[c+1]),this.wi[c]=this.F.square(this.wi[c+1]),c--;this.roots=[],this._setRoots(Math.min(o,15))}_setRoots(t){for(let a=t;a>=0&&!this.roots[a];a--){let t=this.F.one,e=1<<a,l=Array(e);for(let o=0;o<e;o++)l[o]=t,t=this.F.mul(t,this.w[a]);this.roots[a]=l}}fft(t){if(t.length<=1)return t;let a=log2$1(t.length-1)+1;this._setRoots(a);let e=1<<a;if(t.length!=e)throw Error("Size must be multiple of 2");let l=__fft(this,t,a,0,1);return l}ifft(t){if(t.length<=1)return t;let a=log2$1(t.length-1)+1;this._setRoots(a);let e=1<<a;if(t.length!=e)throw Error("Size must be multiple of 2");let l=__fft(this,t,a,0,1),o=this.F.inv(this.F.mulScalar(this.F.one,e)),i=Array(e);for(let t=0;t<e;t++)i[t]=this.opMulGF(l[(e-t)%e],o);return i}};function log2$1(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function __fft(t,a,e,l,o){let i=1<<e;if(1==i)return[a[l]];if(2==i)return[t.G.add(a[l],a[l+o]),t.G.sub(a[l],a[l+o])];let c=i>>1,n=__fft(t,a,e-1,l,2*o),d=__fft(t,a,e-1,l+o,2*o),r=Array(i);for(let a=0;a<c;a++)r[a]=t.G.add(n[a],t.opMulGF(d[a],t.roots[e][a])),r[a+c]=t.G.sub(n[a],t.opMulGF(d[a],t.roots[e][a]));return r}let ZqField=class ZqField{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=bitLength$6(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=2*this.n64,this.n8=8*this.n64,this.R=this.e(this.one<<BigInt(64*this.n64)),this.Ri=this.inv(this.R);let a=this.negone>>this.one;this.nqr=this.two;let e=this.pow(this.nqr,a);for(;!this.eq(e,this.negone);)this.nqr=this.nqr+this.one,e=this.pow(this.nqr,a);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),function(t){if(t.m%2==1){if(eq(mod(t.p,4),1)){if(eq(mod(t.p,8),1)){if(eq(mod(t.p,16),1))(function(t){for(t.sqrt_q=pow(t.p,t.m),t.sqrt_s=0,t.sqrt_t=sub(t.sqrt_q,1);!isOdd$5(t.sqrt_t);)t.sqrt_s=t.sqrt_s+1,t.sqrt_t=div(t.sqrt_t,2);let a=t.one;for(;t.eq(a,t.one);){let e=t.random();t.sqrt_z=t.pow(e,t.sqrt_t),a=t.pow(t.sqrt_z,2**(t.sqrt_s-1))}t.sqrt_tm1d2=div(sub(t.sqrt_t,1),2),t.sqrt=function(t){if(this.isZero(t))return this.zero;let a=this.pow(t,this.sqrt_tm1d2),e=this.pow(this.mul(this.square(a),t),2**(this.sqrt_s-1));if(this.eq(e,this.negone))return null;let l=this.sqrt_s,o=this.mul(t,a),i=this.mul(o,a),c=this.sqrt_z;for(;!this.eq(i,this.one);){let t=this.square(i),e=1;for(;!this.eq(t,this.one);)t=this.square(t),e++;a=c;for(let t=0;t<l-e-1;t++)a=this.square(a);c=this.square(a),i=this.mul(i,c),o=this.mul(o,a),l=e}return this.geq(o,this.zero)?o:this.neg(o)}})(t);else if(eq(mod(t.p,16),9))t.sqrt=function(){throw Error("Sqrt alg 4 not implemented")};else throw Error("Field withot sqrt")}else if(eq(mod(t.p,8),5))t.sqrt=function(){throw Error("Sqrt alg 3 not implemented")};else throw Error("Field withot sqrt")}else eq(mod(t.p,4),3)&&(t.sqrt_q=pow(t.p,t.m),t.sqrt_e1=div(sub(t.sqrt_q,3),4),t.sqrt=function(a){if(this.isZero(a))return this.zero;let e=this.pow(a,this.sqrt_e1),l=this.mul(this.square(e),a);if(this.eq(l,this.negone))return null;let o=this.mul(e,a);return t.geq(o,t.zero)?o:t.neg(o)})}else{let a=mod(pow(t.p,t.m/2),4);1==a?t.sqrt=function(){throw Error("Sqrt alg 10 not implemented")}:3==a?(t.sqrt_q=pow(t.p,t.m/2),t.sqrt_e34=div(sub(t.sqrt_q,3),4),t.sqrt_e12=div(sub(t.sqrt_q,1),2),t.frobenius=function(a,e){return a%2==1?t.conjugate(e):e},t.sqrt=function(t){let a;let e=this.pow(t,this.sqrt_e34),l=this.mul(this.square(e),t),o=this.mul(this.frobenius(1,l),l);if(this.eq(o,this.negone))return null;let i=this.mul(e,t);if(this.eq(l,this.negone))a=this.mul(i,[this.F.zero,this.F.one]);else{let t=this.pow(this.add(this.one,l),this.sqrt_e12);a=this.mul(t,i)}return this.geq(a,this.zero)?a:this.neg(a)}):t.sqrt=function(){throw Error("Sqrt alg 8 not implemented")}}}(this),this.FFT=new FFT(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,a){let e;if(a?16==a&&(e=BigInt("0x"+t)):e=BigInt(t),!(e<0))return e>=this.p?e%this.p:e;{let t=-e;return t>=this.p&&(t%=this.p),this.p-t}}add(t,a){let e=t+a;return e>=this.p?e-this.p:e}sub(t,a){return t>=a?t-a:this.p-a+t}neg(t){return t?this.p-t:t}mul(t,a){return t*a%this.p}mulScalar(t,a){return t*this.e(a)%this.p}square(t){return t*t%this.p}eq(t,a){return t==a}neq(t,a){return t!=a}lt(t,a){let e=t>this.half?t-this.p:t,l=a>this.half?a-this.p:a;return e<l}gt(t,a){let e=t>this.half?t-this.p:t,l=a>this.half?a-this.p:a;return e>l}leq(t,a){let e=t>this.half?t-this.p:t,l=a>this.half?a-this.p:a;return e<=l}geq(t,a){let e=t>this.half?t-this.p:t,l=a>this.half?a-this.p:a;return e>=l}div(t,a){return this.mul(t,this.inv(a))}idiv(t,a){if(!a)throw Error("Division by zero");return t/a}inv(t){if(!t)throw Error("Division by zero");let a=this.zero,e=this.p,l=this.one,o=t%this.p;for(;o;){let t=e/o;[a,l]=[l,a-t*l],[e,o]=[o,e-t*o]}return a<this.zero&&(a+=this.p),a}mod(t,a){return t%a}pow(t,a){return exp(this,t,a)}exp(t,a){return exp(this,t,a)}band(t,a){let e=t&a&this.mask;return e>=this.p?e-this.p:e}bor(t,a){let e=(t|a)&this.mask;return e>=this.p?e-this.p:e}bxor(t,a){let e=(t^a)&this.mask;return e>=this.p?e-this.p:e}bnot(t){let a=t^this.mask;return a>=this.p?a-this.p:a}shl(t,a){if(Number(a)<this.bitLength){let e=t<<a&this.mask;return e>=this.p?e-this.p:e}{let e=this.p-a;return Number(e)<this.bitLength?t>>e:this.zero}}shr(t,a){if(Number(a)<this.bitLength)return t>>a;{let e=this.p-a;if(!(Number(e)<this.bitLength))return 0;{let a=t<<e&this.mask;return a>=this.p?a-this.p:a}}}land(t,a){return t&&a?this.one:this.zero}lor(t,a){return t||a?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;let a=this.pow(t,this.negone>>this.one);if(a!=this.one)return null;let e=this.s,l=this.nqr_to_t,o=this.pow(t,this.t),i=this.pow(t,this.add(this.t,this.one)>>this.one);for(;o!=this.one;){let t=this.square(o),a=1;for(;t!=this.one;)a++,t=this.square(t);let c=l;for(let t=0;t<e-a-1;t++)c=this.square(c);e=a,l=this.square(c),o=this.mul(o,l),i=this.mul(i,c)}return i>this.p>>this.one&&(i=this.neg(i)),i}normalize(t,a){if(!((t=BigInt(t,a))<0))return t>=this.p?t%this.p:t;{let a=-t;return a>=this.p&&(a%=this.p),this.p-a}}random(){let t=2*this.bitLength/8,a=this.zero;for(let e=0;e<t;e++)a=(a<<BigInt(8))+BigInt(getRandomBytes(1)[0]);return a%this.p}toString(t,a){let e;if(a=a||10,t>this.half&&10==a){let l=this.p-t;e="-"+l.toString(a)}else e=t.toString(a);return e}isZero(t){return t==this.zero}fromRng(t){let a;do{a=this.zero;for(let e=0;e<this.n64;e++)a+=t.nextU64()<<BigInt(64*e);a&=this.mask}while(a>=this.p);return a*this.Ri%this.p}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,a,e){toRprLE(t,a,e,8*this.n64)}toRprBE(t,a,e){toRprBE(t,a,e,8*this.n64)}toRprBEM(t,a,e){return this.toRprBE(t,a,this.mul(this.R,e))}toRprLEM(t,a,e){return this.toRprLE(t,a,this.mul(this.R,e))}fromRprLE(t,a){return fromRprLE(t,a,this.n8)}fromRprBE(t,a){return fromRprBE(t,a,this.n8)}fromRprLEM(t,a){return this.mul(this.fromRprLE(t,a),this.Ri)}fromRprBEM(t,a){return this.mul(this.fromRprBE(t,a),this.Ri)}toObject(t){return t}};var s={};s.bigInt2BytesLE=function(t,a){let e=Array(a),l=BigInt(t);for(let t=0;t<a;t++)e[t]=Number(255n&l),l>>=8n;return e},s.bigInt2U32LE=function(t,a){let e=Array(a),l=BigInt(t);for(let t=0;t<a;t++)e[t]=Number(4294967295n&l),l>>=32n;return e},s.isOcamNum=function(t){return!!(Array.isArray(t)&&3==t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&Array.isArray(t[2]))};var build_timesscalar=function(t,a,e,l,o,i,c){let n=t.addFunction(a);n.addParam("base","i32"),n.addParam("scalar","i32"),n.addParam("scalarLength","i32"),n.addParam("r","i32"),n.addLocal("i","i32"),n.addLocal("b","i32");let d=n.getCodeBuilder(),r=d.i32_const(t.alloc(e));n.addCode(d.if(d.i32_eqz(d.getLocal("scalarLength")),[...d.call(c,d.getLocal("r")),...d.ret([])])),n.addCode(d.call(i,d.getLocal("base"),r)),n.addCode(d.call(c,d.getLocal("r"))),n.addCode(d.setLocal("i",d.getLocal("scalarLength"))),n.addCode(d.block(d.loop(d.setLocal("i",d.i32_sub(d.getLocal("i"),d.i32_const(1))),d.setLocal("b",d.i32_load8_u(d.i32_add(d.getLocal("scalar"),d.getLocal("i")))),...function(){let t=[];for(let a=0;a<8;a++)t.push(...d.call(o,d.getLocal("r"),d.getLocal("r")),...d.if(d.i32_ge_u(d.getLocal("b"),d.i32_const(128>>a)),[...d.setLocal("b",d.i32_sub(d.getLocal("b"),d.i32_const(128>>a))),...d.call(l,d.getLocal("r"),r,d.getLocal("r"))]));return t}(),d.br_if(1,d.i32_eqz(d.getLocal("i"))),d.br(0))))};function buildBatchInverse$3(t,a){let e=8*t.modules[a].n64,l=t.addFunction(a+"_batchInverse");l.addParam("pIn","i32"),l.addParam("inStep","i32"),l.addParam("n","i32"),l.addParam("pOut","i32"),l.addParam("outStep","i32"),l.addLocal("itAux","i32"),l.addLocal("itIn","i32"),l.addLocal("itOut","i32"),l.addLocal("i","i32");let o=l.getCodeBuilder(),i=o.i32_const(t.alloc(e));l.addCode(o.setLocal("itAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("itAux"),o.i32_mul(o.i32_add(o.getLocal("n"),o.i32_const(1)),o.i32_const(e))))),l.addCode(o.call(a+"_one",o.getLocal("itAux")),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(e))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(a+"_isZero",o.getLocal("itIn")),o.call(a+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(e)),o.getLocal("itAux")),o.call(a+"_mul",o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(e)),o.getLocal("itAux"))),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(e))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(e))),o.setLocal("itOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("outStep")))),o.call(a+"_inverse",o.getLocal("itAux"),o.getLocal("itAux")),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.if(o.call(a+"_isZero",o.getLocal("itIn")),[...o.call(a+"_copy",o.getLocal("itAux"),o.i32_sub(o.getLocal("itAux"),o.i32_const(e))),...o.call(a+"_zero",o.getLocal("itOut"))],[...o.call(a+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(e)),i),...o.call(a+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(e))),...o.call(a+"_mul",o.getLocal("itAux"),i,o.getLocal("itOut"))]),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itOut",o.i32_sub(o.getLocal("itOut"),o.getLocal("outStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(e))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),l.addCode(o.i32_store(o.i32_const(0),o.getLocal("itAux")))}function buildBatchConvertion$3(t,a,e,l,o,i){void 0===i&&(i=l<o);let c=t.addFunction(a);c.addParam("pIn","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn","i32"),c.addLocal("itOut","i32");let n=c.getCodeBuilder();i?c.addCode(n.setLocal("itIn",n.i32_add(n.getLocal("pIn"),n.i32_mul(n.i32_sub(n.getLocal("n"),n.i32_const(1)),n.i32_const(l)))),n.setLocal("itOut",n.i32_add(n.getLocal("pOut"),n.i32_mul(n.i32_sub(n.getLocal("n"),n.i32_const(1)),n.i32_const(o)))),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("n"))),n.call(e,n.getLocal("itIn"),n.getLocal("itOut")),n.setLocal("itIn",n.i32_sub(n.getLocal("itIn"),n.i32_const(l))),n.setLocal("itOut",n.i32_sub(n.getLocal("itOut"),n.i32_const(o))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0)))):c.addCode(n.setLocal("itIn",n.getLocal("pIn")),n.setLocal("itOut",n.getLocal("pOut")),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("n"))),n.call(e,n.getLocal("itIn"),n.getLocal("itOut")),n.setLocal("itIn",n.i32_add(n.getLocal("itIn"),n.i32_const(l))),n.setLocal("itOut",n.i32_add(n.getLocal("itOut"),n.i32_const(o))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}var _={};function compare(t,a){return t===a?0:t>a?1:-1}function isOdd$4(t){return t%2n!==0n}function isEven(t){return t%2n===0n}function bitLength$5(t){return t<0n?t.toString(2).length-1:t.toString(2).length}function abs(t){return t<0n?-t:t}function isUnit(t){return 1n===abs(t)}function modInv$3(t,a){for(var e,l,o,i=0n,c=1n,n=a,d=abs(t);0n!==d;)e=n/d,l=i,o=n,i=c,n=d,c=l-e*c,d=o-e*d;if(!isUnit(n))throw Error(t.toString()+" and "+a.toString()+" are not co-prime");return(-1===compare(i,0n)&&(i+=a),t<0n)?-i:i}function modPow$2(t,a,e){if(0n===e)throw Error("Cannot take modPow with modulus 0");var l,o=1n,i=t%e;for(a<0n&&(a=-(1n*a),i=modInv$3(i,e));a>0n;){if(0n===i)return 0n;isOdd$4(a)&&(o=o*i%e),a/=2n,i=(l=i)*l%e}return o}function isDivisibleBy(t,a){var e,l;return 0n!==a&&(!!isUnit(a)||(0==(l=2n,(e=(e=a)>=0n?e:-e)===(l=l>=0n?l:-l)?0:e>l?1:-1)?isEven(t):t%a===0n))}function millerRabinTest(t,a){for(var e,l,o,i,c=t-1n,n=c,d=0;isEven(n);)n/=2n,d++;t:for(o=0;o<a.length;o++)if(!(t<a[o])&&!isUnit(i=modPow$2(BigInt(a[o]),n,t))&&i!==c){for(l=d-1;0!=l&&!isUnit(i=(e=i)*e%t);l--)if(i===c)continue t;return!1}return!0}_.bitLength=bitLength$5,_.isOdd=isOdd$4,_.isNegative=function(t){return t<0n},_.abs=abs,_.isUnit=isUnit,_.compare=compare,_.modInv=modInv$3,_.modPow=modPow$2,_.isPrime=function(t){var a,e=!isUnit(a=abs(t))&&(2n===a||3n===a||5n===a||!(isEven(a)||isDivisibleBy(a,3n)||isDivisibleBy(a,5n))&&(a<49n||void 0));if(void 0!==e)return e;var l=abs(t),o=bitLength$5(l);if(o<=64)return millerRabinTest(l,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var i=Math.ceil(Math.log(2)*Number(o)),c=[],n=0;n<i;n++)c.push(BigInt(n+2));return millerRabinTest(l,c)},_.square=function(t){return t*t};let buildInt=function(t,a,e){let l=e||"int";if(t.modules[l])return l;t.modules[l]={};let o=2*a,i=8*a;return!function(){let e=t.addFunction(l+"_copy");e.addParam("px","i32"),e.addParam("pr","i32");let o=e.getCodeBuilder();for(let t=0;t<a;t++)e.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_load(o.getLocal("px"),8*t)))}(),!function(){let e=t.addFunction(l+"_zero");e.addParam("pr","i32");let o=e.getCodeBuilder();for(let t=0;t<a;t++)e.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_const(0)))}(),!function(){let e=t.addFunction(l+"_isZero");e.addParam("px","i32"),e.setReturnType("i32");let o=e.getCodeBuilder();e.addCode(function getCompCode(t){return 0==t?o.ret(o.i64_eqz(o.i64_load(o.getLocal("px")))):o.if(o.i64_eqz(o.i64_load(o.getLocal("px"),8*t)),getCompCode(t-1),o.ret(o.i32_const(0)))}(a-1)),e.addCode(o.ret(o.i32_const(0)))}(),!function(){let e=t.addFunction(l+"_one");e.addParam("pr","i32");let o=e.getCodeBuilder();e.addCode(o.i64_store(o.getLocal("pr"),0,o.i64_const(1)));for(let t=1;t<a;t++)e.addCode(o.i64_store(o.getLocal("pr"),8*t,o.i64_const(0)))}(),!function(){let e=t.addFunction(l+"_eq");e.addParam("px","i32"),e.addParam("py","i32"),e.setReturnType("i32");let o=e.getCodeBuilder();e.addCode(function getCompCode(t){return 0==t?o.ret(o.i64_eq(o.i64_load(o.getLocal("px")),o.i64_load(o.getLocal("py")))):o.if(o.i64_eq(o.i64_load(o.getLocal("px"),8*t),o.i64_load(o.getLocal("py"),8*t)),getCompCode(t-1),o.ret(o.i32_const(0)))}(a-1)),e.addCode(o.ret(o.i32_const(0)))}(),!function(){let e=t.addFunction(l+"_gte");e.addParam("px","i32"),e.addParam("py","i32"),e.setReturnType("i32");let o=e.getCodeBuilder();e.addCode(function getCompCode(t){return 0==t?o.ret(o.i64_ge_u(o.i64_load(o.getLocal("px")),o.i64_load(o.getLocal("py")))):o.if(o.i64_lt_u(o.i64_load(o.getLocal("px"),8*t),o.i64_load(o.getLocal("py"),8*t)),o.ret(o.i32_const(0)),o.if(o.i64_gt_u(o.i64_load(o.getLocal("px"),8*t),o.i64_load(o.getLocal("py"),8*t)),o.ret(o.i32_const(1)),getCompCode(t-1)))}(a-1)),e.addCode(o.ret(o.i32_const(0)))}(),!function(){let a=t.addFunction(l+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.setReturnType("i32"),a.addLocal("c","i64");let e=a.getCodeBuilder();a.addCode(e.setLocal("c",e.i64_add(e.i64_load32_u(e.getLocal("x")),e.i64_load32_u(e.getLocal("y"))))),a.addCode(e.i64_store32(e.getLocal("r"),e.getLocal("c")));for(let t=1;t<o;t++)a.addCode(e.setLocal("c",e.i64_add(e.i64_add(e.i64_load32_u(e.getLocal("x"),4*t),e.i64_load32_u(e.getLocal("y"),4*t)),e.i64_shr_u(e.getLocal("c"),e.i64_const(32))))),a.addCode(e.i64_store32(e.getLocal("r"),4*t,e.getLocal("c")));a.addCode(e.i32_wrap_i64(e.i64_shr_u(e.getLocal("c"),e.i64_const(32))))}(),!function(){let a=t.addFunction(l+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.setReturnType("i32"),a.addLocal("c","i64");let e=a.getCodeBuilder();a.addCode(e.setLocal("c",e.i64_sub(e.i64_load32_u(e.getLocal("x")),e.i64_load32_u(e.getLocal("y"))))),a.addCode(e.i64_store32(e.getLocal("r"),e.i64_and(e.getLocal("c"),e.i64_const("0xFFFFFFFF"))));for(let t=1;t<o;t++)a.addCode(e.setLocal("c",e.i64_add(e.i64_sub(e.i64_load32_u(e.getLocal("x"),4*t),e.i64_load32_u(e.getLocal("y"),4*t)),e.i64_shr_s(e.getLocal("c"),e.i64_const(32))))),a.addCode(e.i64_store32(e.getLocal("r"),4*t,e.i64_and(e.getLocal("c"),e.i64_const("0xFFFFFFFF"))));a.addCode(e.i32_wrap_i64(e.i64_shr_s(e.getLocal("c"),e.i64_const(32))))}(),!function(){let a=t.addFunction(l+"_mul");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64");for(let t=0;t<o;t++)a.addLocal("x"+t,"i64"),a.addLocal("y"+t,"i64");let e=a.getCodeBuilder(),i=[],c=[],n="c0",d="c1";for(let t=0;t<2*o-1;t++){for(let l=Math.max(0,t-o+1);l<=t&&l<o;l++){let o=t-l;a.addCode(e.setLocal(n,e.i64_add(e.i64_and(e.getLocal(n),e.i64_const(4294967295)),function(t,a){let l,o;return i[t]?l=e.getLocal("x"+t):(l=e.teeLocal("x"+t,e.i64_load32_u(e.getLocal("x"),4*t)),i[t]=!0),c[a]?o=e.getLocal("y"+a):(o=e.teeLocal("y"+a,e.i64_load32_u(e.getLocal("y"),4*a)),c[a]=!0),e.i64_mul(l,o)}(l,o)))),a.addCode(e.setLocal(d,e.i64_add(e.getLocal(d),e.i64_shr_u(e.getLocal(n),e.i64_const(32)))))}a.addCode(e.i64_store32(e.getLocal("r"),4*t,e.getLocal(n))),[n,d]=[d,n],a.addCode(e.setLocal(d,e.i64_shr_u(e.getLocal(n),e.i64_const(32))))}a.addCode(e.i64_store32(e.getLocal("r"),8*o-4,e.getLocal(n)))}(),!function(){let a=t.addFunction(l+"_square");a.addParam("x","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64"),a.addLocal("c0_old","i64"),a.addLocal("c1_old","i64");for(let t=0;t<o;t++)a.addLocal("x"+t,"i64");let e=a.getCodeBuilder(),i=[];function mulij(t,a){let l,o;return i[t]?l=e.getLocal("x"+t):(l=e.teeLocal("x"+t,e.i64_load32_u(e.getLocal("x"),4*t)),i[t]=!0),i[a]?o=e.getLocal("x"+a):(o=e.teeLocal("x"+a,e.i64_load32_u(e.getLocal("x"),4*a)),i[a]=!0),e.i64_mul(l,o)}let c="c0_old",n="c1_old";for(let t=0;t<2*o-1;t++){a.addCode(e.setLocal("c0",e.i64_const(0)),e.setLocal("c1",e.i64_const(0)));for(let l=Math.max(0,t-o+1);l<t+1>>1&&l<o;l++){let o=t-l;a.addCode(e.setLocal("c0",e.i64_add(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),mulij(l,o)))),a.addCode(e.setLocal("c1",e.i64_add(e.getLocal("c1"),e.i64_shr_u(e.getLocal("c0"),e.i64_const(32)))))}a.addCode(e.setLocal("c0",e.i64_shl(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),e.i64_const(1)))),a.addCode(e.setLocal("c1",e.i64_add(e.i64_shl(e.getLocal("c1"),e.i64_const(1)),e.i64_shr_u(e.getLocal("c0"),e.i64_const(32))))),t%2==0&&(a.addCode(e.setLocal("c0",e.i64_add(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),mulij(t>>1,t>>1)))),a.addCode(e.setLocal("c1",e.i64_add(e.getLocal("c1"),e.i64_shr_u(e.getLocal("c0"),e.i64_const(32)))))),t>0&&(a.addCode(e.setLocal("c0",e.i64_add(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),e.i64_and(e.getLocal(c),e.i64_const(4294967295))))),a.addCode(e.setLocal("c1",e.i64_add(e.i64_add(e.getLocal("c1"),e.i64_shr_u(e.getLocal("c0"),e.i64_const(32))),e.getLocal(n))))),a.addCode(e.i64_store32(e.getLocal("r"),4*t,e.getLocal("c0"))),a.addCode(e.setLocal(c,e.getLocal("c1")),e.setLocal(n,e.i64_shr_u(e.getLocal(c),e.i64_const(32))))}a.addCode(e.i64_store32(e.getLocal("r"),8*o-4,e.getLocal(c)))}(),!function(){let a=t.addFunction(l+"_squareOld");a.addParam("x","i32"),a.addParam("r","i32");let e=a.getCodeBuilder();a.addCode(e.call(l+"_mul",e.getLocal("x"),e.getLocal("x"),e.getLocal("r")))}(),!function(){(function(){let a=t.addFunction(l+"__mul1");a.addParam("px","i32"),a.addParam("y","i64"),a.addParam("pr","i32"),a.addLocal("c","i64");let e=a.getCodeBuilder();a.addCode(e.setLocal("c",e.i64_mul(e.i64_load32_u(e.getLocal("px"),0,0),e.getLocal("y")))),a.addCode(e.i64_store32(e.getLocal("pr"),0,0,e.getLocal("c")));for(let t=1;t<o;t++)a.addCode(e.setLocal("c",e.i64_add(e.i64_mul(e.i64_load32_u(e.getLocal("px"),4*t,0),e.getLocal("y")),e.i64_shr_u(e.getLocal("c"),e.i64_const(32))))),a.addCode(e.i64_store32(e.getLocal("pr"),4*t,0,e.getLocal("c")))})(),function(){let a=t.addFunction(l+"__add1");a.addParam("x","i32"),a.addParam("y","i64"),a.addLocal("c","i64"),a.addLocal("px","i32");let e=a.getCodeBuilder();a.addCode(e.setLocal("px",e.getLocal("x"))),a.addCode(e.setLocal("c",e.i64_add(e.i64_load32_u(e.getLocal("px"),0,0),e.getLocal("y")))),a.addCode(e.i64_store32(e.getLocal("px"),0,0,e.getLocal("c"))),a.addCode(e.setLocal("c",e.i64_shr_u(e.getLocal("c"),e.i64_const(32)))),a.addCode(e.block(e.loop(e.br_if(1,e.i64_eqz(e.getLocal("c"))),e.setLocal("px",e.i32_add(e.getLocal("px"),e.i32_const(4))),e.setLocal("c",e.i64_add(e.i64_load32_u(e.getLocal("px"),0,0),e.getLocal("c"))),e.i64_store32(e.getLocal("px"),0,0,e.getLocal("c")),e.setLocal("c",e.i64_shr_u(e.getLocal("c"),e.i64_const(32))),e.br(0))))}();let a=t.addFunction(l+"_div");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("c","i32"),a.addParam("r","i32"),a.addLocal("rr","i32"),a.addLocal("cc","i32"),a.addLocal("eX","i32"),a.addLocal("eY","i32"),a.addLocal("sy","i64"),a.addLocal("sx","i64"),a.addLocal("ec","i32");let e=a.getCodeBuilder(),c=e.i32_const(t.alloc(i)),n=e.i32_const(t.alloc(i)),d=e.i32_const(t.alloc(i)),r=e.getLocal("cc"),s=e.getLocal("rr"),_=t.alloc(2*i),u=e.i32_const(_),f=e.i32_const(_+i);a.addCode(e.if(e.getLocal("c"),e.setLocal("cc",e.getLocal("c")),e.setLocal("cc",n))),a.addCode(e.if(e.getLocal("r"),e.setLocal("rr",e.getLocal("r")),e.setLocal("rr",d))),a.addCode(e.call(l+"_copy",e.getLocal("x"),s)),a.addCode(e.call(l+"_copy",e.getLocal("y"),c)),a.addCode(e.call(l+"_zero",r)),a.addCode(e.call(l+"_zero",u)),a.addCode(e.setLocal("eX",e.i32_const(i-1))),a.addCode(e.setLocal("eY",e.i32_const(i-1))),a.addCode(e.block(e.loop(e.br_if(1,e.i32_or(e.i32_load8_u(e.i32_add(c,e.getLocal("eY")),0,0),e.i32_eq(e.getLocal("eY"),e.i32_const(3)))),e.setLocal("eY",e.i32_sub(e.getLocal("eY"),e.i32_const(1))),e.br(0)))),a.addCode(e.setLocal("sy",e.i64_add(e.i64_load32_u(e.i32_sub(e.i32_add(c,e.getLocal("eY")),e.i32_const(3)),0,0),e.i64_const(1)))),a.addCode(e.if(e.i64_eq(e.getLocal("sy"),e.i64_const(1)),e.drop(e.i64_div_u(e.i64_const(0),e.i64_const(0))))),a.addCode(e.block(e.loop(e.block(e.loop(e.br_if(1,e.i32_or(e.i32_load8_u(e.i32_add(s,e.getLocal("eX")),0,0),e.i32_eq(e.getLocal("eX"),e.i32_const(7)))),e.setLocal("eX",e.i32_sub(e.getLocal("eX"),e.i32_const(1))),e.br(0))),e.setLocal("sx",e.i64_load(e.i32_sub(e.i32_add(s,e.getLocal("eX")),e.i32_const(7)),0,0)),e.setLocal("sx",e.i64_div_u(e.getLocal("sx"),e.getLocal("sy"))),e.setLocal("ec",e.i32_sub(e.i32_sub(e.getLocal("eX"),e.getLocal("eY")),e.i32_const(4))),e.block(e.loop(e.br_if(1,e.i32_and(e.i64_eqz(e.i64_and(e.getLocal("sx"),e.i64_const("0xFFFFFFFF00000000"))),e.i32_ge_s(e.getLocal("ec"),e.i32_const(0)))),e.setLocal("sx",e.i64_shr_u(e.getLocal("sx"),e.i64_const(8))),e.setLocal("ec",e.i32_add(e.getLocal("ec"),e.i32_const(1))),e.br(0))),e.if(e.i64_eqz(e.getLocal("sx")),[...e.br_if(2,e.i32_eqz(e.call(l+"_gte",s,c))),...e.setLocal("sx",e.i64_const(1)),...e.setLocal("ec",e.i32_const(0))]),e.call(l+"__mul1",c,e.getLocal("sx"),f),e.drop(e.call(l+"_sub",s,e.i32_sub(f,e.getLocal("ec")),s)),e.call(l+"__add1",e.i32_add(r,e.getLocal("ec")),e.getLocal("sx")),e.br(0))))}(),!function(){let a=t.addFunction(l+"_inverseMod");a.addParam("px","i32"),a.addParam("pm","i32"),a.addParam("pr","i32"),a.addLocal("t","i32"),a.addLocal("newt","i32"),a.addLocal("r","i32"),a.addLocal("qq","i32"),a.addLocal("qr","i32"),a.addLocal("newr","i32"),a.addLocal("swp","i32"),a.addLocal("x","i32"),a.addLocal("signt","i32"),a.addLocal("signnewt","i32"),a.addLocal("signx","i32");let e=a.getCodeBuilder(),o=e.i32_const(t.alloc(i)),c=e.i32_const(t.alloc(i)),n=e.i32_const(t.alloc(i)),d=e.i32_const(t.alloc(i)),r=e.i32_const(t.alloc(i)),s=e.i32_const(t.alloc(i)),_=e.i32_const(t.alloc(2*i)),u=e.i32_const(t.alloc(i));a.addCode(e.setLocal("t",o),e.call(l+"_zero",o),e.setLocal("signt",e.i32_const(0))),a.addCode(e.setLocal("r",c),e.call(l+"_copy",e.getLocal("pm"),c)),a.addCode(e.setLocal("newt",n),e.call(l+"_one",n),e.setLocal("signnewt",e.i32_const(0))),a.addCode(e.setLocal("newr",d),e.call(l+"_copy",e.getLocal("px"),d)),a.addCode(e.setLocal("qq",r)),a.addCode(e.setLocal("qr",s)),a.addCode(e.setLocal("x",u)),a.addCode(e.block(e.loop(e.br_if(1,e.call(l+"_isZero",e.getLocal("newr"))),e.call(l+"_div",e.getLocal("r"),e.getLocal("newr"),e.getLocal("qq"),e.getLocal("qr")),e.call(l+"_mul",e.getLocal("qq"),e.getLocal("newt"),_),e.if(e.getLocal("signt"),e.if(e.getLocal("signnewt"),e.if(e.call(l+"_gte",_,e.getLocal("t")),[...e.drop(e.call(l+"_sub",_,e.getLocal("t"),e.getLocal("x"))),...e.setLocal("signx",e.i32_const(0))],[...e.drop(e.call(l+"_sub",e.getLocal("t"),_,e.getLocal("x"))),...e.setLocal("signx",e.i32_const(1))]),[...e.drop(e.call(l+"_add",_,e.getLocal("t"),e.getLocal("x"))),...e.setLocal("signx",e.i32_const(1))]),e.if(e.getLocal("signnewt"),[...e.drop(e.call(l+"_add",_,e.getLocal("t"),e.getLocal("x"))),...e.setLocal("signx",e.i32_const(0))],e.if(e.call(l+"_gte",e.getLocal("t"),_),[...e.drop(e.call(l+"_sub",e.getLocal("t"),_,e.getLocal("x"))),...e.setLocal("signx",e.i32_const(0))],[...e.drop(e.call(l+"_sub",_,e.getLocal("t"),e.getLocal("x"))),...e.setLocal("signx",e.i32_const(1))]))),e.setLocal("swp",e.getLocal("t")),e.setLocal("t",e.getLocal("newt")),e.setLocal("newt",e.getLocal("x")),e.setLocal("x",e.getLocal("swp")),e.setLocal("signt",e.getLocal("signnewt")),e.setLocal("signnewt",e.getLocal("signx")),e.setLocal("swp",e.getLocal("r")),e.setLocal("r",e.getLocal("newr")),e.setLocal("newr",e.getLocal("qr")),e.setLocal("qr",e.getLocal("swp")),e.br(0)))),a.addCode(e.if(e.getLocal("signt"),e.drop(e.call(l+"_sub",e.getLocal("pm"),e.getLocal("t"),e.getLocal("pr"))),e.call(l+"_copy",e.getLocal("t"),e.getLocal("pr"))))}(),t.exportFunction(l+"_copy"),t.exportFunction(l+"_zero"),t.exportFunction(l+"_one"),t.exportFunction(l+"_isZero"),t.exportFunction(l+"_eq"),t.exportFunction(l+"_gte"),t.exportFunction(l+"_add"),t.exportFunction(l+"_sub"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_squareOld"),t.exportFunction(l+"_div"),t.exportFunction(l+"_inverseMod"),l},buildBatchOp=function(t,a,e,l,o,i){void 0===i&&(i=l<o);let c=t.addFunction(a);c.addParam("pIn1","i32"),c.addParam("pIn2","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn1","i32"),c.addLocal("itIn2","i32"),c.addLocal("itOut","i32");let n=c.getCodeBuilder();i?c.addCode(n.setLocal("itIn1",n.i32_add(n.getLocal("pIn1"),n.i32_mul(n.i32_sub(n.getLocal("n"),n.i32_const(1)),n.i32_const(l)))),n.setLocal("itIn2",n.i32_add(n.getLocal("pIn2"),n.i32_mul(n.i32_sub(n.getLocal("n"),n.i32_const(1)),n.i32_const(l)))),n.setLocal("itOut",n.i32_add(n.getLocal("pOut"),n.i32_mul(n.i32_sub(n.getLocal("n"),n.i32_const(1)),n.i32_const(o)))),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("n"))),n.call(e,n.getLocal("itIn1"),n.getLocal("itIn2"),n.getLocal("itOut")),n.setLocal("itIn1",n.i32_sub(n.getLocal("itIn1"),n.i32_const(l))),n.setLocal("itIn2",n.i32_sub(n.getLocal("itIn2"),n.i32_const(l))),n.setLocal("itOut",n.i32_sub(n.getLocal("itOut"),n.i32_const(o))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0)))):c.addCode(n.setLocal("itIn1",n.getLocal("pIn1")),n.setLocal("itIn2",n.getLocal("pIn2")),n.setLocal("itOut",n.getLocal("pOut")),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("n"))),n.call(e,n.getLocal("itIn1"),n.getLocal("itIn2"),n.getLocal("itOut")),n.setLocal("itIn1",n.i32_add(n.getLocal("itIn1"),n.i32_const(l))),n.setLocal("itIn2",n.i32_add(n.getLocal("itIn2"),n.i32_const(l))),n.setLocal("itOut",n.i32_add(n.getLocal("itOut"),n.i32_const(o))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))},{bitLength:u,modInv:f,modPow:g,isPrime:p,isOdd:L,square:m}=_;var build_f1m=function(t,a,e,l){let o=BigInt(a),i=Math.floor((u(o-1n)-1)/64)+1,c=2*i,n=8*i,d=e||"f1m";if(t.modules[d])return d;let r=buildInt(t,i,l),_=t.alloc(n,s.bigInt2BytesLE(o,n)),h=t.alloc(s.bigInt2BytesLE(m(1n<<BigInt(64*i))%o,n)),b=t.alloc(s.bigInt2BytesLE((1n<<BigInt(64*i))%o,n)),x=t.alloc(s.bigInt2BytesLE(0n,n)),y=o-1n,F=y>>1n,B=t.alloc(n,s.bigInt2BytesLE(F,n)),C=F+1n,v=t.alloc(n,s.bigInt2BytesLE(C,n));t.modules[d]={pq:_,pR2:h,n64:i,q:o,pOne:b,pZero:x,pePlusOne:v};let P=2n;if(p(o))for(;g(P,F,o)!==y;)P+=1n;let q=0,A=y;for(;!L(A)&&0n!==A;)q++,A>>=1n;let I=t.alloc(n,s.bigInt2BytesLE(A,n)),E=g(P,A,o),O=t.alloc(s.bigInt2BytesLE((E<<BigInt(64*i))%o,n)),w=A+1n>>1n,M=t.alloc(n,s.bigInt2BytesLE(w,n));return t.exportFunction(r+"_copy",d+"_copy"),t.exportFunction(r+"_zero",d+"_zero"),t.exportFunction(r+"_isZero",d+"_isZero"),t.exportFunction(r+"_eq",d+"_eq"),!function(){let a=t.addFunction(d+"_isOne");a.addParam("x","i32"),a.setReturnType("i32");let e=a.getCodeBuilder();a.addCode(e.ret(e.call(r+"_eq",e.getLocal("x"),e.i32_const(b))))}(),!function(){let a=t.addFunction(d+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");let e=a.getCodeBuilder();a.addCode(e.if(e.call(r+"_add",e.getLocal("x"),e.getLocal("y"),e.getLocal("r")),e.drop(e.call(r+"_sub",e.getLocal("r"),e.i32_const(_),e.getLocal("r"))),e.if(e.call(r+"_gte",e.getLocal("r"),e.i32_const(_)),e.drop(e.call(r+"_sub",e.getLocal("r"),e.i32_const(_),e.getLocal("r"))))))}(),!function(){let a=t.addFunction(d+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");let e=a.getCodeBuilder();a.addCode(e.if(e.call(r+"_sub",e.getLocal("x"),e.getLocal("y"),e.getLocal("r")),e.drop(e.call(r+"_add",e.getLocal("r"),e.i32_const(_),e.getLocal("r")))))}(),!function(){let a=t.addFunction(d+"_neg");a.addParam("x","i32"),a.addParam("r","i32");let e=a.getCodeBuilder();a.addCode(e.call(d+"_sub",e.i32_const(x),e.getLocal("x"),e.getLocal("r")))}(),!function(){let a=t.alloc(c*c*8),e=t.addFunction(d+"_mReduct");e.addParam("t","i32"),e.addParam("r","i32"),e.addLocal("np32","i64"),e.addLocal("c","i64"),e.addLocal("m","i64");let l=e.getCodeBuilder(),i=Number(4294967296n-f(o,4294967296n));e.addCode(l.setLocal("np32",l.i64_const(i)));for(let t=0;t<c;t++){e.addCode(l.setLocal("c",l.i64_const(0))),e.addCode(l.setLocal("m",l.i64_and(l.i64_mul(l.i64_load32_u(l.getLocal("t"),4*t),l.getLocal("np32")),l.i64_const("0xFFFFFFFF"))));for(let a=0;a<c;a++)e.addCode(l.setLocal("c",l.i64_add(l.i64_add(l.i64_load32_u(l.getLocal("t"),(t+a)*4),l.i64_shr_u(l.getLocal("c"),l.i64_const(32))),l.i64_mul(l.i64_load32_u(l.i32_const(_),4*a),l.getLocal("m"))))),e.addCode(l.i64_store32(l.getLocal("t"),(t+a)*4,l.getLocal("c")));e.addCode(l.i64_store32(l.i32_const(a),4*t,l.i64_shr_u(l.getLocal("c"),l.i64_const(32))))}e.addCode(l.call(d+"_add",l.i32_const(a),l.i32_add(l.getLocal("t"),l.i32_const(4*c)),l.getLocal("r")))}(),!function(){let a=t.addFunction(d+"_mul");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64"),a.addLocal("np32","i64");for(let t=0;t<c;t++)a.addLocal("x"+t,"i64"),a.addLocal("y"+t,"i64"),a.addLocal("m"+t,"i64"),a.addLocal("q"+t,"i64");let e=a.getCodeBuilder(),l=Number(4294967296n-f(o,4294967296n));a.addCode(e.setLocal("np32",e.i64_const(l)));let i=[],n=[],s=[];function mulqm(t,a){let l,o;return s[t]?l=e.getLocal("q"+t):(l=e.teeLocal("q"+t,e.i64_load32_u(e.i32_const(0),_+4*t)),s[t]=!0),o=e.getLocal("m"+a),e.i64_mul(l,o)}let u="c0",g="c1";for(let t=0;t<2*c-1;t++){for(let l=Math.max(0,t-c+1);l<=t&&l<c;l++){let o=t-l;a.addCode(e.setLocal(u,e.i64_add(e.i64_and(e.getLocal(u),e.i64_const(4294967295)),function(t,a){let l,o;return i[t]?l=e.getLocal("x"+t):(l=e.teeLocal("x"+t,e.i64_load32_u(e.getLocal("x"),4*t)),i[t]=!0),n[a]?o=e.getLocal("y"+a):(o=e.teeLocal("y"+a,e.i64_load32_u(e.getLocal("y"),4*a)),n[a]=!0),e.i64_mul(l,o)}(l,o)))),a.addCode(e.setLocal(g,e.i64_add(e.getLocal(g),e.i64_shr_u(e.getLocal(u),e.i64_const(32)))))}for(let l=Math.max(1,t-c+1);l<=t&&l<c;l++){let o=t-l;a.addCode(e.setLocal(u,e.i64_add(e.i64_and(e.getLocal(u),e.i64_const(4294967295)),mulqm(l,o)))),a.addCode(e.setLocal(g,e.i64_add(e.getLocal(g),e.i64_shr_u(e.getLocal(u),e.i64_const(32)))))}t<c&&(a.addCode(e.setLocal("m"+t,e.i64_and(e.i64_mul(e.i64_and(e.getLocal(u),e.i64_const(4294967295)),e.getLocal("np32")),e.i64_const("0xFFFFFFFF")))),a.addCode(e.setLocal(u,e.i64_add(e.i64_and(e.getLocal(u),e.i64_const(4294967295)),mulqm(0,t)))),a.addCode(e.setLocal(g,e.i64_add(e.getLocal(g),e.i64_shr_u(e.getLocal(u),e.i64_const(32)))))),t>=c&&a.addCode(e.i64_store32(e.getLocal("r"),(t-c)*4,e.getLocal(u))),[u,g]=[g,u],a.addCode(e.setLocal(g,e.i64_shr_u(e.getLocal(u),e.i64_const(32))))}a.addCode(e.i64_store32(e.getLocal("r"),4*c-4,e.getLocal(u))),a.addCode(e.if(e.i32_wrap_i64(e.getLocal(g)),e.drop(e.call(r+"_sub",e.getLocal("r"),e.i32_const(_),e.getLocal("r"))),e.if(e.call(r+"_gte",e.getLocal("r"),e.i32_const(_)),e.drop(e.call(r+"_sub",e.getLocal("r"),e.i32_const(_),e.getLocal("r"))))))}(),!function(){let a=t.addFunction(d+"_square");a.addParam("x","i32"),a.addParam("r","i32"),a.addLocal("c0","i64"),a.addLocal("c1","i64"),a.addLocal("c0_old","i64"),a.addLocal("c1_old","i64"),a.addLocal("np32","i64");for(let t=0;t<c;t++)a.addLocal("x"+t,"i64"),a.addLocal("m"+t,"i64"),a.addLocal("q"+t,"i64");let e=a.getCodeBuilder(),l=Number(4294967296n-f(o,4294967296n));a.addCode(e.setLocal("np32",e.i64_const(l)));let i=[],n=[];function mulij(t,a){let l,o;return i[t]?l=e.getLocal("x"+t):(l=e.teeLocal("x"+t,e.i64_load32_u(e.getLocal("x"),4*t)),i[t]=!0),i[a]?o=e.getLocal("x"+a):(o=e.teeLocal("x"+a,e.i64_load32_u(e.getLocal("x"),4*a)),i[a]=!0),e.i64_mul(l,o)}function mulqm(t,a){let l,o;return n[t]?l=e.getLocal("q"+t):(l=e.teeLocal("q"+t,e.i64_load32_u(e.i32_const(0),_+4*t)),n[t]=!0),o=e.getLocal("m"+a),e.i64_mul(l,o)}let s="c0_old",u="c1_old";for(let t=0;t<2*c-1;t++){a.addCode(e.setLocal("c0",e.i64_const(0)),e.setLocal("c1",e.i64_const(0)));for(let l=Math.max(0,t-c+1);l<t+1>>1&&l<c;l++){let o=t-l;a.addCode(e.setLocal("c0",e.i64_add(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),mulij(l,o)))),a.addCode(e.setLocal("c1",e.i64_add(e.getLocal("c1"),e.i64_shr_u(e.getLocal("c0"),e.i64_const(32)))))}a.addCode(e.setLocal("c0",e.i64_shl(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),e.i64_const(1)))),a.addCode(e.setLocal("c1",e.i64_add(e.i64_shl(e.getLocal("c1"),e.i64_const(1)),e.i64_shr_u(e.getLocal("c0"),e.i64_const(32))))),t%2==0&&(a.addCode(e.setLocal("c0",e.i64_add(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),mulij(t>>1,t>>1)))),a.addCode(e.setLocal("c1",e.i64_add(e.getLocal("c1"),e.i64_shr_u(e.getLocal("c0"),e.i64_const(32)))))),t>0&&(a.addCode(e.setLocal("c0",e.i64_add(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),e.i64_and(e.getLocal(s),e.i64_const(4294967295))))),a.addCode(e.setLocal("c1",e.i64_add(e.i64_add(e.getLocal("c1"),e.i64_shr_u(e.getLocal("c0"),e.i64_const(32))),e.getLocal(u)))));for(let l=Math.max(1,t-c+1);l<=t&&l<c;l++){let o=t-l;a.addCode(e.setLocal("c0",e.i64_add(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),mulqm(l,o)))),a.addCode(e.setLocal("c1",e.i64_add(e.getLocal("c1"),e.i64_shr_u(e.getLocal("c0"),e.i64_const(32)))))}t<c&&(a.addCode(e.setLocal("m"+t,e.i64_and(e.i64_mul(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),e.getLocal("np32")),e.i64_const("0xFFFFFFFF")))),a.addCode(e.setLocal("c0",e.i64_add(e.i64_and(e.getLocal("c0"),e.i64_const(4294967295)),mulqm(0,t)))),a.addCode(e.setLocal("c1",e.i64_add(e.getLocal("c1"),e.i64_shr_u(e.getLocal("c0"),e.i64_const(32)))))),t>=c&&a.addCode(e.i64_store32(e.getLocal("r"),(t-c)*4,e.getLocal("c0"))),a.addCode(e.setLocal(s,e.getLocal("c1")),e.setLocal(u,e.i64_shr_u(e.getLocal(s),e.i64_const(32))))}a.addCode(e.i64_store32(e.getLocal("r"),4*c-4,e.getLocal(s))),a.addCode(e.if(e.i32_wrap_i64(e.getLocal(u)),e.drop(e.call(r+"_sub",e.getLocal("r"),e.i32_const(_),e.getLocal("r"))),e.if(e.call(r+"_gte",e.getLocal("r"),e.i32_const(_)),e.drop(e.call(r+"_sub",e.getLocal("r"),e.i32_const(_),e.getLocal("r"))))))}(),!function(){let a=t.addFunction(d+"_squareOld");a.addParam("x","i32"),a.addParam("r","i32");let e=a.getCodeBuilder();a.addCode(e.call(d+"_mul",e.getLocal("x"),e.getLocal("x"),e.getLocal("r")))}(),!function(){let a=t.addFunction(d+"_toMontgomery");a.addParam("x","i32"),a.addParam("r","i32");let e=a.getCodeBuilder();a.addCode(e.call(d+"_mul",e.getLocal("x"),e.i32_const(h),e.getLocal("r")))}(),!function(){let a=t.alloc(2*n),e=t.addFunction(d+"_fromMontgomery");e.addParam("x","i32"),e.addParam("r","i32");let l=e.getCodeBuilder();e.addCode(l.call(r+"_copy",l.getLocal("x"),l.i32_const(a))),e.addCode(l.call(r+"_zero",l.i32_const(a+n))),e.addCode(l.call(d+"_mReduct",l.i32_const(a),l.getLocal("r")))}(),!function(){let a=t.addFunction(d+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");let e=a.getCodeBuilder(),l=e.i32_const(t.alloc(n));a.addCode(e.call(d+"_fromMontgomery",e.getLocal("x"),l),e.call(r+"_gte",l,e.i32_const(v)))}(),!function(){let a=t.addFunction(d+"_sign");a.addParam("x","i32"),a.setReturnType("i32");let e=a.getCodeBuilder(),l=e.i32_const(t.alloc(n));a.addCode(e.if(e.call(r+"_isZero",e.getLocal("x")),e.ret(e.i32_const(0))),e.call(d+"_fromMontgomery",e.getLocal("x"),l),e.if(e.call(r+"_gte",l,e.i32_const(v)),e.ret(e.i32_const(-1))),e.ret(e.i32_const(1)))}(),!function(){let a=t.addFunction(d+"_inverse");a.addParam("x","i32"),a.addParam("r","i32");let e=a.getCodeBuilder();a.addCode(e.call(d+"_fromMontgomery",e.getLocal("x"),e.getLocal("r"))),a.addCode(e.call(r+"_inverseMod",e.getLocal("r"),e.i32_const(_),e.getLocal("r"))),a.addCode(e.call(d+"_toMontgomery",e.getLocal("r"),e.getLocal("r")))}(),!function(){let a=t.addFunction(d+"_one");a.addParam("pr","i32");let e=a.getCodeBuilder();a.addCode(e.call(r+"_copy",e.i32_const(b),e.getLocal("pr")))}(),!function(){let a=t.addFunction(d+"_load");a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32"),a.addLocal("p","i32"),a.addLocal("l","i32"),a.addLocal("i","i32"),a.addLocal("j","i32");let e=a.getCodeBuilder(),l=e.i32_const(t.alloc(n)),o=t.alloc(n),i=e.i32_const(o);a.addCode(e.call(r+"_zero",e.getLocal("r")),e.setLocal("i",e.i32_const(n)),e.setLocal("p",e.getLocal("scalar")),e.block(e.loop(e.br_if(1,e.i32_gt_u(e.getLocal("i"),e.getLocal("scalarLen"))),e.if(e.i32_eq(e.getLocal("i"),e.i32_const(n)),e.call(d+"_one",l),e.call(d+"_mul",l,e.i32_const(h),l)),e.call(d+"_mul",e.getLocal("p"),l,i),e.call(d+"_add",e.getLocal("r"),i,e.getLocal("r")),e.setLocal("p",e.i32_add(e.getLocal("p"),e.i32_const(n))),e.setLocal("i",e.i32_add(e.getLocal("i"),e.i32_const(n))),e.br(0))),e.setLocal("l",e.i32_rem_u(e.getLocal("scalarLen"),e.i32_const(n))),e.if(e.i32_eqz(e.getLocal("l")),e.ret([])),e.call(r+"_zero",i),e.setLocal("j",e.i32_const(0)),e.block(e.loop(e.br_if(1,e.i32_eq(e.getLocal("j"),e.getLocal("l"))),e.i32_store8(e.getLocal("j"),o,e.i32_load8_u(e.getLocal("p"))),e.setLocal("p",e.i32_add(e.getLocal("p"),e.i32_const(1))),e.setLocal("j",e.i32_add(e.getLocal("j"),e.i32_const(1))),e.br(0))),e.if(e.i32_eq(e.getLocal("i"),e.i32_const(n)),e.call(d+"_one",l),e.call(d+"_mul",l,e.i32_const(h),l)),e.call(d+"_mul",i,l,i),e.call(d+"_add",e.getLocal("r"),i,e.getLocal("r")))}(),!function(){let a=t.addFunction(d+"_timesScalar");a.addParam("x","i32"),a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32");let e=a.getCodeBuilder(),l=e.i32_const(t.alloc(n));a.addCode(e.call(d+"_load",e.getLocal("scalar"),e.getLocal("scalarLen"),l),e.call(d+"_toMontgomery",l,l),e.call(d+"_mul",e.getLocal("x"),l,e.getLocal("r")))}(),buildBatchInverse$3(t,d),buildBatchConvertion$3(t,d+"_batchToMontgomery",d+"_toMontgomery",n,n),buildBatchConvertion$3(t,d+"_batchFromMontgomery",d+"_fromMontgomery",n,n),buildBatchConvertion$3(t,d+"_batchNeg",d+"_neg",n,n),buildBatchOp(t,d+"_batchAdd",d+"_add",n,n),buildBatchOp(t,d+"_batchSub",d+"_sub",n,n),buildBatchOp(t,d+"_batchMul",d+"_mul",n,n),t.exportFunction(d+"_add"),t.exportFunction(d+"_sub"),t.exportFunction(d+"_neg"),t.exportFunction(d+"_isNegative"),t.exportFunction(d+"_isOne"),t.exportFunction(d+"_sign"),t.exportFunction(d+"_mReduct"),t.exportFunction(d+"_mul"),t.exportFunction(d+"_square"),t.exportFunction(d+"_squareOld"),t.exportFunction(d+"_fromMontgomery"),t.exportFunction(d+"_toMontgomery"),t.exportFunction(d+"_inverse"),t.exportFunction(d+"_one"),t.exportFunction(d+"_load"),t.exportFunction(d+"_timesScalar"),build_timesscalar(t,d+"_exp",n,d+"_mul",d+"_square",r+"_copy",d+"_one"),t.exportFunction(d+"_exp"),t.exportFunction(d+"_batchInverse"),p(o)&&(function(){let a=t.addFunction(d+"_sqrt");a.addParam("n","i32"),a.addParam("r","i32"),a.addLocal("m","i32"),a.addLocal("i","i32"),a.addLocal("j","i32");let e=a.getCodeBuilder(),l=e.i32_const(b),o=e.i32_const(t.alloc(n)),i=e.i32_const(t.alloc(n)),c=e.i32_const(t.alloc(n)),r=e.i32_const(t.alloc(n)),s=e.i32_const(t.alloc(n));a.addCode(e.if(e.call(d+"_isZero",e.getLocal("n")),e.ret(e.call(d+"_zero",e.getLocal("r")))),e.setLocal("m",e.i32_const(q)),e.call(d+"_copy",e.i32_const(O),o),e.call(d+"_exp",e.getLocal("n"),e.i32_const(I),e.i32_const(n),i),e.call(d+"_exp",e.getLocal("n"),e.i32_const(M),e.i32_const(n),c),e.block(e.loop(e.br_if(1,e.call(d+"_eq",i,l)),e.call(d+"_square",i,r),e.setLocal("i",e.i32_const(1)),e.block(e.loop(e.br_if(1,e.call(d+"_eq",r,l)),e.call(d+"_square",r,r),e.setLocal("i",e.i32_add(e.getLocal("i"),e.i32_const(1))),e.br(0))),e.call(d+"_copy",o,s),e.setLocal("j",e.i32_sub(e.i32_sub(e.getLocal("m"),e.getLocal("i")),e.i32_const(1))),e.block(e.loop(e.br_if(1,e.i32_eqz(e.getLocal("j"))),e.call(d+"_square",s,s),e.setLocal("j",e.i32_sub(e.getLocal("j"),e.i32_const(1))),e.br(0))),e.setLocal("m",e.getLocal("i")),e.call(d+"_square",s,o),e.call(d+"_mul",i,o,i),e.call(d+"_mul",c,s,c),e.br(0))),e.if(e.call(d+"_isNegative",c),e.call(d+"_neg",c,e.getLocal("r")),e.call(d+"_copy",c,e.getLocal("r"))))}(),function(){let a=t.addFunction(d+"_isSquare");a.addParam("n","i32"),a.setReturnType("i32");let e=a.getCodeBuilder(),l=e.i32_const(b),o=e.i32_const(t.alloc(n));a.addCode(e.if(e.call(d+"_isZero",e.getLocal("n")),e.ret(e.i32_const(1))),e.call(d+"_exp",e.getLocal("n"),e.i32_const(B),e.i32_const(n),o),e.call(d+"_eq",o,l))}(),t.exportFunction(d+"_sqrt"),t.exportFunction(d+"_isSquare")),t.exportFunction(d+"_batchToMontgomery"),t.exportFunction(d+"_batchFromMontgomery"),d};let{bitLength:h}=_;var build_f1=function(t,a,e,l,o){let i=BigInt(a),c=Math.floor((h(i-1n)-1)/64)+1,n=8*c,d=e||"f1";if(t.modules[d])return d;t.modules[d]={n64:c};let r=o||"int",s=build_f1m(t,i,l,r),_=t.modules[s].pR2,u=t.modules[s].pq,f=t.modules[s].pePlusOne;return!function(){let a=t.alloc(n),e=t.addFunction(d+"_mul");e.addParam("x","i32"),e.addParam("y","i32"),e.addParam("r","i32");let l=e.getCodeBuilder();e.addCode(l.call(s+"_mul",l.getLocal("x"),l.getLocal("y"),l.i32_const(a))),e.addCode(l.call(s+"_mul",l.i32_const(a),l.i32_const(_),l.getLocal("r")))}(),!function(){let a=t.addFunction(d+"_square");a.addParam("x","i32"),a.addParam("r","i32");let e=a.getCodeBuilder();a.addCode(e.call(d+"_mul",e.getLocal("x"),e.getLocal("x"),e.getLocal("r")))}(),!function(){let a=t.addFunction(d+"_inverse");a.addParam("x","i32"),a.addParam("r","i32");let e=a.getCodeBuilder();a.addCode(e.call(r+"_inverseMod",e.getLocal("x"),e.i32_const(u),e.getLocal("r")))}(),!function(){let a=t.addFunction(d+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");let e=a.getCodeBuilder();a.addCode(e.call(r+"_gte",e.getLocal("x"),e.i32_const(f)))}(),t.exportFunction(s+"_add",d+"_add"),t.exportFunction(s+"_sub",d+"_sub"),t.exportFunction(s+"_neg",d+"_neg"),t.exportFunction(d+"_mul"),t.exportFunction(d+"_square"),t.exportFunction(d+"_inverse"),t.exportFunction(d+"_isNegative"),t.exportFunction(s+"_copy",d+"_copy"),t.exportFunction(s+"_zero",d+"_zero"),t.exportFunction(s+"_one",d+"_one"),t.exportFunction(s+"_isZero",d+"_isZero"),t.exportFunction(s+"_eq",d+"_eq"),d},build_f2m=function(t,a,e,l){if(t.modules[e])return e;let o=8*t.modules[l].n64,i=t.modules[l].q;return t.modules[e]={n64:2*t.modules[l].n64},!function(){let a=t.addFunction(e+"_isZero");a.addParam("x","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o));a.addCode(i.i32_and(i.call(l+"_isZero",c),i.call(l+"_isZero",n)))}(),!function(){let a=t.addFunction(e+"_isOne");a.addParam("x","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o));a.addCode(i.ret(i.i32_and(i.call(l+"_isOne",c),i.call(l+"_isZero",n))))}(),!function(){let a=t.addFunction(e+"_zero");a.addParam("x","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o));a.addCode(i.call(l+"_zero",c),i.call(l+"_zero",n))}(),!function(){let a=t.addFunction(e+"_one");a.addParam("x","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o));a.addCode(i.call(l+"_one",c),i.call(l+"_zero",n))}(),!function(){let a=t.addFunction(e+"_copy");a.addParam("x","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.getLocal("r"),r=i.i32_add(i.getLocal("r"),i.i32_const(o));a.addCode(i.call(l+"_copy",c,d),i.call(l+"_copy",n,r))}(),!function(){let i=t.addFunction(e+"_mul");i.addParam("x","i32"),i.addParam("y","i32"),i.addParam("r","i32");let c=i.getCodeBuilder(),n=c.getLocal("x"),d=c.i32_add(c.getLocal("x"),c.i32_const(o)),r=c.getLocal("y"),s=c.i32_add(c.getLocal("y"),c.i32_const(o)),_=c.getLocal("r"),u=c.i32_add(c.getLocal("r"),c.i32_const(o)),f=c.i32_const(t.alloc(o)),g=c.i32_const(t.alloc(o)),p=c.i32_const(t.alloc(o)),L=c.i32_const(t.alloc(o));i.addCode(c.call(l+"_mul",n,r,f),c.call(l+"_mul",d,s,g),c.call(l+"_add",n,d,p),c.call(l+"_add",r,s,L),c.call(l+"_mul",p,L,p),c.call(a,g,_),c.call(l+"_add",f,_,_),c.call(l+"_add",f,g,u),c.call(l+"_sub",p,u,u))}(),!function(){let a=t.addFunction(e+"_mul1");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.getLocal("y"),r=i.getLocal("r"),s=i.i32_add(i.getLocal("r"),i.i32_const(o));a.addCode(i.call(l+"_mul",c,d,r),i.call(l+"_mul",n,d,s))}(),!function(){let i=t.addFunction(e+"_square");i.addParam("x","i32"),i.addParam("r","i32");let c=i.getCodeBuilder(),n=c.getLocal("x"),d=c.i32_add(c.getLocal("x"),c.i32_const(o)),r=c.getLocal("r"),s=c.i32_add(c.getLocal("r"),c.i32_const(o)),_=c.i32_const(t.alloc(o)),u=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o)),g=c.i32_const(t.alloc(o));i.addCode(c.call(l+"_mul",n,d,_),c.call(l+"_add",n,d,u),c.call(a,d,f),c.call(l+"_add",n,f,f),c.call(a,_,g),c.call(l+"_add",g,_,g),c.call(l+"_mul",u,f,r),c.call(l+"_sub",r,g,r),c.call(l+"_add",_,_,s))}(),!function(){let a=t.addFunction(e+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.getLocal("y"),r=i.i32_add(i.getLocal("y"),i.i32_const(o)),s=i.getLocal("r"),_=i.i32_add(i.getLocal("r"),i.i32_const(o));a.addCode(i.call(l+"_add",c,d,s),i.call(l+"_add",n,r,_))}(),!function(){let a=t.addFunction(e+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.getLocal("y"),r=i.i32_add(i.getLocal("y"),i.i32_const(o)),s=i.getLocal("r"),_=i.i32_add(i.getLocal("r"),i.i32_const(o));a.addCode(i.call(l+"_sub",c,d,s),i.call(l+"_sub",n,r,_))}(),!function(){let a=t.addFunction(e+"_neg");a.addParam("x","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.getLocal("r"),r=i.i32_add(i.getLocal("r"),i.i32_const(o));a.addCode(i.call(l+"_neg",c,d),i.call(l+"_neg",n,r))}(),!function(){let a=t.addFunction(e+"_conjugate");a.addParam("x","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.getLocal("r"),r=i.i32_add(i.getLocal("r"),i.i32_const(o));a.addCode(i.call(l+"_copy",c,d),i.call(l+"_neg",n,r))}(),!function(){let a=t.addFunction(e+"_toMontgomery");a.addParam("x","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.getLocal("r"),r=i.i32_add(i.getLocal("r"),i.i32_const(o));a.addCode(i.call(l+"_toMontgomery",c,d),i.call(l+"_toMontgomery",n,r))}(),!function(){let a=t.addFunction(e+"_fromMontgomery");a.addParam("x","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.getLocal("r"),r=i.i32_add(i.getLocal("r"),i.i32_const(o));a.addCode(i.call(l+"_fromMontgomery",c,d),i.call(l+"_fromMontgomery",n,r))}(),!function(){let a=t.addFunction(e+"_eq");a.addParam("x","i32"),a.addParam("y","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.getLocal("y"),r=i.i32_add(i.getLocal("y"),i.i32_const(o));a.addCode(i.i32_and(i.call(l+"_eq",c,d),i.call(l+"_eq",n,r)))}(),!function(){let i=t.addFunction(e+"_inverse");i.addParam("x","i32"),i.addParam("r","i32");let c=i.getCodeBuilder(),n=c.getLocal("x"),d=c.i32_add(c.getLocal("x"),c.i32_const(o)),r=c.getLocal("r"),s=c.i32_add(c.getLocal("r"),c.i32_const(o)),_=c.i32_const(t.alloc(o)),u=c.i32_const(t.alloc(o)),f=c.i32_const(t.alloc(o)),g=c.i32_const(t.alloc(o));i.addCode(c.call(l+"_square",n,_),c.call(l+"_square",d,u),c.call(a,u,f),c.call(l+"_sub",_,f,f),c.call(l+"_inverse",f,g),c.call(l+"_mul",n,g,r),c.call(l+"_mul",d,g,s),c.call(l+"_neg",s,s))}(),!function(){let a=t.addFunction(e+"_timesScalar");a.addParam("x","i32"),a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.getLocal("r"),r=i.i32_add(i.getLocal("r"),i.i32_const(o));a.addCode(i.call(l+"_timesScalar",c,i.getLocal("scalar"),i.getLocal("scalarLen"),d),i.call(l+"_timesScalar",n,i.getLocal("scalar"),i.getLocal("scalarLen"),r))}(),!function(){let a=t.addFunction(e+"_sign");a.addParam("x","i32"),a.addLocal("s","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o));a.addCode(i.setLocal("s",i.call(l+"_sign",n)),i.if(i.getLocal("s"),i.ret(i.getLocal("s"))),i.ret(i.call(l+"_sign",c)))}(),!function(){let a=t.addFunction(e+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o));a.addCode(i.if(i.call(l+"_isZero",n),i.ret(i.call(l+"_isNegative",c))),i.ret(i.call(l+"_isNegative",n)))}(),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_isOne"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_one"),t.exportFunction(e+"_copy"),t.exportFunction(e+"_mul"),t.exportFunction(e+"_mul1"),t.exportFunction(e+"_square"),t.exportFunction(e+"_add"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_neg"),t.exportFunction(e+"_sign"),t.exportFunction(e+"_conjugate"),t.exportFunction(e+"_fromMontgomery"),t.exportFunction(e+"_toMontgomery"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_inverse"),buildBatchInverse$3(t,e),build_timesscalar(t,e+"_exp",2*o,e+"_mul",e+"_square",e+"_copy",e+"_one"),!function(){let a=t.addFunction(e+"_sqrt");a.addParam("a","i32"),a.addParam("pr","i32");let c=a.getCodeBuilder(),n=c.i32_const(t.alloc(s.bigInt2BytesLE((BigInt(i||0)-3n)/4n,o))),d=c.i32_const(t.alloc(s.bigInt2BytesLE((BigInt(i||0)-1n)/2n,o))),r=c.getLocal("a"),_=c.i32_const(t.alloc(2*o)),u=c.i32_const(t.alloc(2*o)),f=c.i32_const(t.alloc(2*o)),g=t.alloc(2*o),p=c.i32_const(g),L=c.i32_const(g),m=c.i32_const(g+o),h=c.i32_const(t.alloc(2*o)),b=c.i32_const(t.alloc(2*o));a.addCode(c.call(e+"_one",p),c.call(e+"_neg",p,p),c.call(e+"_exp",r,n,c.i32_const(o),_),c.call(e+"_square",_,u),c.call(e+"_mul",r,u,u),c.call(e+"_conjugate",u,f),c.call(e+"_mul",f,u,f),c.if(c.call(e+"_eq",f,p),c.unreachable()),c.call(e+"_mul",_,r,h),c.if(c.call(e+"_eq",u,p),[...c.call(l+"_zero",L),...c.call(l+"_one",m),...c.call(e+"_mul",p,h,c.getLocal("pr"))],[...c.call(e+"_one",b),...c.call(e+"_add",b,u,b),...c.call(e+"_exp",b,d,c.i32_const(o),b),...c.call(e+"_mul",b,h,c.getLocal("pr"))]))}(),!function(){let a=t.addFunction(e+"_isSquare");a.addParam("a","i32"),a.setReturnType("i32");let l=a.getCodeBuilder(),c=l.i32_const(t.alloc(s.bigInt2BytesLE((BigInt(i||0)-3n)/4n,o))),n=l.getLocal("a"),d=l.i32_const(t.alloc(2*o)),r=l.i32_const(t.alloc(2*o)),_=l.i32_const(t.alloc(2*o)),u=t.alloc(2*o),f=l.i32_const(u);a.addCode(l.call(e+"_one",f),l.call(e+"_neg",f,f),l.call(e+"_exp",n,c,l.i32_const(o),d),l.call(e+"_square",d,r),l.call(e+"_mul",n,r,r),l.call(e+"_conjugate",r,_),l.call(e+"_mul",_,r,_),l.if(l.call(e+"_eq",_,f),l.ret(l.i32_const(0))),l.ret(l.i32_const(1)))}(),t.exportFunction(e+"_exp"),t.exportFunction(e+"_timesScalar"),t.exportFunction(e+"_batchInverse"),t.exportFunction(e+"_sqrt"),t.exportFunction(e+"_isSquare"),t.exportFunction(e+"_isNegative"),e},build_f3m=function(t,a,e,l){if(t.modules[e])return e;let o=8*t.modules[l].n64;return t.modules[e]={n64:3*t.modules[l].n64},!function(){let a=t.addFunction(e+"_isZero");a.addParam("x","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o));a.addCode(i.i32_and(i.i32_and(i.call(l+"_isZero",c),i.call(l+"_isZero",n)),i.call(l+"_isZero",d)))}(),!function(){let a=t.addFunction(e+"_isOne");a.addParam("x","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o));a.addCode(i.ret(i.i32_and(i.i32_and(i.call(l+"_isOne",c),i.call(l+"_isZero",n)),i.call(l+"_isZero",d))))}(),!function(){let a=t.addFunction(e+"_zero");a.addParam("x","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o));a.addCode(i.call(l+"_zero",c),i.call(l+"_zero",n),i.call(l+"_zero",d))}(),!function(){let a=t.addFunction(e+"_one");a.addParam("x","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o));a.addCode(i.call(l+"_one",c),i.call(l+"_zero",n),i.call(l+"_zero",d))}(),!function(){let a=t.addFunction(e+"_copy");a.addParam("x","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o)),r=i.getLocal("r"),s=i.i32_add(i.getLocal("r"),i.i32_const(o)),_=i.i32_add(i.getLocal("r"),i.i32_const(2*o));a.addCode(i.call(l+"_copy",c,r),i.call(l+"_copy",n,s),i.call(l+"_copy",d,_))}(),!function(){let i=t.addFunction(e+"_mul");i.addParam("x","i32"),i.addParam("y","i32"),i.addParam("r","i32");let c=i.getCodeBuilder(),n=c.getLocal("x"),d=c.i32_add(c.getLocal("x"),c.i32_const(o)),r=c.i32_add(c.getLocal("x"),c.i32_const(2*o)),s=c.getLocal("y"),_=c.i32_add(c.getLocal("y"),c.i32_const(o)),u=c.i32_add(c.getLocal("y"),c.i32_const(2*o)),f=c.getLocal("r"),g=c.i32_add(c.getLocal("r"),c.i32_const(o)),p=c.i32_add(c.getLocal("r"),c.i32_const(2*o)),L=c.i32_const(t.alloc(o)),m=c.i32_const(t.alloc(o)),h=c.i32_const(t.alloc(o)),b=c.i32_const(t.alloc(o)),x=c.i32_const(t.alloc(o)),y=c.i32_const(t.alloc(o)),F=c.i32_const(t.alloc(o)),B=c.i32_const(t.alloc(o)),C=c.i32_const(t.alloc(o)),v=c.i32_const(t.alloc(o)),P=c.i32_const(t.alloc(o)),q=c.i32_const(t.alloc(o)),A=c.i32_const(t.alloc(o));i.addCode(c.call(l+"_mul",n,s,L),c.call(l+"_mul",d,_,m),c.call(l+"_mul",r,u,h),c.call(l+"_add",n,d,b),c.call(l+"_add",s,_,x),c.call(l+"_add",n,r,y),c.call(l+"_add",s,u,F),c.call(l+"_add",d,r,B),c.call(l+"_add",_,u,C),c.call(l+"_add",L,m,v),c.call(l+"_add",L,h,P),c.call(l+"_add",m,h,q),c.call(l+"_mul",B,C,f),c.call(l+"_sub",f,q,f),c.call(a,f,f),c.call(l+"_add",L,f,f),c.call(l+"_mul",b,x,g),c.call(l+"_sub",g,v,g),c.call(a,h,A),c.call(l+"_add",g,A,g),c.call(l+"_mul",y,F,p),c.call(l+"_sub",p,P,p),c.call(l+"_add",p,m,p))}(),!function(){let i=t.addFunction(e+"_square");i.addParam("x","i32"),i.addParam("r","i32");let c=i.getCodeBuilder(),n=c.getLocal("x"),d=c.i32_add(c.getLocal("x"),c.i32_const(o)),r=c.i32_add(c.getLocal("x"),c.i32_const(2*o)),s=c.getLocal("r"),_=c.i32_add(c.getLocal("r"),c.i32_const(o)),u=c.i32_add(c.getLocal("r"),c.i32_const(2*o)),f=c.i32_const(t.alloc(o)),g=c.i32_const(t.alloc(o)),p=c.i32_const(t.alloc(o)),L=c.i32_const(t.alloc(o)),m=c.i32_const(t.alloc(o)),h=c.i32_const(t.alloc(o)),b=c.i32_const(t.alloc(o));i.addCode(c.call(l+"_square",n,f),c.call(l+"_mul",n,d,g),c.call(l+"_add",g,g,p),c.call(l+"_sub",n,d,L),c.call(l+"_add",L,r,L),c.call(l+"_square",L,L),c.call(l+"_mul",d,r,m),c.call(l+"_add",m,m,h),c.call(l+"_square",r,b),c.call(a,h,s),c.call(l+"_add",f,s,s),c.call(a,b,_),c.call(l+"_add",p,_,_),c.call(l+"_add",f,b,u),c.call(l+"_sub",h,u,u),c.call(l+"_add",L,u,u),c.call(l+"_add",p,u,u))}(),!function(){let a=t.addFunction(e+"_add");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o)),r=i.getLocal("y"),s=i.i32_add(i.getLocal("y"),i.i32_const(o)),_=i.i32_add(i.getLocal("y"),i.i32_const(2*o)),u=i.getLocal("r"),f=i.i32_add(i.getLocal("r"),i.i32_const(o)),g=i.i32_add(i.getLocal("r"),i.i32_const(2*o));a.addCode(i.call(l+"_add",c,r,u),i.call(l+"_add",n,s,f),i.call(l+"_add",d,_,g))}(),!function(){let a=t.addFunction(e+"_sub");a.addParam("x","i32"),a.addParam("y","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o)),r=i.getLocal("y"),s=i.i32_add(i.getLocal("y"),i.i32_const(o)),_=i.i32_add(i.getLocal("y"),i.i32_const(2*o)),u=i.getLocal("r"),f=i.i32_add(i.getLocal("r"),i.i32_const(o)),g=i.i32_add(i.getLocal("r"),i.i32_const(2*o));a.addCode(i.call(l+"_sub",c,r,u),i.call(l+"_sub",n,s,f),i.call(l+"_sub",d,_,g))}(),!function(){let a=t.addFunction(e+"_neg");a.addParam("x","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o)),r=i.getLocal("r"),s=i.i32_add(i.getLocal("r"),i.i32_const(o)),_=i.i32_add(i.getLocal("r"),i.i32_const(2*o));a.addCode(i.call(l+"_neg",c,r),i.call(l+"_neg",n,s),i.call(l+"_neg",d,_))}(),!function(){let a=t.addFunction(e+"_sign");a.addParam("x","i32"),a.addLocal("s","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o));a.addCode(i.setLocal("s",i.call(l+"_sign",d)),i.if(i.getLocal("s"),i.ret(i.getLocal("s"))),i.setLocal("s",i.call(l+"_sign",n)),i.if(i.getLocal("s"),i.ret(i.getLocal("s"))),i.ret(i.call(l+"_sign",c)))}(),!function(){let a=t.addFunction(e+"_toMontgomery");a.addParam("x","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o)),r=i.getLocal("r"),s=i.i32_add(i.getLocal("r"),i.i32_const(o)),_=i.i32_add(i.getLocal("r"),i.i32_const(2*o));a.addCode(i.call(l+"_toMontgomery",c,r),i.call(l+"_toMontgomery",n,s),i.call(l+"_toMontgomery",d,_))}(),!function(){let a=t.addFunction(e+"_fromMontgomery");a.addParam("x","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o)),r=i.getLocal("r"),s=i.i32_add(i.getLocal("r"),i.i32_const(o)),_=i.i32_add(i.getLocal("r"),i.i32_const(2*o));a.addCode(i.call(l+"_fromMontgomery",c,r),i.call(l+"_fromMontgomery",n,s),i.call(l+"_fromMontgomery",d,_))}(),!function(){let a=t.addFunction(e+"_eq");a.addParam("x","i32"),a.addParam("y","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o)),r=i.getLocal("y"),s=i.i32_add(i.getLocal("y"),i.i32_const(o)),_=i.i32_add(i.getLocal("y"),i.i32_const(2*o));a.addCode(i.i32_and(i.i32_and(i.call(l+"_eq",c,r),i.call(l+"_eq",n,s)),i.call(l+"_eq",d,_)))}(),!function(){let i=t.addFunction(e+"_inverse");i.addParam("x","i32"),i.addParam("r","i32");let c=i.getCodeBuilder(),n=c.getLocal("x"),d=c.i32_add(c.getLocal("x"),c.i32_const(o)),r=c.i32_add(c.getLocal("x"),c.i32_const(2*o)),s=c.getLocal("r"),_=c.i32_add(c.getLocal("r"),c.i32_const(o)),u=c.i32_add(c.getLocal("r"),c.i32_const(2*o)),f=c.i32_const(t.alloc(o)),g=c.i32_const(t.alloc(o)),p=c.i32_const(t.alloc(o)),L=c.i32_const(t.alloc(o)),m=c.i32_const(t.alloc(o)),h=c.i32_const(t.alloc(o)),b=c.i32_const(t.alloc(o)),x=c.i32_const(t.alloc(o)),y=c.i32_const(t.alloc(o)),F=c.i32_const(t.alloc(o)),B=c.i32_const(t.alloc(o));i.addCode(c.call(l+"_square",n,f),c.call(l+"_square",d,g),c.call(l+"_square",r,p),c.call(l+"_mul",n,d,L),c.call(l+"_mul",n,r,m),c.call(l+"_mul",d,r,h),c.call(a,h,b),c.call(l+"_sub",f,b,b),c.call(a,p,x),c.call(l+"_sub",x,L,x),c.call(l+"_sub",g,m,y),c.call(l+"_mul",r,x,F),c.call(l+"_mul",d,y,B),c.call(l+"_add",F,B,F),c.call(a,F,F),c.call(l+"_mul",n,b,B),c.call(l+"_add",B,F,F),c.call(l+"_inverse",F,F),c.call(l+"_mul",F,b,s),c.call(l+"_mul",F,x,_),c.call(l+"_mul",F,y,u))}(),!function(){let a=t.addFunction(e+"_timesScalar");a.addParam("x","i32"),a.addParam("scalar","i32"),a.addParam("scalarLen","i32"),a.addParam("r","i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o)),r=i.getLocal("r"),s=i.i32_add(i.getLocal("r"),i.i32_const(o)),_=i.i32_add(i.getLocal("r"),i.i32_const(2*o));a.addCode(i.call(l+"_timesScalar",c,i.getLocal("scalar"),i.getLocal("scalarLen"),r),i.call(l+"_timesScalar",n,i.getLocal("scalar"),i.getLocal("scalarLen"),s),i.call(l+"_timesScalar",d,i.getLocal("scalar"),i.getLocal("scalarLen"),_))}(),!function(){let a=t.addFunction(e+"_isNegative");a.addParam("x","i32"),a.setReturnType("i32");let i=a.getCodeBuilder(),c=i.getLocal("x"),n=i.i32_add(i.getLocal("x"),i.i32_const(o)),d=i.i32_add(i.getLocal("x"),i.i32_const(2*o));a.addCode(i.if(i.call(l+"_isZero",d),i.if(i.call(l+"_isZero",n),i.ret(i.call(l+"_isNegative",c)),i.ret(i.call(l+"_isNegative",n)))),i.ret(i.call(l+"_isNegative",d)))}(),t.exportFunction(e+"_isZero"),t.exportFunction(e+"_isOne"),t.exportFunction(e+"_zero"),t.exportFunction(e+"_one"),t.exportFunction(e+"_copy"),t.exportFunction(e+"_mul"),t.exportFunction(e+"_square"),t.exportFunction(e+"_add"),t.exportFunction(e+"_sub"),t.exportFunction(e+"_neg"),t.exportFunction(e+"_sign"),t.exportFunction(e+"_fromMontgomery"),t.exportFunction(e+"_toMontgomery"),t.exportFunction(e+"_eq"),t.exportFunction(e+"_inverse"),buildBatchInverse$3(t,e),build_timesscalar(t,e+"_exp",3*o,e+"_mul",e+"_square",e+"_copy",e+"_one"),t.exportFunction(e+"_exp"),t.exportFunction(e+"_timesScalar"),t.exportFunction(e+"_batchInverse"),t.exportFunction(e+"_isNegative"),e};let buildTimesScalarNAF=function(t,a,e,l,o,i,c,n){let d=t.addFunction(a);d.addParam("base","i32"),d.addParam("scalar","i32"),d.addParam("scalarLength","i32"),d.addParam("r","i32"),d.addLocal("old0","i32"),d.addLocal("nbits","i32"),d.addLocal("i","i32"),d.addLocal("last","i32"),d.addLocal("cur","i32"),d.addLocal("carry","i32"),d.addLocal("p","i32");let r=d.getCodeBuilder(),s=r.i32_const(t.alloc(e));function getBit(t){return r.i32_and(r.i32_shr_u(r.i32_load(r.i32_add(r.getLocal("scalar"),r.i32_and(r.i32_shr_u(t,r.i32_const(3)),r.i32_const(4294967292)))),r.i32_and(t,r.i32_const(31))),r.i32_const(1))}function pushBit(t){return[...r.i32_store8(r.getLocal("p"),r.i32_const(t)),...r.setLocal("p",r.i32_add(r.getLocal("p"),r.i32_const(1)))]}d.addCode(r.if(r.i32_eqz(r.getLocal("scalarLength")),[...r.call(n,r.getLocal("r")),...r.ret([])]),r.setLocal("nbits",r.i32_shl(r.getLocal("scalarLength"),r.i32_const(3))),r.setLocal("old0",r.i32_load(r.i32_const(0))),r.setLocal("p",r.getLocal("old0")),r.i32_store(r.i32_const(0),r.i32_and(r.i32_add(r.i32_add(r.getLocal("old0"),r.i32_const(32)),r.getLocal("nbits")),r.i32_const(4294967288))),r.setLocal("i",r.i32_const(1)),r.setLocal("last",getBit(r.i32_const(0))),r.setLocal("carry",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("nbits"))),r.setLocal("cur",getBit(r.getLocal("i"))),r.if(r.getLocal("last"),r.if(r.getLocal("cur"),r.if(r.getLocal("carry"),[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(1)),...pushBit(1)],[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(1)),...pushBit(255)]),r.if(r.getLocal("carry"),[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(1)),...pushBit(255)],[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(0)),...pushBit(1)])),r.if(r.getLocal("cur"),r.if(r.getLocal("carry"),[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(1)),...pushBit(0)],[...r.setLocal("last",r.i32_const(1)),...r.setLocal("carry",r.i32_const(0)),...pushBit(0)]),r.if(r.getLocal("carry"),[...r.setLocal("last",r.i32_const(1)),...r.setLocal("carry",r.i32_const(0)),...pushBit(0)],[...r.setLocal("last",r.i32_const(0)),...r.setLocal("carry",r.i32_const(0)),...pushBit(0)]))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))),r.if(r.getLocal("last"),r.if(r.getLocal("carry"),[...pushBit(255),...pushBit(0),...pushBit(1)],[...pushBit(1)]),r.if(r.getLocal("carry"),[...pushBit(0),...pushBit(1)])),r.setLocal("p",r.i32_sub(r.getLocal("p"),r.i32_const(1))),r.call(c,r.getLocal("base"),s),r.call(n,r.getLocal("r")),r.block(r.loop(r.call(o,r.getLocal("r"),r.getLocal("r")),r.setLocal("cur",r.i32_load8_u(r.getLocal("p"))),r.if(r.getLocal("cur"),r.if(r.i32_eq(r.getLocal("cur"),r.i32_const(1)),r.call(l,r.getLocal("r"),s,r.getLocal("r")),r.call(i,r.getLocal("r"),s,r.getLocal("r")))),r.br_if(1,r.i32_eq(r.getLocal("old0"),r.getLocal("p"))),r.setLocal("p",r.i32_sub(r.getLocal("p"),r.i32_const(1))),r.br(0))),r.i32_store(r.i32_const(0),r.getLocal("old0")))},buildMultiexp$1=function(t,a,e,l,o){let i=t.modules[a].n64,c=8*i;!function(){let a=t.addFunction(e+"_getChunk");a.addParam("pScalar","i32"),a.addParam("scalarSize","i32"),a.addParam("startBit","i32"),a.addParam("chunkSize","i32"),a.addLocal("bitsToEnd","i32"),a.addLocal("mask","i32"),a.setReturnType("i32");let l=a.getCodeBuilder();a.addCode(l.setLocal("bitsToEnd",l.i32_sub(l.i32_mul(l.getLocal("scalarSize"),l.i32_const(8)),l.getLocal("startBit"))),l.if(l.i32_gt_s(l.getLocal("chunkSize"),l.getLocal("bitsToEnd")),l.setLocal("mask",l.i32_sub(l.i32_shl(l.i32_const(1),l.getLocal("bitsToEnd")),l.i32_const(1))),l.setLocal("mask",l.i32_sub(l.i32_shl(l.i32_const(1),l.getLocal("chunkSize")),l.i32_const(1)))),l.i32_and(l.i32_shr_u(l.i32_load(l.i32_add(l.getLocal("pScalar"),l.i32_shr_u(l.getLocal("startBit"),l.i32_const(3))),0,0),l.i32_and(l.getLocal("startBit"),l.i32_const(7))),l.getLocal("mask")))}(),function(){let l=t.addFunction(e+"_reduceTable");l.addParam("pTable","i32"),l.addParam("p","i32"),l.addLocal("half","i32"),l.addLocal("it1","i32"),l.addLocal("it2","i32"),l.addLocal("pAcc","i32");let o=l.getCodeBuilder();l.addCode(o.if(o.i32_eq(o.getLocal("p"),o.i32_const(1)),o.ret([])),o.setLocal("half",o.i32_shl(o.i32_const(1),o.i32_sub(o.getLocal("p"),o.i32_const(1)))),o.setLocal("it1",o.getLocal("pTable")),o.setLocal("it2",o.i32_add(o.getLocal("pTable"),o.i32_mul(o.getLocal("half"),o.i32_const(c)))),o.setLocal("pAcc",o.i32_sub(o.getLocal("it2"),o.i32_const(c))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("it1"),o.getLocal("pAcc"))),o.call(a+"_add",o.getLocal("it1"),o.getLocal("it2"),o.getLocal("it1")),o.call(a+"_add",o.getLocal("pAcc"),o.getLocal("it2"),o.getLocal("pAcc")),o.setLocal("it1",o.i32_add(o.getLocal("it1"),o.i32_const(c))),o.setLocal("it2",o.i32_add(o.getLocal("it2"),o.i32_const(c))),o.br(0))),o.call(e+"_reduceTable",o.getLocal("pTable"),o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.setLocal("p",o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("p"))),o.call(a+"_double",o.getLocal("pAcc"),o.getLocal("pAcc")),o.setLocal("p",o.i32_sub(o.getLocal("p"),o.i32_const(1))),o.br(0))),o.call(a+"_add",o.getLocal("pTable"),o.getLocal("pAcc"),o.getLocal("pTable")))}(),function(){let i=t.addFunction(e+"_chunk");i.addParam("pBases","i32"),i.addParam("pScalars","i32"),i.addParam("scalarSize","i32"),i.addParam("n","i32"),i.addParam("startBit","i32"),i.addParam("chunkSize","i32"),i.addParam("pr","i32"),i.addLocal("nChunks","i32"),i.addLocal("itScalar","i32"),i.addLocal("endScalar","i32"),i.addLocal("itBase","i32"),i.addLocal("i","i32"),i.addLocal("j","i32"),i.addLocal("nTable","i32"),i.addLocal("pTable","i32"),i.addLocal("idx","i32"),i.addLocal("pIdxTable","i32");let n=i.getCodeBuilder();i.addCode(n.if(n.i32_eqz(n.getLocal("n")),[...n.call(a+"_zero",n.getLocal("pr")),...n.ret([])]),n.setLocal("nTable",n.i32_shl(n.i32_const(1),n.getLocal("chunkSize"))),n.setLocal("pTable",n.i32_load(n.i32_const(0))),n.i32_store(n.i32_const(0),n.i32_add(n.getLocal("pTable"),n.i32_mul(n.getLocal("nTable"),n.i32_const(c)))),n.setLocal("j",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("j"),n.getLocal("nTable"))),n.call(a+"_zero",n.i32_add(n.getLocal("pTable"),n.i32_mul(n.getLocal("j"),n.i32_const(c)))),n.setLocal("j",n.i32_add(n.getLocal("j"),n.i32_const(1))),n.br(0))),n.setLocal("itBase",n.getLocal("pBases")),n.setLocal("itScalar",n.getLocal("pScalars")),n.setLocal("endScalar",n.i32_add(n.getLocal("pScalars"),n.i32_mul(n.getLocal("n"),n.getLocal("scalarSize")))),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("itScalar"),n.getLocal("endScalar"))),n.setLocal("idx",n.call(e+"_getChunk",n.getLocal("itScalar"),n.getLocal("scalarSize"),n.getLocal("startBit"),n.getLocal("chunkSize"))),n.if(n.getLocal("idx"),[...n.setLocal("pIdxTable",n.i32_add(n.getLocal("pTable"),n.i32_mul(n.i32_sub(n.getLocal("idx"),n.i32_const(1)),n.i32_const(c)))),...n.call(l,n.getLocal("pIdxTable"),n.getLocal("itBase"),n.getLocal("pIdxTable"))]),n.setLocal("itScalar",n.i32_add(n.getLocal("itScalar"),n.getLocal("scalarSize"))),n.setLocal("itBase",n.i32_add(n.getLocal("itBase"),n.i32_const(o))),n.br(0))),n.call(e+"_reduceTable",n.getLocal("pTable"),n.getLocal("chunkSize")),n.call(a+"_copy",n.getLocal("pTable"),n.getLocal("pr")),n.i32_store(n.i32_const(0),n.getLocal("pTable")))}(),function(){let l=t.addFunction(e);l.addParam("pBases","i32"),l.addParam("pScalars","i32"),l.addParam("scalarSize","i32"),l.addParam("n","i32"),l.addParam("pr","i32"),l.addLocal("chunkSize","i32"),l.addLocal("nChunks","i32"),l.addLocal("itScalar","i32"),l.addLocal("endScalar","i32"),l.addLocal("itBase","i32"),l.addLocal("itBit","i32"),l.addLocal("i","i32"),l.addLocal("j","i32"),l.addLocal("nTable","i32"),l.addLocal("pTable","i32"),l.addLocal("idx","i32"),l.addLocal("pIdxTable","i32");let o=l.getCodeBuilder(),i=o.i32_const(t.alloc(c)),n=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);l.addCode(o.call(a+"_zero",o.getLocal("pr")),o.if(o.i32_eqz(o.getLocal("n")),o.ret([])),o.setLocal("chunkSize",o.i32_load8_u(o.i32_clz(o.getLocal("n")),n)),o.setLocal("nChunks",o.i32_add(o.i32_div_u(o.i32_sub(o.i32_shl(o.getLocal("scalarSize"),o.i32_const(3)),o.i32_const(1)),o.getLocal("chunkSize")),o.i32_const(1))),o.setLocal("itBit",o.i32_mul(o.i32_sub(o.getLocal("nChunks"),o.i32_const(1)),o.getLocal("chunkSize"))),o.block(o.loop(o.br_if(1,o.i32_lt_s(o.getLocal("itBit"),o.i32_const(0))),o.if(o.i32_eqz(o.call(a+"_isZero",o.getLocal("pr"))),[...o.setLocal("j",o.i32_const(0)),...o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("j"),o.getLocal("chunkSize"))),o.call(a+"_double",o.getLocal("pr"),o.getLocal("pr")),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0)))]),o.call(e+"_chunk",o.getLocal("pBases"),o.getLocal("pScalars"),o.getLocal("scalarSize"),o.getLocal("n"),o.getLocal("itBit"),o.getLocal("chunkSize"),i),o.call(a+"_add",o.getLocal("pr"),i,o.getLocal("pr")),o.setLocal("itBit",o.i32_sub(o.getLocal("itBit"),o.getLocal("chunkSize"))),o.br(0))))}(),t.exportFunction(e),t.exportFunction(e+"_chunk")};var build_curve_jacobian_a0=function(t,a,e,l){let o=t.modules[e].n64,i=8*o;return t.modules[a]||(t.modules[a]={n64:3*o},function(){let l=t.addFunction(a+"_isZeroAffine");l.addParam("p1","i32"),l.setReturnType("i32");let o=l.getCodeBuilder();l.addCode(o.i32_and(o.call(e+"_isZero",o.getLocal("p1")),o.call(e+"_isZero",o.i32_add(o.getLocal("p1"),o.i32_const(i)))))}(),function(){let l=t.addFunction(a+"_isZero");l.addParam("p1","i32"),l.setReturnType("i32");let o=l.getCodeBuilder();l.addCode(o.call(e+"_isZero",o.i32_add(o.getLocal("p1"),o.i32_const(2*i))))}(),function(){let l=t.addFunction(a+"_zeroAffine");l.addParam("pr","i32");let o=l.getCodeBuilder();l.addCode(o.call(e+"_zero",o.getLocal("pr"))),l.addCode(o.call(e+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(i))))}(),function(){let l=t.addFunction(a+"_zero");l.addParam("pr","i32");let o=l.getCodeBuilder();l.addCode(o.call(e+"_zero",o.getLocal("pr"))),l.addCode(o.call(e+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(i)))),l.addCode(o.call(e+"_zero",o.i32_add(o.getLocal("pr"),o.i32_const(2*i))))}(),function(){let e=t.addFunction(a+"_copyAffine");e.addParam("ps","i32"),e.addParam("pd","i32");let l=e.getCodeBuilder();for(let t=0;t<2*o;t++)e.addCode(l.i64_store(l.getLocal("pd"),8*t,l.i64_load(l.getLocal("ps"),8*t)))}(),function(){let e=t.addFunction(a+"_copy");e.addParam("ps","i32"),e.addParam("pd","i32");let l=e.getCodeBuilder();for(let t=0;t<3*o;t++)e.addCode(l.i64_store(l.getLocal("pd"),8*t,l.i64_load(l.getLocal("ps"),8*t)))}(),function(){let l=t.addFunction(a+"_toJacobian");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i)),d=o.getLocal("pr"),r=o.i32_add(o.getLocal("pr"),o.i32_const(i)),s=o.i32_add(o.getLocal("pr"),o.i32_const(2*i));l.addCode(o.if(o.call(a+"_isZeroAffine",o.getLocal("p1")),o.call(a+"_zero",o.getLocal("pr")),[...o.call(e+"_one",s),...o.call(e+"_copy",n,r),...o.call(e+"_copy",c,d)]))}(),function(){let l=t.addFunction(a+"_eqAffine");l.addParam("p1","i32"),l.addParam("p2","i32"),l.setReturnType("i32"),l.addLocal("z1","i32");let o=l.getCodeBuilder();l.addCode(o.ret(o.i32_and(o.call(e+"_eq",o.getLocal("p1"),o.getLocal("p2")),o.call(e+"_eq",o.i32_add(o.getLocal("p1"),o.i32_const(i)),o.i32_add(o.getLocal("p2"),o.i32_const(i))))))}(),function(){let l=t.addFunction(a+"_eqMixed");l.addParam("p1","i32"),l.addParam("p2","i32"),l.setReturnType("i32"),l.addLocal("z1","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i));l.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*i))));let d=o.getLocal("z1"),r=o.getLocal("p2"),s=o.i32_add(o.getLocal("p2"),o.i32_const(i)),_=o.i32_const(t.alloc(i)),u=o.i32_const(t.alloc(i)),f=o.i32_const(t.alloc(i)),g=o.i32_const(t.alloc(i));l.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),o.ret(o.call(a+"_isZeroAffine",o.getLocal("p2")))),o.if(o.call(a+"_isZeroAffine",o.getLocal("p2")),o.ret(o.i32_const(0))),o.if(o.call(e+"_isOne",d),o.ret(o.call(a+"_eqAffine",o.getLocal("p1"),o.getLocal("p2")))),o.call(e+"_square",d,_),o.call(e+"_mul",r,_,u),o.call(e+"_mul",d,_,f),o.call(e+"_mul",s,f,g),o.if(o.call(e+"_eq",c,u),o.if(o.call(e+"_eq",n,g),o.ret(o.i32_const(1)))),o.ret(o.i32_const(0)))}(),function(){let l=t.addFunction(a+"_eq");l.addParam("p1","i32"),l.addParam("p2","i32"),l.setReturnType("i32"),l.addLocal("z1","i32"),l.addLocal("z2","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i));l.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*i))));let d=o.getLocal("z1"),r=o.getLocal("p2"),s=o.i32_add(o.getLocal("p2"),o.i32_const(i));l.addCode(o.setLocal("z2",o.i32_add(o.getLocal("p2"),o.i32_const(2*i))));let _=o.getLocal("z2"),u=o.i32_const(t.alloc(i)),f=o.i32_const(t.alloc(i)),g=o.i32_const(t.alloc(i)),p=o.i32_const(t.alloc(i)),L=o.i32_const(t.alloc(i)),m=o.i32_const(t.alloc(i)),h=o.i32_const(t.alloc(i)),b=o.i32_const(t.alloc(i));l.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),o.ret(o.call(a+"_isZero",o.getLocal("p2")))),o.if(o.call(a+"_isZero",o.getLocal("p2")),o.ret(o.i32_const(0))),o.if(o.call(e+"_isOne",d),o.ret(o.call(a+"_eqMixed",o.getLocal("p2"),o.getLocal("p1")))),o.if(o.call(e+"_isOne",_),o.ret(o.call(a+"_eqMixed",o.getLocal("p1"),o.getLocal("p2")))),o.call(e+"_square",d,u),o.call(e+"_square",_,f),o.call(e+"_mul",c,f,g),o.call(e+"_mul",r,u,p),o.call(e+"_mul",d,u,L),o.call(e+"_mul",_,f,m),o.call(e+"_mul",n,m,h),o.call(e+"_mul",s,L,b),o.if(o.call(e+"_eq",g,p),o.if(o.call(e+"_eq",h,b),o.ret(o.i32_const(1)))),o.ret(o.i32_const(0)))}(),function(){let l=t.addFunction(a+"_doubleAffine");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i)),d=o.getLocal("pr"),r=o.i32_add(o.getLocal("pr"),o.i32_const(i)),s=o.i32_add(o.getLocal("pr"),o.i32_const(2*i)),_=o.i32_const(t.alloc(i)),u=o.i32_const(t.alloc(i)),f=o.i32_const(t.alloc(i)),g=o.i32_const(t.alloc(i)),p=o.i32_const(t.alloc(i)),L=o.i32_const(t.alloc(i));l.addCode(o.if(o.call(a+"_isZeroAffine",o.getLocal("p1")),[...o.call(a+"_toJacobian",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.call(e+"_square",c,_),o.call(e+"_square",n,u),o.call(e+"_square",u,f),o.call(e+"_add",c,u,g),o.call(e+"_square",g,g),o.call(e+"_sub",g,_,g),o.call(e+"_sub",g,f,g),o.call(e+"_add",g,g,g),o.call(e+"_add",_,_,p),o.call(e+"_add",p,_,p),o.call(e+"_add",n,n,s),o.call(e+"_square",p,d),o.call(e+"_sub",d,g,d),o.call(e+"_sub",d,g,d),o.call(e+"_add",f,f,L),o.call(e+"_add",L,L,L),o.call(e+"_add",L,L,L),o.call(e+"_sub",g,d,r),o.call(e+"_mul",r,p,r),o.call(e+"_sub",r,L,r))}(),function(){let l=t.addFunction(a+"_double");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i)),d=o.i32_add(o.getLocal("p1"),o.i32_const(2*i)),r=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(i)),_=o.i32_add(o.getLocal("pr"),o.i32_const(2*i)),u=o.i32_const(t.alloc(i)),f=o.i32_const(t.alloc(i)),g=o.i32_const(t.alloc(i)),p=o.i32_const(t.alloc(i)),L=o.i32_const(t.alloc(i)),m=o.i32_const(t.alloc(i)),h=o.i32_const(t.alloc(i)),b=o.i32_const(t.alloc(i));l.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),[...o.call(a+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(e+"_isOne",d),[...o.ret(o.call(a+"_doubleAffine",o.getLocal("p1"),o.getLocal("pr"))),...o.ret([])]),o.call(e+"_square",c,u),o.call(e+"_square",n,f),o.call(e+"_square",f,g),o.call(e+"_add",c,f,p),o.call(e+"_square",p,p),o.call(e+"_sub",p,u,p),o.call(e+"_sub",p,g,p),o.call(e+"_add",p,p,p),o.call(e+"_add",u,u,L),o.call(e+"_add",L,u,L),o.call(e+"_square",L,m),o.call(e+"_mul",n,d,h),o.call(e+"_add",p,p,r),o.call(e+"_sub",m,r,r),o.call(e+"_add",g,g,b),o.call(e+"_add",b,b,b),o.call(e+"_add",b,b,b),o.call(e+"_sub",p,r,s),o.call(e+"_mul",s,L,s),o.call(e+"_sub",s,b,s),o.call(e+"_add",h,h,_))}(),function(){let l=t.addFunction(a+"_addAffine");l.addParam("p1","i32"),l.addParam("p2","i32"),l.addParam("pr","i32"),l.addLocal("z1","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i));l.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*i))));let d=o.getLocal("p2"),r=o.i32_add(o.getLocal("p2"),o.i32_const(i)),s=o.getLocal("pr"),_=o.i32_add(o.getLocal("pr"),o.i32_const(i)),u=o.i32_add(o.getLocal("pr"),o.i32_const(2*i)),f=o.i32_const(t.alloc(i)),g=o.i32_const(t.alloc(i)),p=o.i32_const(t.alloc(i)),L=o.i32_const(t.alloc(i)),m=o.i32_const(t.alloc(i)),h=o.i32_const(t.alloc(i)),b=o.i32_const(t.alloc(i)),x=o.i32_const(t.alloc(i)),y=o.i32_const(t.alloc(i)),F=o.i32_const(t.alloc(i));l.addCode(o.if(o.call(a+"_isZeroAffine",o.getLocal("p1")),[...o.call(a+"_copyAffine",o.getLocal("p2"),o.getLocal("pr")),...o.call(e+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*i))),...o.ret([])]),o.if(o.call(a+"_isZeroAffine",o.getLocal("p2")),[...o.call(a+"_copyAffine",o.getLocal("p1"),o.getLocal("pr")),...o.call(e+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*i))),...o.ret([])]),o.if(o.call(e+"_eq",c,d),o.if(o.call(e+"_eq",n,r),[...o.call(a+"_doubleAffine",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])])),o.call(e+"_sub",d,c,f),o.call(e+"_sub",r,n,p),o.call(e+"_square",f,g),o.call(e+"_add",g,g,L),o.call(e+"_add",L,L,L),o.call(e+"_mul",f,L,m),o.call(e+"_add",p,p,h),o.call(e+"_mul",c,L,x),o.call(e+"_square",h,b),o.call(e+"_add",x,x,y),o.call(e+"_sub",b,m,s),o.call(e+"_sub",s,y,s),o.call(e+"_mul",n,m,F),o.call(e+"_add",F,F,F),o.call(e+"_sub",x,s,_),o.call(e+"_mul",_,h,_),o.call(e+"_sub",_,F,_),o.call(e+"_add",f,f,u))}(),function(){let l=t.addFunction(a+"_addMixed");l.addParam("p1","i32"),l.addParam("p2","i32"),l.addParam("pr","i32"),l.addLocal("z1","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i));l.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*i))));let d=o.getLocal("z1"),r=o.getLocal("p2"),s=o.i32_add(o.getLocal("p2"),o.i32_const(i)),_=o.getLocal("pr"),u=o.i32_add(o.getLocal("pr"),o.i32_const(i)),f=o.i32_add(o.getLocal("pr"),o.i32_const(2*i)),g=o.i32_const(t.alloc(i)),p=o.i32_const(t.alloc(i)),L=o.i32_const(t.alloc(i)),m=o.i32_const(t.alloc(i)),h=o.i32_const(t.alloc(i)),b=o.i32_const(t.alloc(i)),x=o.i32_const(t.alloc(i)),y=o.i32_const(t.alloc(i)),F=o.i32_const(t.alloc(i)),B=o.i32_const(t.alloc(i)),C=o.i32_const(t.alloc(i)),v=o.i32_const(t.alloc(i)),P=o.i32_const(t.alloc(i)),q=o.i32_const(t.alloc(i));l.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),[...o.call(a+"_copyAffine",o.getLocal("p2"),o.getLocal("pr")),...o.call(e+"_one",o.i32_add(o.getLocal("pr"),o.i32_const(2*i))),...o.ret([])]),o.if(o.call(a+"_isZeroAffine",o.getLocal("p2")),[...o.call(a+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(e+"_isOne",d),[...o.call(a+"_addAffine",c,r,_),...o.ret([])]),o.call(e+"_square",d,g),o.call(e+"_mul",r,g,p),o.call(e+"_mul",d,g,L),o.call(e+"_mul",s,L,m),o.if(o.call(e+"_eq",c,p),o.if(o.call(e+"_eq",n,m),[...o.call(a+"_doubleAffine",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])])),o.call(e+"_sub",p,c,h),o.call(e+"_sub",m,n,x),o.call(e+"_square",h,b),o.call(e+"_add",b,b,y),o.call(e+"_add",y,y,y),o.call(e+"_mul",h,y,F),o.call(e+"_add",x,x,B),o.call(e+"_mul",c,y,v),o.call(e+"_square",B,C),o.call(e+"_add",v,v,P),o.call(e+"_sub",C,F,_),o.call(e+"_sub",_,P,_),o.call(e+"_mul",n,F,q),o.call(e+"_add",q,q,q),o.call(e+"_sub",v,_,u),o.call(e+"_mul",u,B,u),o.call(e+"_sub",u,q,u),o.call(e+"_add",d,h,f),o.call(e+"_square",f,f),o.call(e+"_sub",f,g,f),o.call(e+"_sub",f,b,f))}(),function(){let l=t.addFunction(a+"_add");l.addParam("p1","i32"),l.addParam("p2","i32"),l.addParam("pr","i32"),l.addLocal("z1","i32"),l.addLocal("z2","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i));l.addCode(o.setLocal("z1",o.i32_add(o.getLocal("p1"),o.i32_const(2*i))));let d=o.getLocal("z1"),r=o.getLocal("p2"),s=o.i32_add(o.getLocal("p2"),o.i32_const(i));l.addCode(o.setLocal("z2",o.i32_add(o.getLocal("p2"),o.i32_const(2*i))));let _=o.getLocal("z2"),u=o.getLocal("pr"),f=o.i32_add(o.getLocal("pr"),o.i32_const(i)),g=o.i32_add(o.getLocal("pr"),o.i32_const(2*i)),p=o.i32_const(t.alloc(i)),L=o.i32_const(t.alloc(i)),m=o.i32_const(t.alloc(i)),h=o.i32_const(t.alloc(i)),b=o.i32_const(t.alloc(i)),x=o.i32_const(t.alloc(i)),y=o.i32_const(t.alloc(i)),F=o.i32_const(t.alloc(i)),B=o.i32_const(t.alloc(i)),C=o.i32_const(t.alloc(i)),v=o.i32_const(t.alloc(i)),P=o.i32_const(t.alloc(i)),q=o.i32_const(t.alloc(i)),A=o.i32_const(t.alloc(i)),I=o.i32_const(t.alloc(i)),E=o.i32_const(t.alloc(i)),O=o.i32_const(t.alloc(i));l.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),[...o.call(a+"_copy",o.getLocal("p2"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(a+"_isZero",o.getLocal("p2")),[...o.call(a+"_copy",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])]),o.if(o.call(e+"_isOne",d),[...o.call(a+"_addMixed",r,c,u),...o.ret([])]),o.if(o.call(e+"_isOne",_),[...o.call(a+"_addMixed",c,r,u),...o.ret([])]),o.call(e+"_square",d,p),o.call(e+"_square",_,L),o.call(e+"_mul",c,L,m),o.call(e+"_mul",r,p,h),o.call(e+"_mul",d,p,b),o.call(e+"_mul",_,L,x),o.call(e+"_mul",n,x,y),o.call(e+"_mul",s,b,F),o.if(o.call(e+"_eq",m,h),o.if(o.call(e+"_eq",y,F),[...o.call(a+"_double",o.getLocal("p1"),o.getLocal("pr")),...o.ret([])])),o.call(e+"_sub",h,m,B),o.call(e+"_sub",F,y,C),o.call(e+"_add",B,B,v),o.call(e+"_square",v,v),o.call(e+"_mul",B,v,P),o.call(e+"_add",C,C,q),o.call(e+"_mul",m,v,I),o.call(e+"_square",q,A),o.call(e+"_add",I,I,E),o.call(e+"_sub",A,P,u),o.call(e+"_sub",u,E,u),o.call(e+"_mul",y,P,O),o.call(e+"_add",O,O,O),o.call(e+"_sub",I,u,f),o.call(e+"_mul",f,q,f),o.call(e+"_sub",f,O,f),o.call(e+"_add",d,_,g),o.call(e+"_square",g,g),o.call(e+"_sub",g,p,g),o.call(e+"_sub",g,L,g),o.call(e+"_mul",g,B,g))}(),function(){let l=t.addFunction(a+"_negAffine");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i)),d=o.getLocal("pr"),r=o.i32_add(o.getLocal("pr"),o.i32_const(i));l.addCode(o.call(e+"_copy",c,d),o.call(e+"_neg",n,r))}(),function(){let l=t.addFunction(a+"_neg");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i)),d=o.i32_add(o.getLocal("p1"),o.i32_const(2*i)),r=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(i)),_=o.i32_add(o.getLocal("pr"),o.i32_const(2*i));l.addCode(o.call(e+"_copy",c,r),o.call(e+"_neg",n,s),o.call(e+"_copy",d,_))}(),function(){let e=t.addFunction(a+"_subAffine");e.addParam("p1","i32"),e.addParam("p2","i32"),e.addParam("pr","i32");let l=e.getCodeBuilder(),o=l.i32_const(t.alloc(3*i));e.addCode(l.call(a+"_negAffine",l.getLocal("p2"),o),l.call(a+"_addAffine",l.getLocal("p1"),o,l.getLocal("pr")))}(),function(){let e=t.addFunction(a+"_subMixed");e.addParam("p1","i32"),e.addParam("p2","i32"),e.addParam("pr","i32");let l=e.getCodeBuilder(),o=l.i32_const(t.alloc(3*i));e.addCode(l.call(a+"_negAffine",l.getLocal("p2"),o),l.call(a+"_addMixed",l.getLocal("p1"),o,l.getLocal("pr")))}(),function(){let e=t.addFunction(a+"_sub");e.addParam("p1","i32"),e.addParam("p2","i32"),e.addParam("pr","i32");let l=e.getCodeBuilder(),o=l.i32_const(t.alloc(3*i));e.addCode(l.call(a+"_neg",l.getLocal("p2"),o),l.call(a+"_add",l.getLocal("p1"),o,l.getLocal("pr")))}(),function(){let l=t.addFunction(a+"_fromMontgomeryAffine");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder();l.addCode(o.call(e+"_fromMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<2;t++)l.addCode(o.call(e+"_fromMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*i)),o.i32_add(o.getLocal("pr"),o.i32_const(t*i))))}(),function(){let l=t.addFunction(a+"_fromMontgomery");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder();l.addCode(o.call(e+"_fromMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<3;t++)l.addCode(o.call(e+"_fromMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*i)),o.i32_add(o.getLocal("pr"),o.i32_const(t*i))))}(),function(){let l=t.addFunction(a+"_toMontgomeryAffine");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder();l.addCode(o.call(e+"_toMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<2;t++)l.addCode(o.call(e+"_toMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*i)),o.i32_add(o.getLocal("pr"),o.i32_const(t*i))))}(),function(){let l=t.addFunction(a+"_toMontgomery");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder();l.addCode(o.call(e+"_toMontgomery",o.getLocal("p1"),o.getLocal("pr")));for(let t=1;t<3;t++)l.addCode(o.call(e+"_toMontgomery",o.i32_add(o.getLocal("p1"),o.i32_const(t*i)),o.i32_add(o.getLocal("pr"),o.i32_const(t*i))))}(),function(){let l=t.addFunction(a+"_toAffine");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i)),d=o.i32_add(o.getLocal("p1"),o.i32_const(2*i)),r=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(i)),_=o.i32_const(t.alloc(i)),u=o.i32_const(t.alloc(i)),f=o.i32_const(t.alloc(i));l.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),[...o.call(e+"_zero",r),...o.call(e+"_zero",s)],[...o.call(e+"_inverse",d,_),...o.call(e+"_square",_,u),...o.call(e+"_mul",_,u,f),...o.call(e+"_mul",c,u,r),...o.call(e+"_mul",n,f,s)]))}(),function(){let o=t.addFunction(a+"_inCurveAffine");o.addParam("pIn","i32"),o.setReturnType("i32");let c=o.getCodeBuilder(),n=c.getLocal("pIn"),d=c.i32_add(c.getLocal("pIn"),c.i32_const(i)),r=c.i32_const(t.alloc(i)),s=c.i32_const(t.alloc(i));o.addCode(c.call(e+"_square",d,r),c.call(e+"_square",n,s),c.call(e+"_mul",n,s,s),c.call(e+"_add",s,c.i32_const(l),s),c.ret(c.call(e+"_eq",r,s)))}(),function(){let e=t.addFunction(a+"_inCurve");e.addParam("pIn","i32"),e.setReturnType("i32");let l=e.getCodeBuilder(),o=l.i32_const(t.alloc(2*i));e.addCode(l.call(a+"_toAffine",l.getLocal("pIn"),o),l.ret(l.call(a+"_inCurveAffine",o)))}(),function(){let l=t.addFunction(a+"_batchToAffine");l.addParam("pIn","i32"),l.addParam("n","i32"),l.addParam("pOut","i32"),l.addLocal("pAux","i32"),l.addLocal("itIn","i32"),l.addLocal("itAux","i32"),l.addLocal("itOut","i32"),l.addLocal("i","i32");let o=l.getCodeBuilder(),c=o.i32_const(t.alloc(i));l.addCode(o.setLocal("pAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("pAux"),o.i32_mul(o.getLocal("n"),o.i32_const(i)))),o.call(e+"_batchInverse",o.i32_add(o.getLocal("pIn"),o.i32_const(2*i)),o.i32_const(3*i),o.getLocal("n"),o.getLocal("pAux"),o.i32_const(i)),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.getLocal("pAux")),o.setLocal("itOut",o.getLocal("pOut")),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(e+"_isZero",o.getLocal("itAux")),[...o.call(e+"_zero",o.getLocal("itOut")),...o.call(e+"_zero",o.i32_add(o.getLocal("itOut"),o.i32_const(i)))],[...o.call(e+"_mul",o.getLocal("itAux"),o.i32_add(o.getLocal("itIn"),o.i32_const(i)),c),...o.call(e+"_square",o.getLocal("itAux"),o.getLocal("itAux")),...o.call(e+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.getLocal("itOut")),...o.call(e+"_mul",o.getLocal("itAux"),c,o.i32_add(o.getLocal("itOut"),o.i32_const(i)))]),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.i32_const(3*i))),o.setLocal("itOut",o.i32_add(o.getLocal("itOut"),o.i32_const(2*i))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(i))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.i32_store(o.i32_const(0),o.getLocal("pAux")))}(),function(){let l=t.addFunction(a+"_normalize");l.addParam("p1","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder(),c=o.getLocal("p1"),n=o.i32_add(o.getLocal("p1"),o.i32_const(i)),d=o.i32_add(o.getLocal("p1"),o.i32_const(2*i)),r=o.getLocal("pr"),s=o.i32_add(o.getLocal("pr"),o.i32_const(i)),_=o.i32_add(o.getLocal("pr"),o.i32_const(2*i)),u=o.i32_const(t.alloc(i)),f=o.i32_const(t.alloc(i)),g=o.i32_const(t.alloc(i));l.addCode(o.if(o.call(a+"_isZero",o.getLocal("p1")),o.call(a+"_zero",o.getLocal("pr")),[...o.call(e+"_inverse",d,u),...o.call(e+"_square",u,f),...o.call(e+"_mul",u,f,g),...o.call(e+"_mul",c,f,r),...o.call(e+"_mul",n,g,s),...o.call(e+"_one",_)]))}(),function(){let e=t.addFunction(a+"__reverseBytes");e.addParam("pIn","i32"),e.addParam("n","i32"),e.addParam("pOut","i32"),e.addLocal("itOut","i32"),e.addLocal("itIn","i32");let l=e.getCodeBuilder();e.addCode(l.setLocal("itOut",l.i32_sub(l.i32_add(l.getLocal("pOut"),l.getLocal("n")),l.i32_const(1))),l.setLocal("itIn",l.getLocal("pIn")),l.block(l.loop(l.br_if(1,l.i32_lt_s(l.getLocal("itOut"),l.getLocal("pOut"))),l.i32_store8(l.getLocal("itOut"),l.i32_load8_u(l.getLocal("itIn"))),l.setLocal("itOut",l.i32_sub(l.getLocal("itOut"),l.i32_const(1))),l.setLocal("itIn",l.i32_add(l.getLocal("itIn"),l.i32_const(1))),l.br(0))))}(),function(){let e=t.addFunction(a+"_LEMtoU");e.addParam("pIn","i32"),e.addParam("pOut","i32");let l=e.getCodeBuilder(),o=t.alloc(2*i),c=l.i32_const(o),n=l.i32_const(o),d=l.i32_const(o+i);e.addCode(l.if(l.call(a+"_isZeroAffine",l.getLocal("pIn")),[...l.call(a+"_zeroAffine",l.getLocal("pOut")),...l.ret([])]),l.call(a+"_fromMontgomeryAffine",l.getLocal("pIn"),c),l.call(a+"__reverseBytes",n,l.i32_const(i),l.getLocal("pOut")),l.call(a+"__reverseBytes",d,l.i32_const(i),l.i32_add(l.getLocal("pOut"),l.i32_const(i))))}(),function(){let l=t.addFunction(a+"_LEMtoC");l.addParam("pIn","i32"),l.addParam("pOut","i32");let o=l.getCodeBuilder(),c=o.i32_const(t.alloc(i));l.addCode(o.if(o.call(a+"_isZeroAffine",o.getLocal("pIn")),[...o.call(e+"_zero",o.getLocal("pOut")),...o.i32_store8(o.getLocal("pOut"),o.i32_const(64)),...o.ret([])]),o.call(e+"_fromMontgomery",o.getLocal("pIn"),c),o.call(a+"__reverseBytes",c,o.i32_const(i),o.getLocal("pOut")),o.if(o.i32_eq(o.call(e+"_sign",o.i32_add(o.getLocal("pIn"),o.i32_const(i))),o.i32_const(-1)),o.i32_store8(o.getLocal("pOut"),o.i32_or(o.i32_load8_u(o.getLocal("pOut")),o.i32_const(128)))))}(),function(){let e=t.addFunction(a+"_UtoLEM");e.addParam("pIn","i32"),e.addParam("pOut","i32");let l=e.getCodeBuilder(),o=t.alloc(2*i),c=l.i32_const(o),n=l.i32_const(o),d=l.i32_const(o+i);e.addCode(l.if(l.i32_and(l.i32_load8_u(l.getLocal("pIn")),l.i32_const(64)),[...l.call(a+"_zeroAffine",l.getLocal("pOut")),...l.ret([])]),l.call(a+"__reverseBytes",l.getLocal("pIn"),l.i32_const(i),n),l.call(a+"__reverseBytes",l.i32_add(l.getLocal("pIn"),l.i32_const(i)),l.i32_const(i),d),l.call(a+"_toMontgomeryAffine",c,l.getLocal("pOut")))}(),function(){let o=t.addFunction(a+"_CtoLEM");o.addParam("pIn","i32"),o.addParam("pOut","i32"),o.addLocal("firstByte","i32"),o.addLocal("greatest","i32");let c=o.getCodeBuilder(),n=t.alloc(2*i),d=c.i32_const(n),r=c.i32_const(n+i);o.addCode(c.setLocal("firstByte",c.i32_load8_u(c.getLocal("pIn"))),c.if(c.i32_and(c.getLocal("firstByte"),c.i32_const(64)),[...c.call(a+"_zeroAffine",c.getLocal("pOut")),...c.ret([])]),c.setLocal("greatest",c.i32_and(c.getLocal("firstByte"),c.i32_const(128))),c.call(e+"_copy",c.getLocal("pIn"),r),c.i32_store8(r,c.i32_and(c.getLocal("firstByte"),c.i32_const(63))),c.call(a+"__reverseBytes",r,c.i32_const(i),d),c.call(e+"_toMontgomery",d,c.getLocal("pOut")),c.call(e+"_square",c.getLocal("pOut"),r),c.call(e+"_mul",c.getLocal("pOut"),r,r),c.call(e+"_add",r,c.i32_const(l),r),c.call(e+"_sqrt",r,r),c.call(e+"_neg",r,d),c.if(c.i32_eq(c.call(e+"_sign",r),c.i32_const(-1)),c.if(c.getLocal("greatest"),c.call(e+"_copy",r,c.i32_add(c.getLocal("pOut"),c.i32_const(i))),c.call(e+"_neg",r,c.i32_add(c.getLocal("pOut"),c.i32_const(i)))),c.if(c.getLocal("greatest"),c.call(e+"_neg",r,c.i32_add(c.getLocal("pOut"),c.i32_const(i))),c.call(e+"_copy",r,c.i32_add(c.getLocal("pOut"),c.i32_const(i))))))}(),buildBatchConvertion$3(t,a+"_batchLEMtoU",a+"_LEMtoU",2*i,2*i),buildBatchConvertion$3(t,a+"_batchLEMtoC",a+"_LEMtoC",2*i,i),buildBatchConvertion$3(t,a+"_batchUtoLEM",a+"_UtoLEM",2*i,2*i),buildBatchConvertion$3(t,a+"_batchCtoLEM",a+"_CtoLEM",i,2*i,!0),buildBatchConvertion$3(t,a+"_batchToJacobian",a+"_toJacobian",2*i,3*i,!0),buildMultiexp$1(t,a,a+"_multiexp",a+"_add",3*i),buildMultiexp$1(t,a,a+"_multiexpAffine",a+"_addMixed",2*i),buildTimesScalarNAF(t,a+"_timesScalar",3*i,a+"_add",a+"_double",a+"_sub",a+"_copy",a+"_zero"),buildTimesScalarNAF(t,a+"_timesScalarAffine",2*i,a+"_addMixed",a+"_double",a+"_subMixed",a+"_copyAffine",a+"_zero"),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isZeroAffine"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_eqMixed"),t.exportFunction(a+"_eqAffine"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_copyAffine"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_zeroAffine"),t.exportFunction(a+"_double"),t.exportFunction(a+"_doubleAffine"),t.exportFunction(a+"_add"),t.exportFunction(a+"_addMixed"),t.exportFunction(a+"_addAffine"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_negAffine"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_subMixed"),t.exportFunction(a+"_subAffine"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_fromMontgomeryAffine"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_toMontgomeryAffine"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_timesScalarAffine"),t.exportFunction(a+"_normalize"),t.exportFunction(a+"_LEMtoU"),t.exportFunction(a+"_LEMtoC"),t.exportFunction(a+"_UtoLEM"),t.exportFunction(a+"_CtoLEM"),t.exportFunction(a+"_batchLEMtoU"),t.exportFunction(a+"_batchLEMtoC"),t.exportFunction(a+"_batchUtoLEM"),t.exportFunction(a+"_batchCtoLEM"),t.exportFunction(a+"_toAffine"),t.exportFunction(a+"_toJacobian"),t.exportFunction(a+"_batchToAffine"),t.exportFunction(a+"_batchToJacobian"),t.exportFunction(a+"_inCurve"),t.exportFunction(a+"_inCurveAffine")),a};let{isOdd:b,modInv:x,modPow:y}=_;var build_fft=function(t,a,e,l,o){let i=t.modules[l].n64,c=8*i,n=t.modules[e].n64,d=8*n,r=t.modules[l].q,_=r-1n,u=0;for(;!b(_);)u++,_>>=1n;let f=2n;for(;1n===y(f,r>>1n,r);)f+=1n;let g=Array(u+1);g[u]=y(f,_,r);let p=u-1;for(;p>=0;)g[p]=y(g[p+1],2n,r),p--;let L=[],m=(1n<<BigInt(8*c))%r;for(let t=0;t<g.length;t++){let a=g[t]*m%r;L.push(...s.bigInt2BytesLE(a,c))}let h=t.alloc(L),F=Array(u+1);F[0]=1n;for(let t=1;t<=u;t++)F[t]=2n*F[t-1];let B=[];for(let t=0;t<=u;t++){let a=x(F[t],r)*m%r;B.push(...s.bigInt2BytesLE(a,c))}let C=t.alloc(B),v=y(f,2n,r),P=[],q=[];for(let t=0;t<=u;t++){let a=y(v,2n**BigInt(t),r),e=x(r+1n-a,r);P.push(...s.bigInt2BytesLE(a*m%r,c)),q.push(...s.bigInt2BytesLE(e*m%r,c))}let A=t.alloc(P),I=t.alloc(q),E=Array(256);for(let t=0;t<256;t++)E[t]=function(t){let a=0;for(let e=0;e<8;e++)t&1<<e&&(a|=128>>e);return a}(t);let O=t.alloc(E);!function(){let e=t.addFunction(a+"__rev");e.addParam("x","i32"),e.addParam("bits","i32"),e.setReturnType("i32");let l=e.getCodeBuilder();e.addCode(l.i32_rotl(l.i32_add(l.i32_add(l.i32_shl(l.i32_load8_u(l.i32_and(l.getLocal("x"),l.i32_const(255)),O,0),l.i32_const(24)),l.i32_shl(l.i32_load8_u(l.i32_and(l.i32_shr_u(l.getLocal("x"),l.i32_const(8)),l.i32_const(255)),O,0),l.i32_const(16))),l.i32_add(l.i32_shl(l.i32_load8_u(l.i32_and(l.i32_shr_u(l.getLocal("x"),l.i32_const(16)),l.i32_const(255)),O,0),l.i32_const(8)),l.i32_load8_u(l.i32_and(l.i32_shr_u(l.getLocal("x"),l.i32_const(24)),l.i32_const(255)),O,0))),l.getLocal("bits")))}(),function(){let l=t.addFunction(a+"__reversePermutation");l.addParam("px","i32"),l.addParam("bits","i32"),l.addLocal("n","i32"),l.addLocal("i","i32"),l.addLocal("ri","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32");let o=l.getCodeBuilder(),i=o.i32_const(t.alloc(d));l.addCode(o.setLocal("n",o.i32_shl(o.i32_const(1),o.getLocal("bits"))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.setLocal("idx1",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("i"),o.i32_const(d)))),o.setLocal("ri",o.call(a+"__rev",o.getLocal("i"),o.getLocal("bits"))),o.setLocal("idx2",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("ri"),o.i32_const(d)))),o.if(o.i32_lt_u(o.getLocal("i"),o.getLocal("ri")),[...o.call(e+"_copy",o.getLocal("idx1"),i),...o.call(e+"_copy",o.getLocal("idx2"),o.getLocal("idx1")),...o.call(e+"_copy",i,o.getLocal("idx2"))]),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}(),function(){let i=t.addFunction(a+"__fftFinal");i.addParam("px","i32"),i.addParam("bits","i32"),i.addParam("reverse","i32"),i.addParam("mulFactor","i32"),i.addLocal("n","i32"),i.addLocal("ndiv2","i32"),i.addLocal("pInv2","i32"),i.addLocal("i","i32"),i.addLocal("mask","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32");let c=i.getCodeBuilder(),n=c.i32_const(t.alloc(d));i.addCode(c.if(c.i32_and(c.i32_eqz(c.getLocal("reverse")),c.call(l+"_isOne",c.getLocal("mulFactor"))),c.ret([])),c.setLocal("n",c.i32_shl(c.i32_const(1),c.getLocal("bits"))),c.setLocal("mask",c.i32_sub(c.getLocal("n"),c.i32_const(1))),c.setLocal("i",c.i32_const(1)),c.setLocal("ndiv2",c.i32_shr_u(c.getLocal("n"),c.i32_const(1))),c.block(c.loop(c.br_if(1,c.i32_ge_u(c.getLocal("i"),c.getLocal("ndiv2"))),c.setLocal("idx1",c.i32_add(c.getLocal("px"),c.i32_mul(c.getLocal("i"),c.i32_const(d)))),c.setLocal("idx2",c.i32_add(c.getLocal("px"),c.i32_mul(c.i32_sub(c.getLocal("n"),c.getLocal("i")),c.i32_const(d)))),c.if(c.getLocal("reverse"),c.if(c.call(l+"_isOne",c.getLocal("mulFactor")),[...c.call(e+"_copy",c.getLocal("idx1"),n),...c.call(e+"_copy",c.getLocal("idx2"),c.getLocal("idx1")),...c.call(e+"_copy",n,c.getLocal("idx2"))],[...c.call(e+"_copy",c.getLocal("idx1"),n),...c.call(o,c.getLocal("idx2"),c.getLocal("mulFactor"),c.getLocal("idx1")),...c.call(o,n,c.getLocal("mulFactor"),c.getLocal("idx2"))]),c.if(c.call(l+"_isOne",c.getLocal("mulFactor")),[],[...c.call(o,c.getLocal("idx1"),c.getLocal("mulFactor"),c.getLocal("idx1")),...c.call(o,c.getLocal("idx2"),c.getLocal("mulFactor"),c.getLocal("idx2"))])),c.setLocal("i",c.i32_add(c.getLocal("i"),c.i32_const(1))),c.br(0))),c.if(c.call(l+"_isOne",c.getLocal("mulFactor")),[],[...c.call(o,c.getLocal("px"),c.getLocal("mulFactor"),c.getLocal("px")),...c.setLocal("idx2",c.i32_add(c.getLocal("px"),c.i32_mul(c.getLocal("ndiv2"),c.i32_const(d)))),...c.call(o,c.getLocal("idx2"),c.getLocal("mulFactor"),c.getLocal("idx2"))]))}(),function(){let i=t.addFunction(a+"_rawfft");i.addParam("px","i32"),i.addParam("bits","i32"),i.addParam("reverse","i32"),i.addParam("mulFactor","i32"),i.addLocal("s","i32"),i.addLocal("k","i32"),i.addLocal("j","i32"),i.addLocal("m","i32"),i.addLocal("mdiv2","i32"),i.addLocal("n","i32"),i.addLocal("pwm","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32");let n=i.getCodeBuilder(),r=n.i32_const(t.alloc(c)),s=n.i32_const(t.alloc(d)),_=n.i32_const(t.alloc(d));i.addCode(n.call(a+"__reversePermutation",n.getLocal("px"),n.getLocal("bits")),n.setLocal("n",n.i32_shl(n.i32_const(1),n.getLocal("bits"))),n.setLocal("s",n.i32_const(1)),n.block(n.loop(n.br_if(1,n.i32_gt_u(n.getLocal("s"),n.getLocal("bits"))),n.setLocal("m",n.i32_shl(n.i32_const(1),n.getLocal("s"))),n.setLocal("pwm",n.i32_add(n.i32_const(h),n.i32_mul(n.getLocal("s"),n.i32_const(c)))),n.setLocal("k",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_ge_u(n.getLocal("k"),n.getLocal("n"))),n.call(l+"_one",r),n.setLocal("mdiv2",n.i32_shr_u(n.getLocal("m"),n.i32_const(1))),n.setLocal("j",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_ge_u(n.getLocal("j"),n.getLocal("mdiv2"))),n.setLocal("idx1",n.i32_add(n.getLocal("px"),n.i32_mul(n.i32_add(n.getLocal("k"),n.getLocal("j")),n.i32_const(d)))),n.setLocal("idx2",n.i32_add(n.getLocal("idx1"),n.i32_mul(n.getLocal("mdiv2"),n.i32_const(d)))),n.call(o,n.getLocal("idx2"),r,s),n.call(e+"_copy",n.getLocal("idx1"),_),n.call(e+"_add",_,s,n.getLocal("idx1")),n.call(e+"_sub",_,s,n.getLocal("idx2")),n.call(l+"_mul",r,n.getLocal("pwm"),r),n.setLocal("j",n.i32_add(n.getLocal("j"),n.i32_const(1))),n.br(0))),n.setLocal("k",n.i32_add(n.getLocal("k"),n.getLocal("m"))),n.br(0))),n.setLocal("s",n.i32_add(n.getLocal("s"),n.i32_const(1))),n.br(0))),n.call(a+"__fftFinal",n.getLocal("px"),n.getLocal("bits"),n.getLocal("reverse"),n.getLocal("mulFactor")))}(),function(){let e=t.addFunction(a+"__log2");e.addParam("n","i32"),e.setReturnType("i32"),e.addLocal("bits","i32"),e.addLocal("aux","i32");let l=e.getCodeBuilder();e.addCode(l.setLocal("aux",l.i32_shr_u(l.getLocal("n"),l.i32_const(1)))),e.addCode(l.setLocal("bits",l.i32_const(0))),e.addCode(l.block(l.loop(l.br_if(1,l.i32_eqz(l.getLocal("aux"))),l.setLocal("aux",l.i32_shr_u(l.getLocal("aux"),l.i32_const(1))),l.setLocal("bits",l.i32_add(l.getLocal("bits"),l.i32_const(1))),l.br(0)))),e.addCode(l.if(l.i32_ne(l.getLocal("n"),l.i32_shl(l.i32_const(1),l.getLocal("bits"))),l.unreachable())),e.addCode(l.if(l.i32_gt_u(l.getLocal("bits"),l.i32_const(u)),l.unreachable())),e.addCode(l.getLocal("bits"))}(),function(){let e=t.addFunction(a+"_fft");e.addParam("px","i32"),e.addParam("n","i32"),e.addLocal("bits","i32");let o=e.getCodeBuilder(),i=o.i32_const(t.alloc(c));e.addCode(o.setLocal("bits",o.call(a+"__log2",o.getLocal("n"))),o.call(l+"_one",i),o.call(a+"_rawfft",o.getLocal("px"),o.getLocal("bits"),o.i32_const(0),i))}(),function(){let e=t.addFunction(a+"_ifft");e.addParam("px","i32"),e.addParam("n","i32"),e.addLocal("bits","i32"),e.addLocal("pInv2","i32");let l=e.getCodeBuilder();e.addCode(l.setLocal("bits",l.call(a+"__log2",l.getLocal("n"))),l.setLocal("pInv2",l.i32_add(l.i32_const(C),l.i32_mul(l.getLocal("bits"),l.i32_const(c)))),l.call(a+"_rawfft",l.getLocal("px"),l.getLocal("bits"),l.i32_const(1),l.getLocal("pInv2")))}(),function(){let i=t.addFunction(a+"_fftJoin");i.addParam("pBuff1","i32"),i.addParam("pBuff2","i32"),i.addParam("n","i32"),i.addParam("first","i32"),i.addParam("inc","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32");let n=i.getCodeBuilder(),r=n.i32_const(t.alloc(c)),s=n.i32_const(t.alloc(d)),_=n.i32_const(t.alloc(d));i.addCode(n.call(l+"_copy",n.getLocal("first"),r),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("n"))),n.setLocal("idx1",n.i32_add(n.getLocal("pBuff1"),n.i32_mul(n.getLocal("i"),n.i32_const(d)))),n.setLocal("idx2",n.i32_add(n.getLocal("pBuff2"),n.i32_mul(n.getLocal("i"),n.i32_const(d)))),n.call(o,n.getLocal("idx2"),r,s),n.call(e+"_copy",n.getLocal("idx1"),_),n.call(e+"_add",_,s,n.getLocal("idx1")),n.call(e+"_sub",_,s,n.getLocal("idx2")),n.call(l+"_mul",r,n.getLocal("inc"),r),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),function(){let i=t.addFunction(a+"_fftJoinExt");i.addParam("pBuff1","i32"),i.addParam("pBuff2","i32"),i.addParam("n","i32"),i.addParam("first","i32"),i.addParam("inc","i32"),i.addParam("totalBits","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("pShiftToM","i32");let n=i.getCodeBuilder(),r=n.i32_const(t.alloc(c)),s=n.i32_const(t.alloc(d));i.addCode(n.setLocal("pShiftToM",n.i32_add(n.i32_const(A),n.i32_mul(n.getLocal("totalBits"),n.i32_const(c)))),n.call(l+"_copy",n.getLocal("first"),r),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("n"))),n.setLocal("idx1",n.i32_add(n.getLocal("pBuff1"),n.i32_mul(n.getLocal("i"),n.i32_const(d)))),n.setLocal("idx2",n.i32_add(n.getLocal("pBuff2"),n.i32_mul(n.getLocal("i"),n.i32_const(d)))),n.call(e+"_add",n.getLocal("idx1"),n.getLocal("idx2"),s),n.call(o,n.getLocal("idx2"),n.getLocal("pShiftToM"),n.getLocal("idx2")),n.call(e+"_add",n.getLocal("idx1"),n.getLocal("idx2"),n.getLocal("idx2")),n.call(o,n.getLocal("idx2"),r,n.getLocal("idx2")),n.call(e+"_copy",s,n.getLocal("idx1")),n.call(l+"_mul",r,n.getLocal("inc"),r),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),function(){let i=t.addFunction(a+"_fftJoinExtInv");i.addParam("pBuff1","i32"),i.addParam("pBuff2","i32"),i.addParam("n","i32"),i.addParam("first","i32"),i.addParam("inc","i32"),i.addParam("totalBits","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("pShiftToM","i32"),i.addLocal("pSConst","i32");let n=i.getCodeBuilder(),r=n.i32_const(t.alloc(c)),s=n.i32_const(t.alloc(d));i.addCode(n.setLocal("pShiftToM",n.i32_add(n.i32_const(A),n.i32_mul(n.getLocal("totalBits"),n.i32_const(c)))),n.setLocal("pSConst",n.i32_add(n.i32_const(I),n.i32_mul(n.getLocal("totalBits"),n.i32_const(c)))),n.call(l+"_copy",n.getLocal("first"),r),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("n"))),n.setLocal("idx1",n.i32_add(n.getLocal("pBuff1"),n.i32_mul(n.getLocal("i"),n.i32_const(d)))),n.setLocal("idx2",n.i32_add(n.getLocal("pBuff2"),n.i32_mul(n.getLocal("i"),n.i32_const(d)))),n.call(o,n.getLocal("idx2"),r,s),n.call(e+"_sub",n.getLocal("idx1"),s,n.getLocal("idx2")),n.call(o,n.getLocal("idx2"),n.getLocal("pSConst"),n.getLocal("idx2")),n.call(o,n.getLocal("idx1"),n.getLocal("pShiftToM"),n.getLocal("idx1")),n.call(e+"_sub",s,n.getLocal("idx1"),n.getLocal("idx1")),n.call(o,n.getLocal("idx1"),n.getLocal("pSConst"),n.getLocal("idx1")),n.call(l+"_mul",r,n.getLocal("inc"),r),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),function(){let i=t.addFunction(a+"_fftMix");i.addParam("pBuff","i32"),i.addParam("n","i32"),i.addParam("exp","i32"),i.addLocal("nGroups","i32"),i.addLocal("nPerGroup","i32"),i.addLocal("nPerGroupDiv2","i32"),i.addLocal("pairOffset","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("j","i32"),i.addLocal("pwm","i32");let n=i.getCodeBuilder(),r=n.i32_const(t.alloc(c)),s=n.i32_const(t.alloc(d)),_=n.i32_const(t.alloc(d));i.addCode(n.setLocal("nPerGroup",n.i32_shl(n.i32_const(1),n.getLocal("exp"))),n.setLocal("nPerGroupDiv2",n.i32_shr_u(n.getLocal("nPerGroup"),n.i32_const(1))),n.setLocal("nGroups",n.i32_shr_u(n.getLocal("n"),n.getLocal("exp"))),n.setLocal("pairOffset",n.i32_mul(n.getLocal("nPerGroupDiv2"),n.i32_const(d))),n.setLocal("pwm",n.i32_add(n.i32_const(h),n.i32_mul(n.getLocal("exp"),n.i32_const(c)))),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("nGroups"))),n.call(l+"_one",r),n.setLocal("j",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("j"),n.getLocal("nPerGroupDiv2"))),n.setLocal("idx1",n.i32_add(n.getLocal("pBuff"),n.i32_mul(n.i32_add(n.i32_mul(n.getLocal("i"),n.getLocal("nPerGroup")),n.getLocal("j")),n.i32_const(d)))),n.setLocal("idx2",n.i32_add(n.getLocal("idx1"),n.getLocal("pairOffset"))),n.call(o,n.getLocal("idx2"),r,s),n.call(e+"_copy",n.getLocal("idx1"),_),n.call(e+"_add",_,s,n.getLocal("idx1")),n.call(e+"_sub",_,s,n.getLocal("idx2")),n.call(l+"_mul",r,n.getLocal("pwm"),r),n.setLocal("j",n.i32_add(n.getLocal("j"),n.i32_const(1))),n.br(0))),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),function(){let l=t.addFunction(a+"_fftFinal");l.addParam("pBuff","i32"),l.addParam("n","i32"),l.addParam("factor","i32"),l.addLocal("idx1","i32"),l.addLocal("idx2","i32"),l.addLocal("i","i32"),l.addLocal("ndiv2","i32");let i=l.getCodeBuilder(),c=i.i32_const(t.alloc(d));l.addCode(i.setLocal("ndiv2",i.i32_shr_u(i.getLocal("n"),i.i32_const(1))),i.if(i.i32_and(i.getLocal("n"),i.i32_const(1)),i.call(o,i.i32_add(i.getLocal("pBuff"),i.i32_mul(i.getLocal("ndiv2"),i.i32_const(d))),i.getLocal("factor"),i.i32_add(i.getLocal("pBuff"),i.i32_mul(i.getLocal("ndiv2"),i.i32_const(d))))),i.setLocal("i",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_ge_u(i.getLocal("i"),i.getLocal("ndiv2"))),i.setLocal("idx1",i.i32_add(i.getLocal("pBuff"),i.i32_mul(i.getLocal("i"),i.i32_const(d)))),i.setLocal("idx2",i.i32_add(i.getLocal("pBuff"),i.i32_mul(i.i32_sub(i.i32_sub(i.getLocal("n"),i.i32_const(1)),i.getLocal("i")),i.i32_const(d)))),i.call(o,i.getLocal("idx2"),i.getLocal("factor"),c),i.call(o,i.getLocal("idx1"),i.getLocal("factor"),i.getLocal("idx2")),i.call(e+"_copy",c,i.getLocal("idx1")),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))))}(),function(){let i=t.addFunction(a+"_prepareLagrangeEvaluation");i.addParam("pBuff1","i32"),i.addParam("pBuff2","i32"),i.addParam("n","i32"),i.addParam("first","i32"),i.addParam("inc","i32"),i.addParam("totalBits","i32"),i.addLocal("idx1","i32"),i.addLocal("idx2","i32"),i.addLocal("i","i32"),i.addLocal("pShiftToM","i32"),i.addLocal("pSConst","i32");let n=i.getCodeBuilder(),r=n.i32_const(t.alloc(c)),s=n.i32_const(t.alloc(d));i.addCode(n.setLocal("pShiftToM",n.i32_add(n.i32_const(A),n.i32_mul(n.getLocal("totalBits"),n.i32_const(c)))),n.setLocal("pSConst",n.i32_add(n.i32_const(I),n.i32_mul(n.getLocal("totalBits"),n.i32_const(c)))),n.call(l+"_copy",n.getLocal("first"),r),n.setLocal("i",n.i32_const(0)),n.block(n.loop(n.br_if(1,n.i32_eq(n.getLocal("i"),n.getLocal("n"))),n.setLocal("idx1",n.i32_add(n.getLocal("pBuff1"),n.i32_mul(n.getLocal("i"),n.i32_const(d)))),n.setLocal("idx2",n.i32_add(n.getLocal("pBuff2"),n.i32_mul(n.getLocal("i"),n.i32_const(d)))),n.call(o,n.getLocal("idx1"),n.getLocal("pShiftToM"),s),n.call(e+"_sub",n.getLocal("idx2"),s,s),n.call(e+"_sub",n.getLocal("idx1"),n.getLocal("idx2"),n.getLocal("idx2")),n.call(o,s,n.getLocal("pSConst"),n.getLocal("idx1")),n.call(o,n.getLocal("idx2"),r,n.getLocal("idx2")),n.call(l+"_mul",r,n.getLocal("inc"),r),n.setLocal("i",n.i32_add(n.getLocal("i"),n.i32_const(1))),n.br(0))))}(),t.exportFunction(a+"_fft"),t.exportFunction(a+"_ifft"),t.exportFunction(a+"_rawfft"),t.exportFunction(a+"_fftJoin"),t.exportFunction(a+"_fftJoinExt"),t.exportFunction(a+"_fftJoinExtInv"),t.exportFunction(a+"_fftMix"),t.exportFunction(a+"_fftFinal"),t.exportFunction(a+"_prepareLagrangeEvaluation")},build_pol=function(t,a,e){let l=t.modules[e].n64,o=8*l;return!function(){let l=t.addFunction(a+"_zero");l.addParam("px","i32"),l.addParam("n","i32"),l.addLocal("lastp","i32"),l.addLocal("p","i32");let i=l.getCodeBuilder();l.addCode(i.setLocal("p",i.getLocal("px")),i.setLocal("lastp",i.i32_add(i.getLocal("px"),i.i32_mul(i.getLocal("n"),i.i32_const(o)))),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("p"),i.getLocal("lastp"))),i.call(e+"_zero",i.getLocal("p")),i.setLocal("p",i.i32_add(i.getLocal("p"),i.i32_const(o))),i.br(0))))}(),!function(){let l=t.addFunction(a+"_constructLC");l.addParam("ppolynomials","i32"),l.addParam("psignals","i32"),l.addParam("nSignals","i32"),l.addParam("pres","i32"),l.addLocal("i","i32"),l.addLocal("j","i32"),l.addLocal("pp","i32"),l.addLocal("ps","i32"),l.addLocal("pd","i32"),l.addLocal("ncoefs","i32");let i=l.getCodeBuilder(),c=i.i32_const(t.alloc(o));l.addCode(i.setLocal("i",i.i32_const(0)),i.setLocal("pp",i.getLocal("ppolynomials")),i.setLocal("ps",i.getLocal("psignals")),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("i"),i.getLocal("nSignals"))),i.setLocal("ncoefs",i.i32_load(i.getLocal("pp"))),i.setLocal("pp",i.i32_add(i.getLocal("pp"),i.i32_const(4))),i.setLocal("j",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("j"),i.getLocal("ncoefs"))),i.setLocal("pd",i.i32_add(i.getLocal("pres"),i.i32_mul(i.i32_load(i.getLocal("pp")),i.i32_const(o)))),i.setLocal("pp",i.i32_add(i.getLocal("pp"),i.i32_const(4))),i.call(e+"_mul",i.getLocal("ps"),i.getLocal("pp"),c),i.call(e+"_add",c,i.getLocal("pd"),i.getLocal("pd")),i.setLocal("pp",i.i32_add(i.getLocal("pp"),i.i32_const(o))),i.setLocal("j",i.i32_add(i.getLocal("j"),i.i32_const(1))),i.br(0))),i.setLocal("ps",i.i32_add(i.getLocal("ps"),i.i32_const(o))),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))))}(),t.exportFunction(a+"_zero"),t.exportFunction(a+"_constructLC"),a},build_qap=function(t,a,e){let l=t.modules[e].n64,o=8*l;return!function(){let l=t.addFunction(a+"_buildABC");l.addParam("pCoefs","i32"),l.addParam("nCoefs","i32"),l.addParam("pWitness","i32"),l.addParam("pA","i32"),l.addParam("pB","i32"),l.addParam("pC","i32"),l.addParam("offsetOut","i32"),l.addParam("nOut","i32"),l.addParam("offsetWitness","i32"),l.addParam("nWitness","i32"),l.addLocal("it","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("last","i32"),l.addLocal("m","i32"),l.addLocal("c","i32"),l.addLocal("s","i32"),l.addLocal("pOut","i32");let i=l.getCodeBuilder(),c=i.i32_const(t.alloc(o));l.addCode(i.setLocal("ita",i.getLocal("pA")),i.setLocal("itb",i.getLocal("pB")),i.setLocal("last",i.i32_add(i.getLocal("pA"),i.i32_mul(i.getLocal("nOut"),i.i32_const(o)))),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("ita"),i.getLocal("last"))),i.call(e+"_zero",i.getLocal("ita")),i.call(e+"_zero",i.getLocal("itb")),i.setLocal("ita",i.i32_add(i.getLocal("ita"),i.i32_const(o))),i.setLocal("itb",i.i32_add(i.getLocal("itb"),i.i32_const(o))),i.br(0))),i.setLocal("it",i.getLocal("pCoefs")),i.setLocal("last",i.i32_add(i.getLocal("pCoefs"),i.i32_mul(i.getLocal("nCoefs"),i.i32_const(o+12)))),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("it"),i.getLocal("last"))),i.setLocal("s",i.i32_load(i.getLocal("it"),8)),i.if(i.i32_or(i.i32_lt_u(i.getLocal("s"),i.getLocal("offsetWitness")),i.i32_ge_u(i.getLocal("s"),i.i32_add(i.getLocal("offsetWitness"),i.getLocal("nWitness")))),[...i.setLocal("it",i.i32_add(i.getLocal("it"),i.i32_const(o+12))),...i.br(1)]),i.setLocal("m",i.i32_load(i.getLocal("it"))),i.if(i.i32_eq(i.getLocal("m"),i.i32_const(0)),i.setLocal("pOut",i.getLocal("pA")),i.if(i.i32_eq(i.getLocal("m"),i.i32_const(1)),i.setLocal("pOut",i.getLocal("pB")),[...i.setLocal("it",i.i32_add(i.getLocal("it"),i.i32_const(o+12))),...i.br(1)])),i.setLocal("c",i.i32_load(i.getLocal("it"),4)),i.if(i.i32_or(i.i32_lt_u(i.getLocal("c"),i.getLocal("offsetOut")),i.i32_ge_u(i.getLocal("c"),i.i32_add(i.getLocal("offsetOut"),i.getLocal("nOut")))),[...i.setLocal("it",i.i32_add(i.getLocal("it"),i.i32_const(o+12))),...i.br(1)]),i.setLocal("pOut",i.i32_add(i.getLocal("pOut"),i.i32_mul(i.i32_sub(i.getLocal("c"),i.getLocal("offsetOut")),i.i32_const(o)))),i.call(e+"_mul",i.i32_add(i.getLocal("pWitness"),i.i32_mul(i.i32_sub(i.getLocal("s"),i.getLocal("offsetWitness")),i.i32_const(o))),i.i32_add(i.getLocal("it"),i.i32_const(12)),c),i.call(e+"_add",i.getLocal("pOut"),c,i.getLocal("pOut")),i.setLocal("it",i.i32_add(i.getLocal("it"),i.i32_const(o+12))),i.br(0))),i.setLocal("ita",i.getLocal("pA")),i.setLocal("itb",i.getLocal("pB")),i.setLocal("it",i.getLocal("pC")),i.setLocal("last",i.i32_add(i.getLocal("pA"),i.i32_mul(i.getLocal("nOut"),i.i32_const(o)))),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("ita"),i.getLocal("last"))),i.call(e+"_mul",i.getLocal("ita"),i.getLocal("itb"),i.getLocal("it")),i.setLocal("ita",i.i32_add(i.getLocal("ita"),i.i32_const(o))),i.setLocal("itb",i.i32_add(i.getLocal("itb"),i.i32_const(o))),i.setLocal("it",i.i32_add(i.getLocal("it"),i.i32_const(o))),i.br(0))))}(),!function(){let l=t.addFunction(a+"_joinABC");l.addParam("pA","i32"),l.addParam("pB","i32"),l.addParam("pC","i32"),l.addParam("n","i32"),l.addParam("pP","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("itc","i32"),l.addLocal("itp","i32"),l.addLocal("last","i32");let i=l.getCodeBuilder(),c=i.i32_const(t.alloc(o));l.addCode(i.setLocal("ita",i.getLocal("pA")),i.setLocal("itb",i.getLocal("pB")),i.setLocal("itc",i.getLocal("pC")),i.setLocal("itp",i.getLocal("pP")),i.setLocal("last",i.i32_add(i.getLocal("pA"),i.i32_mul(i.getLocal("n"),i.i32_const(o)))),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("ita"),i.getLocal("last"))),i.call(e+"_mul",i.getLocal("ita"),i.getLocal("itb"),c),i.call(e+"_sub",c,i.getLocal("itc"),i.getLocal("itp")),i.setLocal("ita",i.i32_add(i.getLocal("ita"),i.i32_const(o))),i.setLocal("itb",i.i32_add(i.getLocal("itb"),i.i32_const(o))),i.setLocal("itc",i.i32_add(i.getLocal("itc"),i.i32_const(o))),i.setLocal("itp",i.i32_add(i.getLocal("itp"),i.i32_const(o))),i.br(0))))}(),!function(){let l=t.addFunction(a+"_batchAdd");l.addParam("pa","i32"),l.addParam("pb","i32"),l.addParam("n","i32"),l.addParam("pr","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("itr","i32"),l.addLocal("last","i32");let i=l.getCodeBuilder();l.addCode(i.setLocal("ita",i.getLocal("pa")),i.setLocal("itb",i.getLocal("pb")),i.setLocal("itr",i.getLocal("pr")),i.setLocal("last",i.i32_add(i.getLocal("pa"),i.i32_mul(i.getLocal("n"),i.i32_const(o)))),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("ita"),i.getLocal("last"))),i.call(e+"_add",i.getLocal("ita"),i.getLocal("itb"),i.getLocal("itr")),i.setLocal("ita",i.i32_add(i.getLocal("ita"),i.i32_const(o))),i.setLocal("itb",i.i32_add(i.getLocal("itb"),i.i32_const(o))),i.setLocal("itr",i.i32_add(i.getLocal("itr"),i.i32_const(o))),i.br(0))))}(),t.exportFunction(a+"_buildABC"),t.exportFunction(a+"_joinABC"),t.exportFunction(a+"_batchAdd"),a},build_applykey=function(t,a,e,l,o,i,c,n){let d=t.addFunction(a);d.addParam("pIn","i32"),d.addParam("n","i32"),d.addParam("pFirst","i32"),d.addParam("pInc","i32"),d.addParam("pOut","i32"),d.addLocal("pOldFree","i32"),d.addLocal("i","i32"),d.addLocal("pFrom","i32"),d.addLocal("pTo","i32");let r=d.getCodeBuilder(),s=r.i32_const(t.alloc(c));d.addCode(r.setLocal("pFrom",r.getLocal("pIn")),r.setLocal("pTo",r.getLocal("pOut"))),d.addCode(r.call(l+"_copy",r.getLocal("pFirst"),s)),d.addCode(r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.call(n,r.getLocal("pFrom"),s,r.getLocal("pTo")),r.setLocal("pFrom",r.i32_add(r.getLocal("pFrom"),r.i32_const(o))),r.setLocal("pTo",r.i32_add(r.getLocal("pTo"),r.i32_const(i))),r.call(l+"_mul",s,r.getLocal("pInc"),s),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0)))),t.exportFunction(a)};let{bitLength:F,modInv:B,isOdd:C,isNegative:v}=_,{bitLength:P,isOdd:q,isNegative:A}=_;var buildBn128$1=function(t,a){let e=a||"bn128";if(t.modules[e])return e;let l=Math.floor((F(0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n-1n)-1)/64)+1,o=8*l,i=2*o,c=12*o,n=t.alloc(s.bigInt2BytesLE(0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n,o)),d=build_f1m(t,0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n,"f1m");build_f1(t,0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n,"fr","frm");let r=t.alloc(s.bigInt2BytesLE(toMontgomery(3n),o)),_=build_curve_jacobian_a0(t,"g1m","f1m",r);build_fft(t,"frm","frm","frm","frm_mul"),build_pol(t,"pol","frm"),build_qap(t,"qap","frm");let u=build_f2m(t,"f1m_neg","f2m","f1m"),f=t.alloc([...s.bigInt2BytesLE(toMontgomery(0x2b149d40ceb8aaae81be18991be06ac3b5b4c5e559dbefa33267e6dc24a138e5n),o),...s.bigInt2BytesLE(toMontgomery(0x9713b03af0fed4cd2cafadeed8fdf4a74fa084e52d1852e4a2bd0685c315d2n),o)]),g=build_curve_jacobian_a0(t,"g2m","f2m",f);function buildGTimesFr(a,e){let l=t.addFunction(a);l.addParam("pG","i32"),l.addParam("pFr","i32"),l.addParam("pr","i32");let i=l.getCodeBuilder(),c=i.i32_const(t.alloc(o));l.addCode(i.call("frm_fromMontgomery",i.getLocal("pFr"),c),i.call(e,i.getLocal("pG"),c,i.i32_const(o),i.getLocal("pr"))),t.exportFunction(a)}function toMontgomery(t){return BigInt(t)*(1n<<BigInt(8*o))%0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n}buildGTimesFr("g1m_timesFr","g1m_timesScalar"),build_fft(t,"g1m","g1m","frm","g1m_timesFr"),buildGTimesFr("g2m_timesFr","g2m_timesScalar"),build_fft(t,"g2m","g2m","frm","g2m_timesFr"),buildGTimesFr("g1m_timesFrAffine","g1m_timesScalarAffine"),buildGTimesFr("g2m_timesFrAffine","g2m_timesScalarAffine"),build_applykey(t,"frm_batchApplyKey","fmr","frm",o,o,o,"frm_mul"),build_applykey(t,"g1m_batchApplyKey","g1m","frm",3*o,3*o,o,"g1m_timesFr"),build_applykey(t,"g1m_batchApplyKeyMixed","g1m","frm",2*o,3*o,o,"g1m_timesFrAffine"),build_applykey(t,"g2m_batchApplyKey","g2m","frm",6*o,6*o,o,"g2m_timesFr"),build_applykey(t,"g2m_batchApplyKeyMixed","g2m","frm",4*o,6*o,o,"g2m_timesFrAffine");let p=t.alloc([...s.bigInt2BytesLE(toMontgomery(1n),o),...s.bigInt2BytesLE(toMontgomery(2n),o),...s.bigInt2BytesLE(toMontgomery(1n),o)]),L=t.alloc([...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(1n),o),...s.bigInt2BytesLE(toMontgomery(0n),o)]),m=[[0x1800deef121f1e76426a00665e5c4479674322d4f75edadd46debd5cd992f6edn,0x198e9393920d483a7260bfb731fb5d25f1aa493335a9e71297e485b7aef312c2n],[0x12c85ea5db8c6deb4aab71808dcb408fe3d1e7690c43d37b4ce6cc0166fa7daan,0x90689d0585ff075ec9e99ad690c3395bc4b313370b38ef355acdadcd122975bn],[1n,0n]],h=t.alloc([...s.bigInt2BytesLE(toMontgomery(m[0][0]),o),...s.bigInt2BytesLE(toMontgomery(m[0][1]),o),...s.bigInt2BytesLE(toMontgomery(m[1][0]),o),...s.bigInt2BytesLE(toMontgomery(m[1][1]),o),...s.bigInt2BytesLE(toMontgomery(m[2][0]),o),...s.bigInt2BytesLE(toMontgomery(m[2][1]),o)]),b=[[0n,0n],[1n,0n],[0n,0n]],x=t.alloc([...s.bigInt2BytesLE(toMontgomery(b[0][0]),o),...s.bigInt2BytesLE(toMontgomery(b[0][1]),o),...s.bigInt2BytesLE(toMontgomery(b[1][0]),o),...s.bigInt2BytesLE(toMontgomery(b[1][1]),o),...s.bigInt2BytesLE(toMontgomery(b[2][0]),o),...s.bigInt2BytesLE(toMontgomery(b[2][1]),o)]),y=t.alloc([...s.bigInt2BytesLE(toMontgomery(1),o),...s.bigInt2BytesLE(toMontgomery(0),o),...s.bigInt2BytesLE(toMontgomery(0),o),...s.bigInt2BytesLE(toMontgomery(0),o),...s.bigInt2BytesLE(toMontgomery(0),o),...s.bigInt2BytesLE(toMontgomery(0),o),...s.bigInt2BytesLE(toMontgomery(0),o),...s.bigInt2BytesLE(toMontgomery(0),o),...s.bigInt2BytesLE(toMontgomery(0),o),...s.bigInt2BytesLE(toMontgomery(0),o),...s.bigInt2BytesLE(toMontgomery(0),o),...s.bigInt2BytesLE(toMontgomery(0),o)]),P=t.alloc([...s.bigInt2BytesLE(toMontgomery(9),o),...s.bigInt2BytesLE(toMontgomery(1),o)]),q=t.alloc([...s.bigInt2BytesLE(toMontgomery(B(2n,0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n)),o),...s.bigInt2BytesLE(0n,o)]),A=t.alloc([...s.bigInt2BytesLE(toMontgomery(0x2b149d40ceb8aaae81be18991be06ac3b5b4c5e559dbefa33267e6dc24a138e5n),o),...s.bigInt2BytesLE(toMontgomery(0x9713b03af0fed4cd2cafadeed8fdf4a74fa084e52d1852e4a2bd0685c315d2n),o)]);!function(){let a=t.addFunction(e+"_mulNR6");a.addParam("x","i32"),a.addParam("pr","i32");let l=a.getCodeBuilder();a.addCode(l.call(u+"_mul",l.i32_const(P),l.getLocal("x"),l.getLocal("pr")))}();let I=build_f3m(t,e+"_mulNR6","f6m","f2m");!function(){let a=t.addFunction(e+"_mulNR12");a.addParam("x","i32"),a.addParam("pr","i32");let l=a.getCodeBuilder();a.addCode(l.call(u+"_mul",l.i32_const(P),l.i32_add(l.getLocal("x"),l.i32_const(4*o)),l.getLocal("pr")),l.call(u+"_copy",l.getLocal("x"),l.i32_add(l.getLocal("pr"),l.i32_const(2*o))),l.call(u+"_copy",l.i32_add(l.getLocal("x"),l.i32_const(2*o)),l.i32_add(l.getLocal("pr"),l.i32_const(4*o))))}();let E=build_f2m(t,e+"_mulNR12","ftm",I),O=function(t){let a=0x19d797039be763ba8n,e=[];for(;a>0n;)C(a)?e.push(1):e.push(0),a>>=1n;return e}(0),w=t.alloc(O),M=3*i,S=O.length-1,T=O.reduce((t,a)=>t+(0!=a?1:0),0),z=6*o,R=3*o*2+(T+S+1)*M;t.modules[e]={n64:l,pG1gen:p,pG1zero:L,pG1b:r,pG2gen:h,pG2zero:x,pG2b:f,pq:t.modules.f1m.pq,pr:n,pOneT:y,prePSize:z,preQSize:R,r:0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n.toString(),q:0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n.toString()};let k=t.alloc(z),G=t.alloc(R);!function(){let a=t.addFunction(e+"_prepAddStep");a.addParam("pQ","i32"),a.addParam("pR","i32"),a.addParam("pCoef","i32");let l=a.getCodeBuilder(),o=l.getLocal("pQ"),c=l.i32_add(l.getLocal("pQ"),l.i32_const(i)),n=l.getLocal("pR"),d=l.i32_add(l.getLocal("pR"),l.i32_const(i)),r=l.i32_add(l.getLocal("pR"),l.i32_const(2*i)),s=l.getLocal("pCoef"),_=l.i32_add(l.getLocal("pCoef"),l.i32_const(i)),f=l.i32_add(l.getLocal("pCoef"),l.i32_const(2*i)),g=l.i32_const(t.alloc(i)),p=l.i32_const(t.alloc(i)),L=l.i32_const(t.alloc(i)),m=l.i32_const(t.alloc(i)),h=l.i32_const(t.alloc(i)),b=l.i32_const(t.alloc(i)),x=l.i32_const(t.alloc(i));a.addCode(l.call(u+"_mul",o,r,_),l.call(u+"_sub",n,_,_),l.call(u+"_mul",c,r,g),l.call(u+"_sub",d,g,g),l.call(u+"_square",_,p),l.call(u+"_square",g,L),l.call(u+"_mul",_,p,m),l.call(u+"_mul",n,p,h),l.call(u+"_add",h,h,x),l.call(u+"_mul",r,L,b),l.call(u+"_add",m,b,b),l.call(u+"_sub",b,x,b),l.call(u+"_mul",_,b,n),l.call(u+"_mul",m,d,d),l.call(u+"_sub",h,b,x),l.call(u+"_mul",g,x,x),l.call(u+"_sub",x,d,d),l.call(u+"_mul",r,m,r),l.call(u+"_mul",_,c,x),l.call(u+"_mul",g,o,s),l.call(u+"_sub",s,x,s),l.call(u+"_mul",s,l.i32_const(P),s),l.call(u+"_neg",g,f))}(),function(){let a=t.addFunction(e+"_prepDblStep");a.addParam("pR","i32"),a.addParam("pCoef","i32");let l=a.getCodeBuilder(),o=l.getLocal("pR"),c=l.i32_add(l.getLocal("pR"),l.i32_const(i)),n=l.i32_add(l.getLocal("pR"),l.i32_const(2*i)),d=l.getLocal("pCoef"),r=l.i32_add(l.getLocal("pCoef"),l.i32_const(i)),s=l.i32_add(l.getLocal("pCoef"),l.i32_const(2*i)),_=l.i32_const(t.alloc(i)),f=l.i32_const(t.alloc(i)),g=l.i32_const(t.alloc(i)),p=l.i32_const(t.alloc(i)),L=l.i32_const(t.alloc(i)),m=l.i32_const(t.alloc(i)),h=l.i32_const(t.alloc(i)),b=l.i32_const(t.alloc(i)),x=l.i32_const(t.alloc(i)),y=l.i32_const(t.alloc(i)),F=l.i32_const(t.alloc(i)),B=l.i32_const(t.alloc(i));a.addCode(l.call(u+"_mul",c,l.i32_const(q),_),l.call(u+"_mul",o,_,_),l.call(u+"_square",c,f),l.call(u+"_square",n,g),l.call(u+"_add",g,g,p),l.call(u+"_add",p,g,p),l.call(u+"_mul",l.i32_const(A),p,L),l.call(u+"_add",L,L,m),l.call(u+"_add",L,m,m),l.call(u+"_add",f,m,h),l.call(u+"_mul",h,l.i32_const(q),h),l.call(u+"_add",f,g,B),l.call(u+"_add",c,n,b),l.call(u+"_square",b,b),l.call(u+"_sub",b,B,b),l.call(u+"_sub",L,f,x),l.call(u+"_square",o,y),l.call(u+"_square",L,F),l.call(u+"_sub",f,m,B),l.call(u+"_mul",_,B,o),l.call(u+"_add",F,F,B),l.call(u+"_add",F,B,B),l.call(u+"_square",h,c),l.call(u+"_sub",c,B,c),l.call(u+"_mul",f,b,n),l.call(u+"_mul",l.i32_const(P),x,d),l.call(u+"_neg",b,r),l.call(u+"_add",y,y,s),l.call(u+"_add",y,s,s))}(),function(){let a=t.addFunction(e+"_prepareG1");a.addParam("pP","i32"),a.addParam("ppreP","i32");let l=a.getCodeBuilder();a.addCode(l.call(_+"_normalize",l.getLocal("pP"),l.getLocal("ppreP")))}(),function(){!function(){let a=t.addFunction(e+"_mulByQ");a.addParam("p1","i32"),a.addParam("pr","i32");let l=a.getCodeBuilder(),c=l.getLocal("p1"),n=l.i32_add(l.getLocal("p1"),l.i32_const(i)),d=l.i32_add(l.getLocal("p1"),l.i32_const(2*i)),r=l.getLocal("pr"),_=l.i32_add(l.getLocal("pr"),l.i32_const(i)),f=l.i32_add(l.getLocal("pr"),l.i32_const(2*i)),g=l.i32_const(t.alloc([...s.bigInt2BytesLE(toMontgomery("21575463638280843010398324269430826099269044274347216827212613867836435027261"),o),...s.bigInt2BytesLE(toMontgomery("10307601595873709700152284273816112264069230130616436755625194854815875713954"),o)])),p=l.i32_const(t.alloc([...s.bigInt2BytesLE(toMontgomery("2821565182194536844548159561693502659359617185244120367078079554186484126554"),o),...s.bigInt2BytesLE(toMontgomery("3505843767911556378687030309984248845540243509899259641013678093033130930403"),o)]));a.addCode(l.call(u+"_conjugate",c,r),l.call(u+"_mul",g,r,r),l.call(u+"_conjugate",n,_),l.call(u+"_mul",p,_,_),l.call(u+"_conjugate",d,f))}();let a=t.addFunction(e+"_prepareG2");a.addParam("pQ","i32"),a.addParam("ppreQ","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");let l=a.getCodeBuilder(),c=l.getLocal("pQ"),n=t.alloc(3*i),d=l.i32_const(n),r=l.i32_const(n),_=l.i32_const(n+i),f=l.i32_const(n+2*i),p=l.i32_add(l.getLocal("ppreQ"),l.i32_const(0)),L=l.i32_add(l.getLocal("ppreQ"),l.i32_const(i)),m=t.alloc(3*i),h=l.i32_const(m),b=t.alloc(3*i),x=l.i32_const(b),y=l.i32_const(b+i);a.addCode(l.call(g+"_normalize",c,p),l.call(u+"_copy",p,r),l.call(u+"_copy",L,_),l.call(u+"_one",f)),a.addCode(l.setLocal("pCoef",l.i32_add(l.getLocal("ppreQ"),l.i32_const(3*i))),l.setLocal("i",l.i32_const(O.length-2)),l.block(l.loop(l.call(e+"_prepDblStep",d,l.getLocal("pCoef")),l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(M))),l.if(l.i32_load8_s(l.getLocal("i"),w),[...l.call(e+"_prepAddStep",p,d,l.getLocal("pCoef")),...l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(M)))]),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.br(0)))),a.addCode(l.call(e+"_mulByQ",p,h),l.call(e+"_mulByQ",h,x)),a.addCode(l.call(u+"_neg",y,y),l.call(e+"_prepAddStep",h,d,l.getLocal("pCoef")),l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(M))),l.call(e+"_prepAddStep",x,d,l.getLocal("pCoef")),l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(M))))}(),function(){let a=t.addFunction(e+"__mulBy024");a.addParam("pEll0","i32"),a.addParam("pEllVW","i32"),a.addParam("pEllVV","i32"),a.addParam("pR","i32");let l=a.getCodeBuilder(),c=l.getLocal("pEll0"),n=l.getLocal("pEllVV"),d=l.getLocal("pEllVW"),r=l.getLocal("pR"),s=l.i32_add(l.getLocal("pR"),l.i32_const(2*o)),_=l.i32_add(l.getLocal("pR"),l.i32_const(4*o)),f=l.i32_add(l.getLocal("pR"),l.i32_const(6*o)),g=l.i32_add(l.getLocal("pR"),l.i32_const(8*o)),p=l.i32_add(l.getLocal("pR"),l.i32_const(10*o)),L=l.i32_const(t.alloc(i)),m=l.i32_const(t.alloc(i)),h=l.i32_const(t.alloc(i)),b=l.i32_const(t.alloc(i)),x=l.i32_const(t.alloc(i)),y=l.i32_const(t.alloc(i)),F=l.i32_const(t.alloc(i)),B=l.i32_const(t.alloc(i)),C=l.i32_const(t.alloc(i)),v=l.i32_const(t.alloc(i)),q=l.i32_const(t.alloc(i));a.addCode(l.call(u+"_mul",r,c,F),l.call(u+"_mul",_,n,B),l.call(u+"_mul",g,d,C),l.call(u+"_add",r,g,h),l.call(u+"_add",r,_,m),l.call(u+"_add",s,f,b),l.call(u+"_add",b,p,b),l.call(u+"_mul",s,n,v),l.call(u+"_add",v,C,x),l.call(u+"_mul",l.i32_const(P),x,y),l.call(u+"_add",y,F,r),l.call(u+"_mul",p,d,x),l.call(u+"_add",v,x,v),l.call(u+"_add",x,B,x),l.call(u+"_mul",l.i32_const(P),x,y),l.call(u+"_mul",s,c,x),l.call(u+"_add",v,x,v),l.call(u+"_add",y,x,s),l.call(u+"_add",c,n,L),l.call(u+"_mul",m,L,x),l.call(u+"_add",F,B,q),l.call(u+"_sub",x,q,x),l.call(u+"_mul",f,d,y),l.call(u+"_add",v,y,v),l.call(u+"_add",_,g,L),l.call(u+"_add",x,y,_),l.call(u+"_add",n,d,m),l.call(u+"_mul",m,L,x),l.call(u+"_add",B,C,q),l.call(u+"_sub",x,q,x),l.call(u+"_mul",l.i32_const(P),x,y),l.call(u+"_mul",f,c,x),l.call(u+"_add",v,x,v),l.call(u+"_add",y,x,f),l.call(u+"_mul",p,n,x),l.call(u+"_add",v,x,v),l.call(u+"_mul",l.i32_const(P),x,y),l.call(u+"_add",c,d,L),l.call(u+"_mul",h,L,x),l.call(u+"_add",F,C,q),l.call(u+"_sub",x,q,x),l.call(u+"_add",y,x,g),l.call(u+"_add",c,n,L),l.call(u+"_add",L,d,L),l.call(u+"_mul",b,L,x),l.call(u+"_sub",x,v,p))}(),function(){let a=t.addFunction(e+"__mulBy024Old");a.addParam("pEll0","i32"),a.addParam("pEllVW","i32"),a.addParam("pEllVV","i32"),a.addParam("pR","i32");let l=a.getCodeBuilder(),o=l.getLocal("pEll0"),n=l.getLocal("pEllVV"),d=l.getLocal("pEllVW"),r=l.getLocal("pR"),s=t.alloc(c),_=l.i32_const(s),f=l.i32_const(s),g=l.i32_const(s+i),p=l.i32_const(s+2*i),L=l.i32_const(s+3*i),m=l.i32_const(s+4*i),h=l.i32_const(s+5*i);a.addCode(l.call(u+"_copy",o,f),l.call(u+"_zero",g),l.call(u+"_copy",n,p),l.call(u+"_zero",L),l.call(u+"_copy",d,m),l.call(u+"_zero",h),l.call(E+"_mul",_,r,r))}(),function(){let a=t.addFunction(e+"_millerLoop");a.addParam("ppreP","i32"),a.addParam("ppreQ","i32"),a.addParam("r","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");let l=a.getCodeBuilder(),c=l.getLocal("ppreP"),n=l.i32_add(l.getLocal("ppreP"),l.i32_const(o)),d=l.getLocal("pCoef"),r=l.i32_add(l.getLocal("pCoef"),l.i32_const(i)),s=l.i32_add(l.getLocal("pCoef"),l.i32_const(2*i)),_=t.alloc(i),f=l.i32_const(_),g=t.alloc(i),p=l.i32_const(g),L=l.getLocal("r");a.addCode(l.call(E+"_one",L),l.setLocal("pCoef",l.i32_add(l.getLocal("ppreQ"),l.i32_const(3*i))),l.setLocal("i",l.i32_const(O.length-2)),l.block(l.loop(l.call(E+"_square",L,L),l.call(u+"_mul1",r,n,f),l.call(u+"_mul1",s,c,p),l.call(e+"__mulBy024",d,f,p,L),l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(M))),l.if(l.i32_load8_s(l.getLocal("i"),w),[...l.call(u+"_mul1",r,n,f),...l.call(u+"_mul1",s,c,p),...l.call(e+"__mulBy024",d,f,p,L),...l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(M)))]),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.br(0)))),a.addCode(l.call(u+"_mul1",r,n,f),l.call(u+"_mul1",s,c,p),l.call(e+"__mulBy024",d,f,p,L),l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(M))),l.call(u+"_mul1",r,n,f),l.call(u+"_mul1",s,c,p),l.call(e+"__mulBy024",d,f,p,L),l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(M))))}();for(let a=0;a<10;a++)!function(a){let l=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0x1284b71c2865a7dfe8b99fdd76e68b605c521e08292f2176d60b35dadcc9e470n,0x246996f3b4fae7e6a6327cfe12150b8e747992778eeec7e5ca5cf05f80f362acn],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd49n,0n],[0x19dc81cfcc82e4bbefe9608cd0acaa90894cb38dbe55d24ae86f7d391ed4a67fn,0xabf8b60be77d7306cbeee33576139d7f03a5e397d439ec7694aa2bf4c0c101n],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd48n,0n],[0x757cab3a41d3cdc072fc0af59c61f302cfa95859526b0d41264475e420ac20fn,0xca6b035381e35b618e9b79ba4e2606ca20b7dfd71573c93e85845e34c4a5b9cn],[0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd46n,0n],[0x1ddf9756b8cbf849cf96a5d90a9accfd3b2f4c893f42a9166615563bfbb318d7n,0xbfab77f2c36b843121dc8b86f6c4ccf2307d819d98302a771c39bb757899a9bn],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177fffffen,0n],[0x1687cca314aebb6dc866e529b0d4adcd0e34b703aa1bf84253b10eddb9a856c8n,0x2fb855bcd54a22b6b18456d34c0b44c0187dc4add09d90a0c58be1eae3bc3c46n],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177ffffffn,0n],[0x290c83bf3d14634db120850727bb392d6a86d50bd34b19b929bc44b896723b38n,0x23bd9e3da9136a739f668e1adc9ef7f0f575ec93f71a8df953c846338c32a1abn]]],c=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0x2fb347984f7911f74c0bec3cf559b143b78cc310c2c3330c99e39557176f553dn,0x16c9e55061ebae204ba4cc8bd75a079432ae2a1d0b7c9dce1665d51c640fcba2n],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd48n,0n],[0x856e078b755ef0abaff1c77959f25ac805ffd3d5d6942d37b746ee87bdcfb6dn,0x4f1de41b3d1766fa9f30e6dec26094f0fdf31bf98ff2631380cab2baaa586den],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177fffffen,0n],[0x28be74d4bb943f51699582b87809d9caf71614d4b0b71f3a62e913ee1dada9e4n,0x14a88ae0cb747b99c2b86abcbe01477a54f40eb4c3f6068dedae0bcec9c7aac7n]],[[1n,0n],[0x5b54f5e64eea80180f3c0b75a181e84d33365f7be94ec72848a1f55921ea762n,0x2c145edbe7fd8aee9f3a80b03b0b1c923685d2ea1bdec763c13b4711cd2b8126n],[0x59e26bcea0d48bacd4f263f1acdb5c4f5763473177fffffen,0n],[0xbc58c6611c08dab19bee0f7b5b2444ee633094575b06bcb0e1a92bc3ccbf066n,0x23d5e999e1910a12feb0f6ef0cd21d04a44a9e08737f96e55fe3ed9d730c239fn],[0x30644e72e131a0295e6dd9e7e0acccb0c28f069fbb966e3de4bd44e5607cfd48n,0n],[0x1ee972ae6a826a7d1d9da40771b6f589de1afb54342c724fa97bda050992657fn,0x10de546ff8d4ab51d2b513cdbb25772454326430418536d15721e37e70c255c9n]]],n=t.addFunction(e+"__frobeniusMap"+a);n.addParam("x","i32"),n.addParam("r","i32");let r=n.getCodeBuilder();for(let e=0;e<6;e++){let _=0==e?r.getLocal("x"):r.i32_add(r.getLocal("x"),r.i32_const(e*i)),f=r.i32_add(r.getLocal("x"),r.i32_const(e*i+o)),g=0==e?r.getLocal("r"):r.i32_add(r.getLocal("r"),r.i32_const(e*i)),p=r.i32_add(r.getLocal("r"),r.i32_const(e*i+o)),L=function(t,a){let e=BigInt(t[0]),l=BigInt(t[1]),o=BigInt(a[0]),i=BigInt(a[1]),c=[(e*o-l*i)%0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n,(e*i+l*o)%0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n];return v(c[0])&&(c[0]=c[0]+0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n),c}(l[Math.floor(e/3)][a%12],c[e%3][a%6]),m=t.alloc([...s.bigInt2BytesLE(toMontgomery(L[0]),32),...s.bigInt2BytesLE(toMontgomery(L[1]),32)]);a%2==1?n.addCode(r.call(d+"_copy",_,g),r.call(d+"_neg",f,p),r.call(u+"_mul",g,r.i32_const(m),g)):n.addCode(r.call(u+"_mul",_,r.i32_const(m),g))}}(a),t.exportFunction(e+"__frobeniusMap"+a);!function(){let a=t.addFunction(e+"_finalExponentiationOld");a.addParam("x","i32"),a.addParam("r","i32");let l=t.alloc(s.bigInt2BytesLE(0x2f4b6dc97020fddadf107d20bc842d43bf6369b1ff6a1c71015f3f7be2e1e30a73bb94fec0daf15466b2383a5d3ec3d15ad524d8f70c54efee1bd8c3b21377e563a09a1b705887e72eceaddea3790364a61f676baaf977870e88d5c6c8fef0781361e443ae77f5b63a2a2264487f2940a8b1ddb3d15062cd0fb2015dfc6668449aed3cc48a82d0d602d268c7daab6a41294c0cc4ebe5664568dfc50e1648a45a4a1e3a5195846a3ed011a337a02088ec80e0ebae8755cfe107acf3aafb40494e406f804216bb10cf430b0f37856b42db8dc5514724ee93dfb10826f0dd4a0364b9580291d2cd65664814fde37ca80bb4ea44eacc5e641bbadf423f9a2cbf813b8d145da90029baee7ddadda71c7f3811c4105262945bba1668c3be69a3c230974d83561841d766f9c9d570bb7fbe04c7e8a6c3c760c0de81def35692da361102b6b9b2b918837fa97896e84abb40a4efb7e54523a486964b64ca86f120n,352)),o=a.getCodeBuilder();a.addCode(o.call(E+"_exp",o.getLocal("x"),o.i32_const(l),o.i32_const(352),o.getLocal("r")))}(),function(){(function(){let a=t.addFunction(e+"__finalExponentiationFirstChunk");a.addParam("x","i32"),a.addParam("r","i32");let l=a.getCodeBuilder(),i=l.getLocal("x"),n=l.i32_add(i,l.i32_const(6*o)),d=l.getLocal("r"),r=t.alloc(c),s=l.i32_const(r),_=l.i32_const(r+6*o),u=l.i32_const(t.alloc(c)),f=l.i32_const(t.alloc(c)),g=l.i32_const(t.alloc(c));a.addCode(l.call(I+"_copy",i,s),l.call(I+"_neg",n,_),l.call(E+"_inverse",i,u),l.call(E+"_mul",s,u,f),l.call(e+"__frobeniusMap2",f,g),l.call(E+"_mul",f,g,d))})(),function(){(function(){let a=t.addFunction(e+"__cyclotomicSquare");a.addParam("x","i32"),a.addParam("r","i32");let l=a.getCodeBuilder(),o=l.getLocal("x"),c=l.i32_add(l.getLocal("x"),l.i32_const(i)),n=l.i32_add(l.getLocal("x"),l.i32_const(2*i)),d=l.i32_add(l.getLocal("x"),l.i32_const(3*i)),r=l.i32_add(l.getLocal("x"),l.i32_const(4*i)),s=l.i32_add(l.getLocal("x"),l.i32_const(5*i)),_=l.getLocal("r"),f=l.i32_add(l.getLocal("r"),l.i32_const(i)),g=l.i32_add(l.getLocal("r"),l.i32_const(2*i)),p=l.i32_add(l.getLocal("r"),l.i32_const(3*i)),L=l.i32_add(l.getLocal("r"),l.i32_const(4*i)),m=l.i32_add(l.getLocal("r"),l.i32_const(5*i)),h=l.i32_const(t.alloc(i)),b=l.i32_const(t.alloc(i)),x=l.i32_const(t.alloc(i)),y=l.i32_const(t.alloc(i)),F=l.i32_const(t.alloc(i)),B=l.i32_const(t.alloc(i)),C=l.i32_const(t.alloc(i)),v=l.i32_const(t.alloc(i));a.addCode(l.call(u+"_mul",o,r,C),l.call(u+"_mul",r,l.i32_const(P),h),l.call(u+"_add",o,h,h),l.call(u+"_add",o,r,v),l.call(u+"_mul",v,h,h),l.call(u+"_mul",l.i32_const(P),C,v),l.call(u+"_add",C,v,v),l.call(u+"_sub",h,v,h),l.call(u+"_add",C,C,b),l.call(u+"_mul",d,n,C),l.call(u+"_mul",n,l.i32_const(P),x),l.call(u+"_add",d,x,x),l.call(u+"_add",d,n,v),l.call(u+"_mul",v,x,x),l.call(u+"_mul",l.i32_const(P),C,v),l.call(u+"_add",C,v,v),l.call(u+"_sub",x,v,x),l.call(u+"_add",C,C,y),l.call(u+"_mul",c,s,C),l.call(u+"_mul",s,l.i32_const(P),F),l.call(u+"_add",c,F,F),l.call(u+"_add",c,s,v),l.call(u+"_mul",v,F,F),l.call(u+"_mul",l.i32_const(P),C,v),l.call(u+"_add",C,v,v),l.call(u+"_sub",F,v,F),l.call(u+"_add",C,C,B),l.call(u+"_sub",h,o,_),l.call(u+"_add",_,_,_),l.call(u+"_add",h,_,_),l.call(u+"_add",b,r,L),l.call(u+"_add",L,L,L),l.call(u+"_add",b,L,L),l.call(u+"_mul",B,l.i32_const(P),v),l.call(u+"_add",v,d,p),l.call(u+"_add",p,p,p),l.call(u+"_add",v,p,p),l.call(u+"_sub",F,n,g),l.call(u+"_add",g,g,g),l.call(u+"_add",F,g,g),l.call(u+"_sub",x,c,f),l.call(u+"_add",f,f,f),l.call(u+"_add",x,f,f),l.call(u+"_add",y,s,m),l.call(u+"_add",m,m,m),l.call(u+"_add",y,m,m))})(),function(a,l){let o=(function(t){let a=0x44e992b44a6909f1n,e=[];for(;a>0n;){if(C(a)){let t=2-Number(a%4n);e.push(t),a-=BigInt(t)}else e.push(0);a>>=1n}return e})(0).map(t=>-1==t?255:t),i=t.alloc(o),n=t.addFunction(e+"__cyclotomicExp_w0");n.addParam("x","i32"),n.addParam("r","i32"),n.addLocal("bit","i32"),n.addLocal("i","i32");let d=n.getCodeBuilder(),r=d.getLocal("x"),s=d.getLocal("r"),_=d.i32_const(t.alloc(c));n.addCode(d.call(E+"_conjugate",r,_),d.call(E+"_one",s),d.if(d.teeLocal("bit",d.i32_load8_s(d.i32_const(o.length-1),i)),d.if(d.i32_eq(d.getLocal("bit"),d.i32_const(1)),d.call(E+"_mul",s,r,s),d.call(E+"_mul",s,_,s))),d.setLocal("i",d.i32_const(o.length-2)),d.block(d.loop(d.call(e+"__cyclotomicSquare",s,s),d.if(d.teeLocal("bit",d.i32_load8_s(d.getLocal("i"),i)),d.if(d.i32_eq(d.getLocal("bit"),d.i32_const(1)),d.call(E+"_mul",s,r,s),d.call(E+"_mul",s,_,s))),d.br_if(1,d.i32_eqz(d.getLocal("i"))),d.setLocal("i",d.i32_sub(d.getLocal("i"),d.i32_const(1))),d.br(0))))}(0,0);let a=t.addFunction(e+"__finalExponentiationLastChunk");a.addParam("x","i32"),a.addParam("r","i32");let l=a.getCodeBuilder(),o=l.getLocal("x"),n=l.getLocal("r"),d=l.i32_const(t.alloc(c)),r=l.i32_const(t.alloc(c)),s=l.i32_const(t.alloc(c)),_=l.i32_const(t.alloc(c)),f=l.i32_const(t.alloc(c)),g=l.i32_const(t.alloc(c)),p=l.i32_const(t.alloc(c)),L=l.i32_const(t.alloc(c)),m=l.i32_const(t.alloc(c)),h=l.i32_const(t.alloc(c)),b=l.i32_const(t.alloc(c)),x=l.i32_const(t.alloc(c)),y=l.i32_const(t.alloc(c)),F=l.i32_const(t.alloc(c)),B=l.i32_const(t.alloc(c)),v=l.i32_const(t.alloc(c)),q=l.i32_const(t.alloc(c)),A=l.i32_const(t.alloc(c)),I=l.i32_const(t.alloc(c)),O=l.i32_const(t.alloc(c)),w=l.i32_const(t.alloc(c));a.addCode(l.call(e+"__cyclotomicExp_w0",o,d),l.call(E+"_conjugate",d,d),l.call(e+"__cyclotomicSquare",d,r),l.call(e+"__cyclotomicSquare",r,s),l.call(E+"_mul",s,r,_),l.call(e+"__cyclotomicExp_w0",_,f),l.call(E+"_conjugate",f,f),l.call(e+"__cyclotomicSquare",f,g),l.call(e+"__cyclotomicExp_w0",g,p),l.call(E+"_conjugate",p,p),l.call(E+"_conjugate",_,L),l.call(E+"_conjugate",p,m),l.call(E+"_mul",m,f,h),l.call(E+"_mul",h,L,b),l.call(E+"_mul",b,r,x),l.call(E+"_mul",b,f,y),l.call(E+"_mul",y,o,F),l.call(e+"__frobeniusMap1",x,B),l.call(E+"_mul",B,F,v),l.call(e+"__frobeniusMap2",b,q),l.call(E+"_mul",q,v,A),l.call(E+"_conjugate",o,I),l.call(E+"_mul",I,x,O),l.call(e+"__frobeniusMap3",O,w),l.call(E+"_mul",w,A,n))}();let a=t.addFunction(e+"_finalExponentiation");a.addParam("x","i32"),a.addParam("r","i32");let l=a.getCodeBuilder(),n=l.getLocal("x"),d=l.getLocal("r"),r=l.i32_const(t.alloc(c));a.addCode(l.call(e+"__finalExponentiationFirstChunk",n,r),l.call(e+"__finalExponentiationLastChunk",r,d))}();for(let a=1;a<=5;a++)!function(a){let l=t.addFunction(e+"_pairingEq"+a);for(let t=0;t<a;t++)l.addParam("p_"+t,"i32"),l.addParam("q_"+t,"i32");l.addParam("c","i32"),l.setReturnType("i32");let o=l.getCodeBuilder(),i=o.i32_const(t.alloc(c)),n=o.i32_const(t.alloc(c));l.addCode(o.call(E+"_one",i));for(let t=0;t<a;t++)l.addCode(o.call(e+"_prepareG1",o.getLocal("p_"+t),o.i32_const(k))),l.addCode(o.call(e+"_prepareG2",o.getLocal("q_"+t),o.i32_const(G))),l.addCode(o.call(e+"_millerLoop",o.i32_const(k),o.i32_const(G),n)),l.addCode(o.call(E+"_mul",i,n,i));l.addCode(o.call(e+"_finalExponentiation",i,i)),l.addCode(o.call(E+"_eq",i,o.getLocal("c")))}(a),t.exportFunction(e+"_pairingEq"+a);!function(){let a=t.addFunction(e+"_pairing");a.addParam("p","i32"),a.addParam("q","i32"),a.addParam("r","i32");let l=a.getCodeBuilder(),o=l.i32_const(t.alloc(c));a.addCode(l.call(e+"_prepareG1",l.getLocal("p"),l.i32_const(k))),a.addCode(l.call(e+"_prepareG2",l.getLocal("q"),l.i32_const(G))),a.addCode(l.call(e+"_millerLoop",l.i32_const(k),l.i32_const(G),o)),a.addCode(l.call(e+"_finalExponentiation",o,l.getLocal("r")))}(),t.exportFunction(e+"_pairing"),t.exportFunction(e+"_prepareG1"),t.exportFunction(e+"_prepareG2"),t.exportFunction(e+"_millerLoop"),t.exportFunction(e+"_finalExponentiation"),t.exportFunction(e+"_finalExponentiationOld"),t.exportFunction(e+"__mulBy024"),t.exportFunction(e+"__mulBy024Old"),t.exportFunction(e+"__cyclotomicSquare"),t.exportFunction(e+"__cyclotomicExp_w0")},buildBls12381$1=function(t,a){let e=a||"bls12381";if(t.modules[e])return e;let l=Math.floor((P(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn-1n)-1)/64)+1,o=8*l,i=2*o,c=12*o,n=Math.floor((P(0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n-1n)-1)/64)+1,d=8*n,r=t.alloc(s.bigInt2BytesLE(0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,d)),_=build_f1m(t,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,"f1m","intq");build_f1(t,0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,"fr","frm","intr");let u=t.alloc(s.bigInt2BytesLE(toMontgomery(4n),o)),f=build_curve_jacobian_a0(t,"g1m","f1m",u);build_fft(t,"frm","frm","frm","frm_mul"),build_pol(t,"pol","frm"),build_qap(t,"qap","frm");let g=build_f2m(t,"f1m_neg","f2m","f1m"),p=t.alloc([...s.bigInt2BytesLE(toMontgomery(4n),o),...s.bigInt2BytesLE(toMontgomery(4n),o)]),L=build_curve_jacobian_a0(t,"g2m","f2m",p);function buildGTimesFr(a,e){let l=t.addFunction(a);l.addParam("pG","i32"),l.addParam("pFr","i32"),l.addParam("pr","i32");let o=l.getCodeBuilder(),i=o.i32_const(t.alloc(d));l.addCode(o.call("frm_fromMontgomery",o.getLocal("pFr"),i),o.call(e,o.getLocal("pG"),i,o.i32_const(d),o.getLocal("pr"))),t.exportFunction(a)}function toMontgomery(t){return BigInt(t)*(1n<<BigInt(8*o))%0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn}buildGTimesFr("g1m_timesFr","g1m_timesScalar"),build_fft(t,"g1m","g1m","frm","g1m_timesFr"),buildGTimesFr("g2m_timesFr","g2m_timesScalar"),build_fft(t,"g2m","g2m","frm","g2m_timesFr"),buildGTimesFr("g1m_timesFrAffine","g1m_timesScalarAffine"),buildGTimesFr("g2m_timesFrAffine","g2m_timesScalarAffine"),build_applykey(t,"frm_batchApplyKey","fmr","frm",d,d,d,"frm_mul"),build_applykey(t,"g1m_batchApplyKey","g1m","frm",3*o,3*o,d,"g1m_timesFr"),build_applykey(t,"g1m_batchApplyKeyMixed","g1m","frm",2*o,3*o,d,"g1m_timesFrAffine"),build_applykey(t,"g2m_batchApplyKey","g2m","frm",6*o,6*o,d,"g2m_timesFr"),build_applykey(t,"g2m_batchApplyKeyMixed","g2m","frm",4*o,6*o,d,"g2m_timesFrAffine");let m=t.alloc([...s.bigInt2BytesLE(toMontgomery(0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bbn),o),...s.bigInt2BytesLE(toMontgomery(0x8b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1n),o),...s.bigInt2BytesLE(toMontgomery(1n),o)]),h=t.alloc([...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(1n),o),...s.bigInt2BytesLE(toMontgomery(0n),o)]),b=[[0x24aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8n,0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7en],[0xce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801n,0x606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79ben],[1n,0n]],x=t.alloc([...s.bigInt2BytesLE(toMontgomery(b[0][0]),o),...s.bigInt2BytesLE(toMontgomery(b[0][1]),o),...s.bigInt2BytesLE(toMontgomery(b[1][0]),o),...s.bigInt2BytesLE(toMontgomery(b[1][1]),o),...s.bigInt2BytesLE(toMontgomery(b[2][0]),o),...s.bigInt2BytesLE(toMontgomery(b[2][1]),o)]),y=[[0n,0n],[1n,0n],[0n,0n]],F=t.alloc([...s.bigInt2BytesLE(toMontgomery(y[0][0]),o),...s.bigInt2BytesLE(toMontgomery(y[0][1]),o),...s.bigInt2BytesLE(toMontgomery(y[1][0]),o),...s.bigInt2BytesLE(toMontgomery(y[1][1]),o),...s.bigInt2BytesLE(toMontgomery(y[2][0]),o),...s.bigInt2BytesLE(toMontgomery(y[2][1]),o)]),B=t.alloc([...s.bigInt2BytesLE(toMontgomery(1n),o),...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(0n),o),...s.bigInt2BytesLE(toMontgomery(0n),o)]),C=t.alloc([...s.bigInt2BytesLE(toMontgomery(1n),o),...s.bigInt2BytesLE(toMontgomery(1n),o)]);!function(){let a=t.addFunction(g+"_mulNR");a.addParam("x","i32"),a.addParam("pr","i32");let e=a.getCodeBuilder(),l=e.i32_const(t.alloc(o)),i=e.getLocal("x"),c=e.i32_add(e.getLocal("x"),e.i32_const(o)),n=e.getLocal("pr"),d=e.i32_add(e.getLocal("pr"),e.i32_const(o));a.addCode(e.call(_+"_copy",i,l),e.call(_+"_sub",i,c,n),e.call(_+"_add",l,c,d))}();let v=build_f3m(t,g+"_mulNR","f6m","f2m");!function(){let a=t.addFunction(v+"_mulNR");a.addParam("x","i32"),a.addParam("pr","i32");let e=a.getCodeBuilder(),l=e.i32_const(t.alloc(2*o));a.addCode(e.call(g+"_copy",e.getLocal("x"),l),e.call(g+"_mulNR",e.i32_add(e.getLocal("x"),e.i32_const(4*o)),e.getLocal("pr")),e.call(g+"_copy",e.i32_add(e.getLocal("x"),e.i32_const(2*o)),e.i32_add(e.getLocal("pr"),e.i32_const(4*o))),e.call(g+"_copy",l,e.i32_add(e.getLocal("pr"),e.i32_const(2*o))))}();let I=build_f2m(t,v+"_mulNR","ftm",v),E=function(t){let a=0xd201000000010000n,e=[];for(;a>0n;)q(a)?e.push(1):e.push(0),a>>=1n;return e}(0),O=t.alloc(E),w=3*i,M=E.length-1,S=E.reduce((t,a)=>t+(0!=a?1:0),0),T=6*o,z=3*o*2+(S+M+1)*w;t.modules[e]={n64q:l,n64r:n,n8q:o,n8r:d,pG1gen:m,pG1zero:h,pG1b:u,pG2gen:x,pG2zero:F,pG2b:p,pq:t.modules.f1m.pq,pr:r,pOneT:B,r:0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,q:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,prePSize:T,preQSize:z},function(){let a=t.addFunction(v+"_mul1");a.addParam("pA","i32"),a.addParam("pC1","i32"),a.addParam("pR","i32");let e=a.getCodeBuilder(),l=e.getLocal("pA"),i=e.i32_add(e.getLocal("pA"),e.i32_const(2*o)),c=e.i32_add(e.getLocal("pA"),e.i32_const(4*o)),n=e.getLocal("pC1"),d=e.getLocal("pR"),r=e.i32_add(e.getLocal("pR"),e.i32_const(2*o)),s=e.i32_add(e.getLocal("pR"),e.i32_const(4*o)),_=e.i32_const(t.alloc(2*o)),u=e.i32_const(t.alloc(2*o));a.addCode(e.call(g+"_add",l,i,_),e.call(g+"_add",i,c,u),e.call(g+"_mul",i,n,s),e.call(g+"_mul",u,n,d),e.call(g+"_sub",d,s,d),e.call(g+"_mulNR",d,d),e.call(g+"_mul",_,n,r),e.call(g+"_sub",r,s,r))}(),function(){let a=t.addFunction(v+"_mul01");a.addParam("pA","i32"),a.addParam("pC0","i32"),a.addParam("pC1","i32"),a.addParam("pR","i32");let e=a.getCodeBuilder(),l=e.getLocal("pA"),i=e.i32_add(e.getLocal("pA"),e.i32_const(2*o)),c=e.i32_add(e.getLocal("pA"),e.i32_const(4*o)),n=e.getLocal("pC0"),d=e.getLocal("pC1"),r=e.getLocal("pR"),s=e.i32_add(e.getLocal("pR"),e.i32_const(2*o)),_=e.i32_add(e.getLocal("pR"),e.i32_const(4*o)),u=e.i32_const(t.alloc(2*o)),f=e.i32_const(t.alloc(2*o)),p=e.i32_const(t.alloc(2*o)),L=e.i32_const(t.alloc(2*o));a.addCode(e.call(g+"_mul",l,n,u),e.call(g+"_mul",i,d,f),e.call(g+"_add",l,i,p),e.call(g+"_add",l,c,L),e.call(g+"_add",i,c,r),e.call(g+"_mul",r,d,r),e.call(g+"_sub",r,f,r),e.call(g+"_mulNR",r,r),e.call(g+"_add",r,u,r),e.call(g+"_add",n,d,s),e.call(g+"_mul",s,p,s),e.call(g+"_sub",s,u,s),e.call(g+"_sub",s,f,s),e.call(g+"_mul",L,n,_),e.call(g+"_sub",_,u,_),e.call(g+"_add",_,f,_))}(),function(){let a=t.addFunction(I+"_mul014");a.addParam("pA","i32"),a.addParam("pC0","i32"),a.addParam("pC1","i32"),a.addParam("pC4","i32"),a.addParam("pR","i32");let e=a.getCodeBuilder(),l=e.getLocal("pA"),i=e.i32_add(e.getLocal("pA"),e.i32_const(6*o)),c=e.getLocal("pC0"),n=e.getLocal("pC1"),d=e.getLocal("pC4"),r=e.i32_const(t.alloc(6*o)),s=e.i32_const(t.alloc(6*o)),_=e.i32_const(t.alloc(2*o)),u=e.getLocal("pR"),f=e.i32_add(e.getLocal("pR"),e.i32_const(6*o));a.addCode(e.call(v+"_mul01",l,c,n,r),e.call(v+"_mul1",i,d,s),e.call(g+"_add",n,d,_),e.call(v+"_add",i,l,f),e.call(v+"_mul01",f,c,_,f),e.call(v+"_sub",f,r,f),e.call(v+"_sub",f,s,f),e.call(v+"_copy",s,u),e.call(v+"_mulNR",u,u),e.call(v+"_add",u,r,u))}(),function(){let a=t.addFunction(e+"_ell");a.addParam("pP","i32"),a.addParam("pCoefs","i32"),a.addParam("pF","i32");let l=a.getCodeBuilder(),i=l.getLocal("pP"),c=l.i32_add(l.getLocal("pP"),l.i32_const(o)),n=l.getLocal("pF"),d=l.getLocal("pCoefs"),r=l.i32_add(l.getLocal("pCoefs"),l.i32_const(o)),s=l.i32_add(l.getLocal("pCoefs"),l.i32_const(2*o)),u=l.i32_add(l.getLocal("pCoefs"),l.i32_const(3*o)),f=l.i32_add(l.getLocal("pCoefs"),l.i32_const(4*o)),g=t.alloc(2*o),p=l.i32_const(g),L=l.i32_const(g),m=l.i32_const(g+o),h=t.alloc(2*o),b=l.i32_const(h),x=l.i32_const(h),y=l.i32_const(h+o);a.addCode(l.call(_+"_mul",d,c,L),l.call(_+"_mul",r,c,m),l.call(_+"_mul",s,i,x),l.call(_+"_mul",u,i,y),l.call(I+"_mul014",n,f,b,p,n))}();let R=t.alloc(T),k=t.alloc(z);for(let a=0;a<10;a++)!function(a){let e=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n,0xfc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0n],[0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n,0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0n],[0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n,0x5b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0n],[0xfc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n,0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0n],[0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0n],[0x5b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n,0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n]]],l=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0n],[0n,1n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0n],[0n,0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen]],[[1n,0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0n],[0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0n],[0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0n],[0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0n]]],c=t.addFunction(I+"_frobeniusMap"+a);c.addParam("x","i32"),c.addParam("r","i32");let n=c.getCodeBuilder();for(let d=0;d<6;d++){let r=0==d?n.getLocal("x"):n.i32_add(n.getLocal("x"),n.i32_const(d*i)),u=n.i32_add(n.getLocal("x"),n.i32_const(d*i+o)),f=0==d?n.getLocal("r"):n.i32_add(n.getLocal("r"),n.i32_const(d*i)),p=n.i32_add(n.getLocal("r"),n.i32_const(d*i+o)),L=function(t,a){let e=t[0],l=t[1],o=a[0],i=a[1],c=[(e*o-l*i)%0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,(e*i+l*o)%0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn];return A(c[0])&&(c[0]=c[0]+0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn),c}(e[Math.floor(d/3)][a%12],l[d%3][a%6]),m=t.alloc([...s.bigInt2BytesLE(toMontgomery(L[0]),o),...s.bigInt2BytesLE(toMontgomery(L[1]),o)]);a%2==1?c.addCode(n.call(_+"_copy",r,f),n.call(_+"_neg",u,p),n.call(g+"_mul",f,n.i32_const(m),f)):c.addCode(n.call(g+"_mul",r,n.i32_const(m),f))}}(a),t.exportFunction(I+"_frobeniusMap"+a);!function(){let a=t.addFunction(f+"_inGroupAffine");a.addParam("p","i32"),a.setReturnType("i32");let e=a.getCodeBuilder(),l=e.i32_const(t.alloc(s.bigInt2BytesLE(toMontgomery(0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn),o))),i=e.i32_const(t.alloc(s.bigInt2BytesLE(toMontgomery(0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen),o))),c=e.i32_const(t.alloc(s.bigInt2BytesLE((0xd201000000010000n*0xd201000000010000n-1n)/3n,16))),n=e.getLocal("p"),d=e.i32_add(e.getLocal("p"),e.i32_const(o)),r=t.alloc(3*o),u=e.i32_const(r),g=e.i32_const(r),p=e.i32_const(r+o),L=t.alloc(2*o),m=e.i32_const(L),h=e.i32_const(L),b=e.i32_const(L+o);a.addCode(e.if(e.call(f+"_isZeroAffine",e.getLocal("p")),e.ret(e.i32_const(1))),e.if(e.i32_eqz(e.call(f+"_inCurveAffine",e.getLocal("p"))),e.ret(e.i32_const(0))),e.call(_+"_mul",n,l,g),e.call(_+"_copy",d,p),e.call(_+"_mul",n,i,h),e.call(_+"_copy",d,b),e.call(f+"_doubleAffine",u,u),e.call(f+"_subMixed",u,e.getLocal("p"),u),e.call(f+"_subMixed",u,m,u),e.call(f+"_timesScalar",u,c,e.i32_const(16),u),e.ret(e.call(f+"_eqMixed",u,m)));let x=t.addFunction(f+"_inGroup");x.addParam("pIn","i32"),x.setReturnType("i32");let y=x.getCodeBuilder(),F=y.i32_const(t.alloc(2*o));x.addCode(y.call(f+"_toAffine",y.getLocal("pIn"),F),y.ret(y.call(f+"_inGroupAffine",F)))}(),function(){let a=t.addFunction(L+"_inGroupAffine");a.addParam("p","i32"),a.setReturnType("i32");let e=a.getCodeBuilder(),l=e.i32_const(t.alloc([...s.bigInt2BytesLE(toMontgomery(0xd0088f51cbff34d258dd3db21a5d66bb23ba5c279c2895fb39869507b587b120f55ffff58a9ffffdcff7fffffffd556n),o),...s.bigInt2BytesLE(toMontgomery(0xd0088f51cbff34d258dd3db21a5d66bb23ba5c279c2895fb39869507b587b120f55ffff58a9ffffdcff7fffffffd555n),o)])),c=e.i32_const(t.alloc(s.bigInt2BytesLE(toMontgomery(0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn),o))),n=e.i32_const(t.alloc([...s.bigInt2BytesLE(toMontgomery(0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n),o),...s.bigInt2BytesLE(toMontgomery(0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n),o)])),d=e.i32_const(t.alloc(s.bigInt2BytesLE(0xd201000000010000n,8))),r=e.getLocal("p"),u=e.i32_add(e.getLocal("p"),e.i32_const(i)),f=e.i32_const(t.alloc(o)),p=e.i32_const(t.alloc(i)),m=e.i32_const(t.alloc(i)),h=t.alloc(2*i),b=e.i32_const(h),x=e.i32_const(h),y=e.i32_const(h),F=e.i32_const(h+o),B=e.i32_const(h+i),C=e.i32_const(h+i),v=e.i32_const(h+i+o),P=t.alloc(3*i),q=e.i32_const(P),A=e.i32_const(P),I=e.i32_const(P),E=e.i32_const(P+o),O=e.i32_const(P+i),w=e.i32_const(P+i),M=e.i32_const(P+i+o),S=e.i32_const(P+2*i);a.addCode(e.if(e.call(L+"_isZeroAffine",e.getLocal("p")),e.ret(e.i32_const(1))),e.if(e.i32_eqz(e.call(L+"_inCurveAffine",e.getLocal("p"))),e.ret(e.i32_const(0))),e.call(g+"_mul",r,l,p),e.call(g+"_mul",u,l,m),e.call(g+"_mul1",p,c,x),e.call(g+"_neg",m,B),e.call(g+"_neg",p,A),e.call(g+"_mul",m,n,O),e.call(_+"_sub",y,F,f),e.call(_+"_add",y,F,F),e.call(_+"_copy",f,y),e.call(_+"_sub",C,v,f),e.call(_+"_add",C,v,v),e.call(_+"_copy",f,C),e.call(_+"_add",I,E,f),e.call(_+"_sub",I,E,E),e.call(_+"_copy",f,I),e.call(_+"_sub",M,w,f),e.call(_+"_add",w,M,M),e.call(_+"_copy",f,w),e.call(g+"_one",S),e.call(L+"_timesScalar",q,d,e.i32_const(8),q),e.call(L+"_addMixed",q,b,q),e.ret(e.call(L+"_eqMixed",q,e.getLocal("p"))));let T=t.addFunction(L+"_inGroup");T.addParam("pIn","i32"),T.setReturnType("i32");let z=T.getCodeBuilder(),R=z.i32_const(t.alloc(2*i));T.addCode(z.call(L+"_toAffine",z.getLocal("pIn"),R),z.ret(z.call(L+"_inGroupAffine",R)))}(),function(){let a=t.addFunction(e+"_prepAddStep");a.addParam("R","i32"),a.addParam("Q","i32"),a.addParam("r","i32");let l=a.getCodeBuilder(),c=l.getLocal("R"),n=l.i32_add(l.getLocal("R"),l.i32_const(2*o)),d=l.i32_add(l.getLocal("R"),l.i32_const(4*o)),r=l.getLocal("Q"),s=l.i32_add(l.getLocal("Q"),l.i32_const(2*o)),_=l.getLocal("r"),u=l.i32_add(l.getLocal("r"),l.i32_const(2*o)),f=l.i32_add(l.getLocal("r"),l.i32_const(4*o)),p=l.i32_const(t.alloc(i)),L=l.i32_const(t.alloc(i)),m=l.i32_const(t.alloc(i)),h=l.i32_const(t.alloc(i)),b=l.i32_const(t.alloc(i)),x=l.i32_const(t.alloc(i)),y=l.i32_const(t.alloc(i)),F=l.i32_const(t.alloc(i)),B=l.i32_const(t.alloc(i)),C=l.i32_const(t.alloc(i)),v=l.i32_const(t.alloc(i));a.addCode(l.call(g+"_square",d,p),l.call(g+"_square",s,L),l.call(g+"_mul",p,r,h),l.call(g+"_add",s,d,u),l.call(g+"_square",u,u),l.call(g+"_sub",u,L,u),l.call(g+"_sub",u,p,u),l.call(g+"_mul",u,p,u),l.call(g+"_sub",h,c,b),l.call(g+"_square",b,x),l.call(g+"_add",x,x,y),l.call(g+"_add",y,y,y),l.call(g+"_mul",y,b,F),l.call(g+"_sub",u,n,B),l.call(g+"_sub",B,n,B),l.call(g+"_mul",B,r,f),l.call(g+"_mul",y,c,C),l.call(g+"_square",B,c),l.call(g+"_sub",c,F,c),l.call(g+"_sub",c,C,c),l.call(g+"_sub",c,C,c),l.call(g+"_add",d,b,d),l.call(g+"_square",d,d),l.call(g+"_sub",d,p,d),l.call(g+"_sub",d,x,d),l.call(g+"_add",s,d,_),l.call(g+"_sub",C,c,v),l.call(g+"_mul",v,B,v),l.call(g+"_mul",n,F,h),l.call(g+"_add",h,h,h),l.call(g+"_sub",v,h,n),l.call(g+"_square",_,_),l.call(g+"_sub",_,L,_),l.call(g+"_square",d,m),l.call(g+"_sub",_,m,_),l.call(g+"_add",f,f,f),l.call(g+"_sub",f,_,f),l.call(g+"_add",d,d,_),l.call(g+"_neg",B,B),l.call(g+"_add",B,B,u))}(),function(){let a=t.addFunction(e+"_prepDblStep");a.addParam("R","i32"),a.addParam("r","i32");let l=a.getCodeBuilder(),c=l.getLocal("R"),n=l.i32_add(l.getLocal("R"),l.i32_const(2*o)),d=l.i32_add(l.getLocal("R"),l.i32_const(4*o)),r=l.getLocal("r"),s=l.i32_add(l.getLocal("r"),l.i32_const(2*o)),_=l.i32_add(l.getLocal("r"),l.i32_const(4*o)),u=l.i32_const(t.alloc(i)),f=l.i32_const(t.alloc(i)),p=l.i32_const(t.alloc(i)),L=l.i32_const(t.alloc(i)),m=l.i32_const(t.alloc(i));a.addCode(l.call(g+"_square",c,r),l.call(g+"_square",n,f),l.call(g+"_square",f,p),l.call(g+"_add",f,c,s),l.call(g+"_square",s,s),l.call(g+"_sub",s,r,s),l.call(g+"_sub",s,p,s),l.call(g+"_add",s,s,s),l.call(g+"_add",r,r,L),l.call(g+"_add",L,r,L),l.call(g+"_add",c,L,_),l.call(g+"_square",L,m),l.call(g+"_square",d,u),l.call(g+"_sub",m,s,c),l.call(g+"_sub",c,s,c),l.call(g+"_add",d,n,d),l.call(g+"_square",d,d),l.call(g+"_sub",d,f,d),l.call(g+"_sub",d,u,d),l.call(g+"_sub",s,c,n),l.call(g+"_mul",n,L,n),l.call(g+"_add",p,p,p),l.call(g+"_add",p,p,p),l.call(g+"_add",p,p,p),l.call(g+"_sub",n,p,n),l.call(g+"_mul",L,u,s),l.call(g+"_add",s,s,s),l.call(g+"_neg",s,s),l.call(g+"_square",_,_),l.call(g+"_sub",_,r,_),l.call(g+"_sub",_,m,_),l.call(g+"_add",f,f,f),l.call(g+"_add",f,f,f),l.call(g+"_sub",_,f,_),l.call(g+"_mul",d,u,r),l.call(g+"_add",r,r,r))}(),function(){let a=t.addFunction(e+"_prepareG1");a.addParam("pP","i32"),a.addParam("ppreP","i32");let l=a.getCodeBuilder();a.addCode(l.call(f+"_normalize",l.getLocal("pP"),l.getLocal("ppreP")))}(),function(){let a=t.addFunction(e+"_prepareG2");a.addParam("pQ","i32"),a.addParam("ppreQ","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");let l=a.getCodeBuilder(),o=l.getLocal("pQ"),c=t.alloc(3*i),n=l.i32_const(c),d=l.getLocal("ppreQ");a.addCode(l.call(L+"_normalize",o,d),l.if(l.call(L+"_isZero",d),l.ret([])),l.call(L+"_copy",d,n),l.setLocal("pCoef",l.i32_add(l.getLocal("ppreQ"),l.i32_const(3*i)))),a.addCode(l.setLocal("i",l.i32_const(E.length-2)),l.block(l.loop(l.call(e+"_prepDblStep",n,l.getLocal("pCoef")),l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(w))),l.if(l.i32_load8_s(l.getLocal("i"),O),[...l.call(e+"_prepAddStep",n,d,l.getLocal("pCoef")),...l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(w)))]),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.br(0))))}(),function(){let a=t.addFunction(e+"_millerLoop");a.addParam("ppreP","i32"),a.addParam("ppreQ","i32"),a.addParam("r","i32"),a.addLocal("pCoef","i32"),a.addLocal("i","i32");let l=a.getCodeBuilder(),o=l.getLocal("ppreP"),c=l.getLocal("pCoef"),n=l.getLocal("r");a.addCode(l.call(I+"_one",n),l.if(l.call(f+"_isZero",o),l.ret([])),l.if(l.call(f+"_isZero",l.getLocal("ppreQ")),l.ret([])),l.setLocal("pCoef",l.i32_add(l.getLocal("ppreQ"),l.i32_const(3*i))),l.setLocal("i",l.i32_const(E.length-2)),l.block(l.loop(l.call(e+"_ell",o,c,n),l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(w))),l.if(l.i32_load8_s(l.getLocal("i"),O),[...l.call(e+"_ell",o,c,n),...l.setLocal("pCoef",l.i32_add(l.getLocal("pCoef"),l.i32_const(w)))]),l.call(I+"_square",n,n),l.br_if(1,l.i32_eq(l.getLocal("i"),l.i32_const(1))),l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.br(0))),l.call(e+"_ell",o,c,n)),a.addCode(l.call(I+"_conjugate",n,n))}(),function(){let a=t.addFunction(e+"_finalExponentiationOld");a.addParam("x","i32"),a.addParam("r","i32");let l=t.alloc(s.bigInt2BytesLE(0x2ee1db5dcc825b7e1bda9c0496a1c0a89ee0193d4977b3f7d4507d07363baa13f8d14a917848517badc3a43d1073776ab353f2c30698e8cc7deada9c0aadff5e9cfee9a074e43b9a660835cc872ee83ff3a0f0f1c0ad0d6106feaf4e347aa68ad49466fa927e7bb9375331807a0dce2630d9aa4b113f414386b0e8819328148978e2b0dd39099b86e1ab656d2670d93e4d7acdd350da5359bc73ab61a0c5bf24c374693c49f570bcd2b01f3077ffb10bf24dde41064837f27611212596bc293c8d4c01f25118790f4684d0b9c40a68eb74bb22a40ee7169cdc1041296532fef459f12438dfc8e2886ef965e61a474c5c85b0129127a1b5ad0463434724538411d1676a53b5a62eb34c05739334f46c02c3f0bd0c55d3109cd15948d0a1fad20044ce6ad4c6bec3ec03ef19592004cedd556952c6d8823b19dadd7c2498345c6e5308f1c511291097db60b1749bf9b71a9f9e0100418a3ef0bc627751bbd81367066bca6a4c1b6dcfc5cceb73fc56947a403577dfa9e13c24ea820b09c1d9f7c31759c3635de3f7a3639991708e88adce88177456c49637fd7961be1a4c7e79fb02faa732e2f3ec2bea83d196283313492caa9d4aff1c910e9622d2a73f62537f2701aaef6539314043f7bbce5b78c7869aeb2181a67e49eeed2161daf3f881bd88592d767f67c4717489119226c2f011d4cab803e9d71650a6f80698e2f8491d12191a04406fbc8fbd5f48925f98630e68bfb24c0bcb9b55df57510n,544)),o=a.getCodeBuilder();a.addCode(o.call(I+"_exp",o.getLocal("x"),o.i32_const(l),o.i32_const(544),o.getLocal("r")))}(),function(){(function(){let a=t.addFunction(e+"__cyclotomicSquare");a.addParam("x","i32"),a.addParam("r","i32");let l=a.getCodeBuilder(),o=l.getLocal("x"),c=l.i32_add(l.getLocal("x"),l.i32_const(i)),n=l.i32_add(l.getLocal("x"),l.i32_const(2*i)),d=l.i32_add(l.getLocal("x"),l.i32_const(3*i)),r=l.i32_add(l.getLocal("x"),l.i32_const(4*i)),s=l.i32_add(l.getLocal("x"),l.i32_const(5*i)),_=l.getLocal("r"),u=l.i32_add(l.getLocal("r"),l.i32_const(i)),f=l.i32_add(l.getLocal("r"),l.i32_const(2*i)),p=l.i32_add(l.getLocal("r"),l.i32_const(3*i)),L=l.i32_add(l.getLocal("r"),l.i32_const(4*i)),m=l.i32_add(l.getLocal("r"),l.i32_const(5*i)),h=l.i32_const(t.alloc(i)),b=l.i32_const(t.alloc(i)),x=l.i32_const(t.alloc(i)),y=l.i32_const(t.alloc(i)),F=l.i32_const(t.alloc(i)),B=l.i32_const(t.alloc(i)),v=l.i32_const(t.alloc(i)),P=l.i32_const(t.alloc(i));a.addCode(l.call(g+"_mul",o,r,v),l.call(g+"_mulNR",r,h),l.call(g+"_add",o,h,h),l.call(g+"_add",o,r,P),l.call(g+"_mul",P,h,h),l.call(g+"_mulNR",v,P),l.call(g+"_add",v,P,P),l.call(g+"_sub",h,P,h),l.call(g+"_add",v,v,b),l.call(g+"_mul",d,n,v),l.call(g+"_mulNR",n,x),l.call(g+"_add",d,x,x),l.call(g+"_add",d,n,P),l.call(g+"_mul",P,x,x),l.call(g+"_mulNR",v,P),l.call(g+"_add",v,P,P),l.call(g+"_sub",x,P,x),l.call(g+"_add",v,v,y),l.call(g+"_mul",c,s,v),l.call(g+"_mulNR",s,F),l.call(g+"_add",c,F,F),l.call(g+"_add",c,s,P),l.call(g+"_mul",P,F,F),l.call(g+"_mulNR",v,P),l.call(g+"_add",v,P,P),l.call(g+"_sub",F,P,F),l.call(g+"_add",v,v,B),l.call(g+"_sub",h,o,_),l.call(g+"_add",_,_,_),l.call(g+"_add",h,_,_),l.call(g+"_add",b,r,L),l.call(g+"_add",L,L,L),l.call(g+"_add",b,L,L),l.call(g+"_mul",B,l.i32_const(C),P),l.call(g+"_add",P,d,p),l.call(g+"_add",p,p,p),l.call(g+"_add",P,p,p),l.call(g+"_sub",F,n,f),l.call(g+"_add",f,f,f),l.call(g+"_add",F,f,f),l.call(g+"_sub",x,c,u),l.call(g+"_add",u,u,u),l.call(g+"_add",x,u,u),l.call(g+"_add",y,s,m),l.call(g+"_add",m,m,m),l.call(g+"_add",y,m,m))})(),function(a,l,o){let i=(function(t){let a=0xd201000000010000n,e=[];for(;a>0n;){if(q(a)){let t=2-Number(a%4n);e.push(t),a-=BigInt(t)}else e.push(0);a>>=1n}return e})(0).map(t=>-1==t?255:t),n=t.alloc(i),d=t.addFunction(e+"__cyclotomicExp_w0");d.addParam("x","i32"),d.addParam("r","i32"),d.addLocal("bit","i32"),d.addLocal("i","i32");let r=d.getCodeBuilder(),s=r.getLocal("x"),_=r.getLocal("r"),u=r.i32_const(t.alloc(c));d.addCode(r.call(I+"_conjugate",s,u),r.call(I+"_one",_),r.if(r.teeLocal("bit",r.i32_load8_s(r.i32_const(i.length-1),n)),r.if(r.i32_eq(r.getLocal("bit"),r.i32_const(1)),r.call(I+"_mul",_,s,_),r.call(I+"_mul",_,u,_))),r.setLocal("i",r.i32_const(i.length-2)),r.block(r.loop(r.call(e+"__cyclotomicSquare",_,_),r.if(r.teeLocal("bit",r.i32_load8_s(r.getLocal("i"),n)),r.if(r.i32_eq(r.getLocal("bit"),r.i32_const(1)),r.call(I+"_mul",_,s,_),r.call(I+"_mul",_,u,_))),r.br_if(1,r.i32_eqz(r.getLocal("i"))),r.setLocal("i",r.i32_sub(r.getLocal("i"),r.i32_const(1))),r.br(0)))),l&&d.addCode(r.call(I+"_conjugate",_,_))}(0,!0,0);let a=t.addFunction(e+"_finalExponentiation");a.addParam("x","i32"),a.addParam("r","i32");let l=a.getCodeBuilder(),o=l.getLocal("x"),n=l.getLocal("r"),d=l.i32_const(t.alloc(c)),r=l.i32_const(t.alloc(c)),s=l.i32_const(t.alloc(c)),_=l.i32_const(t.alloc(c)),u=l.i32_const(t.alloc(c)),f=l.i32_const(t.alloc(c)),p=l.i32_const(t.alloc(c));a.addCode(l.call(I+"_frobeniusMap6",o,d),l.call(I+"_inverse",o,r),l.call(I+"_mul",d,r,s),l.call(I+"_copy",s,r),l.call(I+"_frobeniusMap2",s,s),l.call(I+"_mul",s,r,s),l.call(e+"__cyclotomicSquare",s,r),l.call(I+"_conjugate",r,r),l.call(e+"__cyclotomicExp_w0",s,_),l.call(e+"__cyclotomicSquare",_,u),l.call(I+"_mul",r,_,f),l.call(e+"__cyclotomicExp_w0",f,r),l.call(e+"__cyclotomicExp_w0",r,d),l.call(e+"__cyclotomicExp_w0",d,p),l.call(I+"_mul",p,u,p),l.call(e+"__cyclotomicExp_w0",p,u),l.call(I+"_conjugate",f,f),l.call(I+"_mul",u,f,u),l.call(I+"_mul",u,s,u),l.call(I+"_conjugate",s,f),l.call(I+"_mul",r,s,r),l.call(I+"_frobeniusMap3",r,r),l.call(I+"_mul",p,f,p),l.call(I+"_frobeniusMap1",p,p),l.call(I+"_mul",_,d,_),l.call(I+"_frobeniusMap2",_,_),l.call(I+"_mul",_,r,_),l.call(I+"_mul",_,p,_),l.call(I+"_mul",_,u,n))}();for(let a=1;a<=5;a++)!function(a){let l=t.addFunction(e+"_pairingEq"+a);for(let t=0;t<a;t++)l.addParam("p_"+t,"i32"),l.addParam("q_"+t,"i32");l.addParam("c","i32"),l.setReturnType("i32");let o=l.getCodeBuilder(),i=o.i32_const(t.alloc(c)),n=o.i32_const(t.alloc(c));l.addCode(o.call(I+"_one",i));for(let t=0;t<a;t++)l.addCode(o.call(e+"_prepareG1",o.getLocal("p_"+t),o.i32_const(R))),l.addCode(o.call(e+"_prepareG2",o.getLocal("q_"+t),o.i32_const(k))),l.addCode(o.if(o.i32_eqz(o.call(f+"_inGroupAffine",o.i32_const(R))),o.ret(o.i32_const(0))),o.if(o.i32_eqz(o.call(L+"_inGroupAffine",o.i32_const(k))),o.ret(o.i32_const(0)))),l.addCode(o.call(e+"_millerLoop",o.i32_const(R),o.i32_const(k),n)),l.addCode(o.call(I+"_mul",i,n,i));l.addCode(o.call(e+"_finalExponentiation",i,i)),l.addCode(o.call(I+"_eq",i,o.getLocal("c")))}(a),t.exportFunction(e+"_pairingEq"+a);!function(){let a=t.addFunction(e+"_pairing");a.addParam("p","i32"),a.addParam("q","i32"),a.addParam("r","i32");let l=a.getCodeBuilder(),o=l.i32_const(t.alloc(c));a.addCode(l.call(e+"_prepareG1",l.getLocal("p"),l.i32_const(R))),a.addCode(l.call(e+"_prepareG2",l.getLocal("q"),l.i32_const(k))),a.addCode(l.call(e+"_millerLoop",l.i32_const(R),l.i32_const(k),o)),a.addCode(l.call(e+"_finalExponentiation",o,l.getLocal("r")))}(),t.exportFunction(e+"_pairing"),t.exportFunction(e+"_prepareG1"),t.exportFunction(e+"_prepareG2"),t.exportFunction(e+"_millerLoop"),t.exportFunction(e+"_finalExponentiation"),t.exportFunction(e+"_finalExponentiationOld"),t.exportFunction(e+"__cyclotomicSquare"),t.exportFunction(e+"__cyclotomicExp_w0"),t.exportFunction(v+"_mul1"),t.exportFunction(v+"_mul01"),t.exportFunction(I+"_mul014"),t.exportFunction(f+"_inGroupAffine"),t.exportFunction(f+"_inGroup"),t.exportFunction(L+"_inGroupAffine"),t.exportFunction(L+"_inGroup")};function leInt2Buff(t,a){let e=t;void 0===a&&0==(a=Math.floor((bitLength$6(t)-1)/8)+1)&&(a=1);let l=new Uint8Array(a),o=new DataView(l.buffer),i=0;for(;i<a;)i+4<=a?(o.setUint32(i,Number(e&BigInt(4294967295)),!0),i+=4,e>>=BigInt(32)):i+2<=a?(o.setUint16(i,Number(e&BigInt(65535)),!0),i+=2,e>>=BigInt(16)):(o.setUint8(i,Number(e&BigInt(255)),!0),i+=1,e>>=BigInt(8));if(e)throw Error("Number does not fit in this length");return l}let I=[];for(let t=0;t<256;t++)I[t]=function(t,a){let e=0,l=t;for(let t=0;t<8;t++)e<<=1,e|=1&l,l>>=1;return e}(t,0);function bitReverse(t,a){return(I[t>>>24]|I[t>>>16&255]<<8|I[t>>>8&255]<<16|I[255&t]<<24)>>>32-a}function log2(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function buffReverseBits(t,a){let e=t.byteLength/a,l=log2(e);if(e!=1<<l)throw Error("Invalid number of pointers");for(let o=0;o<e;o++){let e=bitReverse(o,l);if(o>e){let l=t.slice(o*a,(o+1)*a);t.set(t.slice(e*a,(e+1)*a),o*a),t.set(l,e*a)}}}function array2buffer(t,a){let e=new Uint8Array(a*t.length);for(let l=0;l<t.length;l++)e.set(t[l],l*a);return e}function buffer2array(t,a){let e=t.byteLength/a,l=Array(e);for(let o=0;o<e;o++)l[o]=t.slice(o*a,o*a+a);return l}var E=Object.freeze({__proto__:null,array2buffer:array2buffer,beBuff2int:function(t){let a=BigInt(0),e=t.length,l=0,o=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;e>0;)e>=4?(e-=4,a+=BigInt(o.getUint32(e))<<BigInt(8*l),l+=4):e>=2?(e-=2,a+=BigInt(o.getUint16(e))<<BigInt(8*l),l+=2):(e-=1,a+=BigInt(o.getUint8(e))<<BigInt(8*l),l+=1);return a},beInt2Buff:function(t,a){let e=t,l=new Uint8Array(a),o=new DataView(l.buffer),i=a;for(;i>0;)i-4>=0?(i-=4,o.setUint32(i,Number(e&BigInt(4294967295))),e>>=BigInt(32)):i-2>=0?(i-=2,o.setUint16(i,Number(e&BigInt(65535))),e>>=BigInt(16)):(i-=1,o.setUint8(i,Number(e&BigInt(255))),e>>=BigInt(8));if(e)throw Error("Number does not fit in this length");return l},bitReverse:bitReverse,buffReverseBits:buffReverseBits,buffer2array:buffer2array,leBuff2int:function(t){let a=BigInt(0),e=0,l=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;e<t.length;)e+4<=t.length?(a+=BigInt(l.getUint32(e,!0))<<BigInt(8*e),e+=4):e+2<=t.length?(a+=BigInt(l.getUint16(e,!0))<<BigInt(8*e),e+=2):(a+=BigInt(l.getUint8(e,!0))<<BigInt(8*e),e+=1);return a},leInt2Buff:leInt2Buff,log2:log2,stringifyBigInts:function stringifyBigInts(t){if("bigint"==typeof t||void 0!==t.eq)return t.toString(10);if(t instanceof Uint8Array)return fromRprLE(t,0);if(Array.isArray(t))return t.map(stringifyBigInts);{if("object"!=typeof t)return t;let a={},e=Object.keys(t);return e.forEach(e=>{a[e]=stringifyBigInts(t[e])}),a}},stringifyFElements:function stringifyFElements(t,a){if("bigint"==typeof a||void 0!==a.eq)return a.toString(10);if(a instanceof Uint8Array)return t.toString(t.e(a));if(Array.isArray(a))return a.map(stringifyFElements.bind(this,t));{if("object"!=typeof a)return a;let e={},l=Object.keys(a);return l.forEach(l=>{e[l]=stringifyFElements(t,a[l])}),e}},unstringifyBigInts:function unstringifyBigInts(t){if("string"==typeof t&&/^[0-9]+$/.test(t)||"string"==typeof t&&/^0x[0-9a-fA-F]+$/.test(t))return BigInt(t);if(Array.isArray(t))return t.map(unstringifyBigInts);{if("object"!=typeof t)return t;if(null===t)return null;let a={},e=Object.keys(t);return e.forEach(e=>{a[e]=unstringifyBigInts(t[e])}),a}},unstringifyFElements:function unstringifyFElements(t,a){if("string"==typeof a&&/^[0-9]+$/.test(a)||"string"==typeof a&&/^0x[0-9a-fA-F]+$/.test(a))return t.e(a);if(Array.isArray(a))return a.map(unstringifyFElements.bind(this,t));{if("object"!=typeof a)return a;if(null===a)return null;let e={},l=Object.keys(a);return l.forEach(l=>{e[l]=unstringifyFElements(t,a[l])}),e}}});let BigBuffer=class BigBuffer{constructor(t){this.buffers=[],this.byteLength=t;for(let a=0;a<t;a+=1073741824){let e=Math.min(t-a,1073741824);this.buffers.push(new Uint8Array(e))}}slice(t,a){let e;void 0===a&&(a=this.byteLength),void 0===t&&(t=0);let l=a-t,o=Math.floor(t/1073741824),i=Math.floor((t+l-1)/1073741824);if(o==i||0==l)return this.buffers[o].slice(t%1073741824,t%1073741824+l);let c=o,n=t%1073741824,d=l;for(;d>0;){let t=n+d>1073741824?1073741824-n:d,a=new Uint8Array(this.buffers[c].buffer,this.buffers[c].byteOffset+n,t);if(t==l)return a.slice();e||(e=l<=1073741824?new Uint8Array(l):new BigBuffer(l)),e.set(a,l-d),d-=t,c++,n=0}return e}set(t,a){void 0===a&&(a=0);let e=t.byteLength;if(0==e)return;let l=Math.floor(a/1073741824),o=Math.floor((a+e-1)/1073741824);if(l==o)return t instanceof BigBuffer&&1==t.buffers.length?this.buffers[l].set(t.buffers[0],a%1073741824):this.buffers[l].set(t,a%1073741824);let i=l,c=a%1073741824,n=e;for(;n>0;){let a=c+n>1073741824?1073741824-c:n,l=t.slice(e-n,e-n+a),o=new Uint8Array(this.buffers[i].buffer,this.buffers[i].byteOffset+c,a);o.set(l),n-=a,i++,c=0}}};function buildBatchConvert(t,a,e,l){return async function(o){let i;let c=Math.floor(o.byteLength/e);if(c*e!==o.byteLength)throw Error("Invalid buffer size");let n=Math.floor(c/t.concurrency),d=[];for(let i=0;i<t.concurrency;i++){let r;if(0==(r=i<t.concurrency-1?n:c-i*n))continue;let s=o.slice(i*n*e,i*n*e+r*e),_=[{cmd:"ALLOCSET",var:0,buff:s},{cmd:"ALLOC",var:1,len:l*r},{cmd:"CALL",fnName:a,params:[{var:0},{val:r},{var:1}]},{cmd:"GET",out:0,var:1,len:l*r}];d.push(t.queueAction(_))}let r=await Promise.all(d);i=o instanceof BigBuffer?new BigBuffer(c*l):new Uint8Array(c*l);let s=0;for(let t=0;t<r.length;t++)i.set(r[t][0],s),s+=r[t][0].byteLength;return i}}let WasmField1=class WasmField1{constructor(t,a,e,l){if(this.tm=t,this.prefix=a,this.p=l,this.n8=e,this.type="F1",this.m=1,this.half=shiftRight(l,i),this.bitLength=bitLength$6(l),this.mask=sub(shiftLeft(i,this.bitLength),i),this.pOp1=t.alloc(e),this.pOp2=t.alloc(e),this.pOp3=t.alloc(e),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[a+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(e/8),this.n32=Math.floor(e/4),8*this.n64!=this.n8)throw Error("n8 must be a multiple of 8");this.half=shiftRight(this.p,i),this.nqr=this.two;let o=this.exp(this.nqr,this.half);for(;!this.eq(o,this.negone);)this.nqr=this.add(this.nqr,this.one),o=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let c=sub(this.p,i);for(;!isOdd$5(c);)this.s=this.s+1,c=shiftRight(c,i);this.w=[],this.w[this.s]=this.exp(this.nqr,c);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw Error("Error calculating roots of unity");this.batchToMontgomery=buildBatchConvert(t,a+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=buildBatchConvert(t,a+"_batchFromMontgomery",this.n8,this.n8)}op2(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,a){return this.op2("_add",t,a)}eq(t,a){return this.op2Bool("_eq",t,a)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,a){return this.op2("_sub",t,a)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,a){return this.op2("_mul",t,a)}div(t,a){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,a){return a instanceof Uint8Array||(a=toLEBuff(fromString(a))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,a){if(t instanceof Uint8Array)return t;let e=fromString(t,a);isNegative$4(e)?(gt(e=neg(e),this.p)&&(e=mod(e,this.p)),e=sub(this.p,e)):gt(e,this.p)&&(e=mod(e,this.p));let l=leInt2Buff(e,this.n8);return this.toMontgomery(l)}toString(t,a){let e=this.fromMontgomery(t),l=fromRprLE(e,0);return toString(l,a)}fromRng(t){let a;let e=new Uint8Array(this.n8);do{a=o;for(let e=0;e<this.n64;e++)a=add(a,shiftLeft(t.nextU64(),64*e));a=band(a,this.mask)}while(geq(a,this.p));return toRprLE(e,0,a,this.n8),e}random(){return this.fromRng(getThreadRng())}toObject(t){let a=this.fromMontgomery(t);return fromRprLE(a,0)}fromObject(t){let a=new Uint8Array(this.n8);return toRprLE(a,0,t,this.n8),this.toMontgomery(a)}toRprLE(t,a,e){t.set(this.fromMontgomery(e),a)}toRprBE(t,a,e){let l=this.fromMontgomery(e);for(let t=0;t<this.n8/2;t++){let a=l[t];l[t]=l[this.n8-1-t],l[this.n8-1-t]=a}t.set(l,a)}fromRprLE(t,a){a=a||0;let e=t.slice(a,a+this.n8);return this.toMontgomery(e)}async batchInverse(t){let a,e=!1,l=this.n8,o=this.n8;Array.isArray(t)?(t=array2buffer(t,l),e=!0):t=t.slice(0,t.byteLength);let i=Math.floor(t.byteLength/l);if(i*l!==t.byteLength)throw Error("Invalid buffer size");let c=Math.floor(i/this.tm.concurrency),n=[];for(let a=0;a<this.tm.concurrency;a++){let e;if(0==(e=a<this.tm.concurrency-1?c:i-a*c))continue;let d=t.slice(a*c*l,a*c*l+e*l),r=[{cmd:"ALLOCSET",var:0,buff:d},{cmd:"ALLOC",var:1,len:o*e},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:l},{val:e},{var:1},{val:o}]},{cmd:"GET",out:0,var:1,len:o*e}];n.push(this.tm.queueAction(r))}let d=await Promise.all(n);a=t instanceof BigBuffer?new BigBuffer(i*o):new Uint8Array(i*o);let r=0;for(let t=0;t<d.length;t++)a.set(d[t][0],r),r+=d[t][0].byteLength;return e?buffer2array(a,o):a}};let WasmField2=class WasmField2{constructor(t,a,e){this.tm=t,this.prefix=a,this.F=e,this.type="F2",this.m=2*e.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*e.n8),this.pOp2=t.alloc(2*e.n8),this.pOp3=t.alloc(2*e.n8),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[a+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,a){return this.op2("_add",t,a)}eq(t,a){return this.op2Bool("_eq",t,a)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,a){return this.op2("_sub",t,a)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,a){return this.op2("_mul",t,a)}mul1(t,a){return this.op2("_mul1",t,a)}div(t,a){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,a){return a instanceof Uint8Array||(a=toLEBuff(fromString(a))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,a){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){let e=this.F.e(t[0],a),l=this.F.e(t[1],a),o=new Uint8Array(2*this.F.n8);return o.set(e),o.set(l,2*this.F.n8),o}throw Error("invalid F2")}toString(t,a){let e=this.F.toString(t.slice(0,this.F.n8),a),l=this.F.toString(t.slice(this.F.n8),a);return`[${e}, ${l}]`}fromRng(t){let a=this.F.fromRng(t),e=this.F.fromRng(t),l=new Uint8Array(2*this.F.n8);return l.set(a),l.set(e,this.F.n8),l}random(){return this.fromRng(getThreadRng())}toObject(t){let a=this.F.toObject(t.slice(0,this.F.n8)),e=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));return[a,e]}fromObject(t){let a=new Uint8Array(2*this.F.n8),e=this.F.fromObject(t[0]),l=this.F.fromObject(t[1]);return a.set(e),a.set(l,this.F.n8),a}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}};let WasmField3=class WasmField3{constructor(t,a,e){this.tm=t,this.prefix=a,this.F=e,this.type="F3",this.m=3*e.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*e.n8),this.pOp2=t.alloc(3*e.n8),this.pOp3=t.alloc(3*e.n8),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[a+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,a){return this.op2Bool("_eq",t,a)}isZero(t){return this.op1Bool("_isZero",t)}add(t,a){return this.op2("_add",t,a)}sub(t,a){return this.op2("_sub",t,a)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,a){return this.op2("_mul",t,a)}div(t,a){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,a){return a instanceof Uint8Array||(a=toLEBuff(fromString(a))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,a){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){let e=this.F.e(t[0],a),l=this.F.e(t[1],a),o=this.F.e(t[2],a),i=new Uint8Array(3*this.F.n8);return i.set(e),i.set(l,this.F.n8),i.set(o,2*this.F.n8),i}throw Error("invalid F3")}toString(t,a){let e=this.F.toString(t.slice(0,this.F.n8),a),l=this.F.toString(t.slice(this.F.n8,2*this.F.n8),a),o=this.F.toString(t.slice(2*this.F.n8),a);return`[${e}, ${l}, ${o}]`}fromRng(t){let a=this.F.fromRng(t),e=this.F.fromRng(t),l=this.F.fromRng(t),o=new Uint8Array(3*this.F.n8);return o.set(a),o.set(e,this.F.n8),o.set(l,2*this.F.n8),o}random(){return this.fromRng(getThreadRng())}toObject(t){let a=this.F.toObject(t.slice(0,this.F.n8)),e=this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),l=this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8));return[a,e,l]}fromObject(t){let a=new Uint8Array(3*this.F.n8),e=this.F.fromObject(t[0]),l=this.F.fromObject(t[1]),o=this.F.fromObject(t[2]);return a.set(e),a.set(l,this.F.n8),a.set(o,2*this.F.n8),a}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}};let WasmCurve=class WasmCurve{constructor(t,a,e,l,o,i){this.tm=t,this.prefix=a,this.F=e,this.pOp1=t.alloc(3*e.n8),this.pOp2=t.alloc(3*e.n8),this.pOp3=t.alloc(3*e.n8),this.tm.instance.exports[a+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*e.n8),this.tm.instance.exports[a+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*e.n8),this.one=this.tm.getBuff(l,3*e.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(l,2*e.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(o,e.n8),i&&(this.cofactor=toLEBuff(i)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=buildBatchConvert(t,a+"_batchLEMtoC",2*e.n8,e.n8),this.batchLEMtoU=buildBatchConvert(t,a+"_batchLEMtoU",2*e.n8,2*e.n8),this.batchCtoLEM=buildBatchConvert(t,a+"_batchCtoLEM",e.n8,2*e.n8),this.batchUtoLEM=buildBatchConvert(t,a+"_batchUtoLEM",2*e.n8,2*e.n8),this.batchToJacobian=buildBatchConvert(t,a+"_batchToJacobian",2*e.n8,3*e.n8),this.batchToAffine=buildBatchConvert(t,a+"_batchToAffine",3*e.n8,2*e.n8)}op2(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,a,e){return this.tm.setBuff(this.pOp1,a),this.tm.setBuff(this.pOp2,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,a){return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,a){return this.tm.setBuff(this.pOp1,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,a){if(t.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_add",t,a);if(a.byteLength==2*this.F.n8)return this.op2("_addMixed",t,a);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_addMixed",a,t);if(a.byteLength==2*this.F.n8)return this.op2("_addAffine",t,a)}throw Error("invalid point size")}sub(t,a){if(t.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_sub",t,a);if(a.byteLength==2*this.F.n8)return this.op2("_subMixed",t,a);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2("_subMixed",a,t);if(a.byteLength==2*this.F.n8)return this.op2("_subAffine",t,a)}throw Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw Error("invalid point size")}timesScalar(t,a){let e;if(a instanceof Uint8Array||(a=toLEBuff(fromString(a))),t.byteLength==3*this.F.n8)e=this.prefix+"_timesScalar";else if(t.byteLength==2*this.F.n8)e=this.prefix+"_timesScalarAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[e](this.pOp1,this.pOp2,a.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,a){let e;if(t.byteLength==3*this.F.n8)e=this.prefix+"_timesFr";else if(t.byteLength==2*this.F.n8)e=this.prefix+"_timesFrAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[e](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,a){if(t.byteLength==3*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2bool("_eq",t,a);if(a.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,a);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(a.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",a,t);if(a.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,a)}throw Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw Error("invalid point size")}toRprUncompressed(t,a,e){if(this.tm.setBuff(this.pOp1,e),e.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(e.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let l=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(l,a)}fromRprUncompressed(t,a){let e=t.slice(a,a+2*this.F.n8);return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,a,e){if(this.tm.setBuff(this.pOp1,e),e.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(e.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let l=this.tm.getBuff(this.pOp1,this.F.n8);t.set(l,a)}fromRprCompressed(t,a){let e=t.slice(a,a+this.F.n8);return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){let a=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(a,0,t),a}toRprLEM(t,a,e){if(e.byteLength==2*this.F.n8){t.set(e,a);return}if(e.byteLength==3*this.F.n8){this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let l=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(l,a)}else throw Error("invalid point size")}fromRprLEM(t,a){return a=a||0,t.slice(a,a+2*this.F.n8)}toString(t,a){if(t.byteLength==3*this.F.n8){let e=this.F.toString(t.slice(0,this.F.n8),a),l=this.F.toString(t.slice(this.F.n8,2*this.F.n8),a),o=this.F.toString(t.slice(2*this.F.n8),a);return`[ ${e}, ${l}, ${o} ]`}if(t.byteLength==2*this.F.n8){let e=this.F.toString(t.slice(0,this.F.n8),a),l=this.F.toString(t.slice(this.F.n8),a);return`[ ${e}, ${l} ]`}throw Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;let a=this.F,e=this.toAffine(t),l=e.slice(0,this.F.n8),o=e.slice(this.F.n8,2*this.F.n8),i=a.add(a.mul(a.square(l),l),this.b),c=a.square(o);return a.eq(i,c)}fromRng(t){let a,e;let l=this.F,o=[];do o[0]=l.fromRng(t),a=t.nextBool(),e=l.add(l.mul(l.square(o[0]),o[0]),this.b);while(!l.isSquare(e));o[1]=l.sqrt(e);let i=l.isNegative(o[1]);a^i&&(o[1]=l.neg(o[1]));let c=new Uint8Array(2*this.F.n8);return c.set(o[0]),c.set(o[1],this.F.n8),this.cofactor&&(c=this.timesScalar(c,this.cofactor)),c}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];let a=this.F.toObject(t.slice(0,this.F.n8)),e=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));return[a,e,t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one)]}fromObject(t){let a;let e=this.F.fromObject(t[0]),l=this.F.fromObject(t[1]);if(a=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(a,this.F.one))return this.zeroAffine;if(this.F.eq(a,this.F.one)){let t=new Uint8Array(2*this.F.n8);return t.set(e),t.set(l,this.F.n8),t}{let t=new Uint8Array(3*this.F.n8);return t.set(e),t.set(l,this.F.n8),t.set(a,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){let a=this.toAffine(t);return a.slice(0,this.F.n8)}y(t){let a=this.toAffine(t);return a.slice(this.F.n8)}};var O=(c=Worker)&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c;let Deferred=class Deferred{constructor(){this.promise=new Promise((t,a)=>{this.reject=a,this.resolve=t})}};let w=globalThis.btoa('(function thread(self) {\n    const MAXMEM = 32767;\n    let instance;\n    let memory;\n\n    if (self) {\n        self.onmessage = function(e) {\n            let data;\n            if (e.data) {\n                data = e.data;\n            } else {\n                data = e;\n            }\n\n            if (data[0].cmd == "INIT") {\n                init(data[0]).then(function() {\n                    self.postMessage(data.result);\n                });\n            } else if (data[0].cmd == "TERMINATE") {\n                self.close();\n            } else {\n                const res = runTask(data);\n                self.postMessage(res);\n            }\n        };\n    }\n\n    async function init(data) {\n        const code = new Uint8Array(data.code);\n        const wasmModule = await WebAssembly.compile(code);\n        memory = new WebAssembly.Memory({initial:data.init, maximum: MAXMEM});\n\n        instance = await WebAssembly.instantiate(wasmModule, {\n            env: {\n                "memory": memory\n            }\n        });\n    }\n\n\n\n    function alloc(length) {\n        const u32 = new Uint32Array(memory.buffer, 0, 1);\n        while (u32[0] & 3) u32[0]++;  // Return always aligned pointers\n        const res = u32[0];\n        u32[0] += length;\n        if (u32[0] + length > memory.buffer.byteLength) {\n            const currentPages = memory.buffer.byteLength / 0x10000;\n            let requiredPages = Math.floor((u32[0] + length) / 0x10000)+1;\n            if (requiredPages>MAXMEM) requiredPages=MAXMEM;\n            memory.grow(requiredPages-currentPages);\n        }\n        return res;\n    }\n\n    function allocBuffer(buffer) {\n        const p = alloc(buffer.byteLength);\n        setBuffer(p, buffer);\n        return p;\n    }\n\n    function getBuffer(pointer, length) {\n        const u8 = new Uint8Array(memory.buffer);\n        return new Uint8Array(u8.buffer, u8.byteOffset + pointer, length);\n    }\n\n    function setBuffer(pointer, buffer) {\n        const u8 = new Uint8Array(memory.buffer);\n        u8.set(new Uint8Array(buffer), pointer);\n    }\n\n    function runTask(task) {\n        if (task[0].cmd == "INIT") {\n            return init(task[0]);\n        }\n        const ctx = {\n            vars: [],\n            out: []\n        };\n        const u32a = new Uint32Array(memory.buffer, 0, 1);\n        const oldAlloc = u32a[0];\n        for (let i=0; i<task.length; i++) {\n            switch (task[i].cmd) {\n            case "ALLOCSET":\n                ctx.vars[task[i].var] = allocBuffer(task[i].buff);\n                break;\n            case "ALLOC":\n                ctx.vars[task[i].var] = alloc(task[i].len);\n                break;\n            case "SET":\n                setBuffer(ctx.vars[task[i].var], task[i].buff);\n                break;\n            case "CALL": {\n                const params = [];\n                for (let j=0; j<task[i].params.length; j++) {\n                    const p = task[i].params[j];\n                    if (typeof p.var !== "undefined") {\n                        params.push(ctx.vars[p.var] + (p.offset || 0));\n                    } else if (typeof p.val != "undefined") {\n                        params.push(p.val);\n                    }\n                }\n                instance.exports[task[i].fnName](...params);\n                break;\n            }\n            case "GET":\n                ctx.out[task[i].out] = getBuffer(ctx.vars[task[i].var], task[i].len).slice();\n                break;\n            default:\n                throw new Error("Invalid cmd");\n            }\n        }\n        const u32b = new Uint32Array(memory.buffer, 0, 1);\n        u32b[0] = oldAlloc;\n        return ctx.out;\n    }\n\n\n    return runTask;\n})(self)'),M="data:application/javascript;base64,"+w;async function buildThreadManager(t,a){let e=new ThreadManager;e.memory=new WebAssembly.Memory({initial:25}),e.u8=new Uint8Array(e.memory.buffer),e.u32=new Uint32Array(e.memory.buffer);let l=await WebAssembly.compile(t.code);if(e.instance=await WebAssembly.instantiate(l,{env:{memory:e.memory}}),e.singleThread=a,e.initalPFree=e.u32[0],e.pq=t.pq,e.pr=t.pr,e.pG1gen=t.pG1gen,e.pG1zero=t.pG1zero,e.pG2gen=t.pG2gen,e.pG2zero=t.pG2zero,e.pOneT=t.pOneT,a)e.code=t.code,e.taskManager=function(t){let a,e;async function init(t){let l=new Uint8Array(t.code),o=await WebAssembly.compile(l);e=new WebAssembly.Memory({initial:t.init,maximum:32767}),a=await WebAssembly.instantiate(o,{env:{memory:e}})}function alloc(t){let a=new Uint32Array(e.buffer,0,1);for(;3&a[0];)a[0]++;let l=a[0];if(a[0]+=t,a[0]+t>e.buffer.byteLength){let l=e.buffer.byteLength/65536,o=Math.floor((a[0]+t)/65536)+1;o>32767&&(o=32767),e.grow(o-l)}return l}function setBuffer(t,a){let l=new Uint8Array(e.buffer);l.set(new Uint8Array(a),t)}function runTask(t){if("INIT"==t[0].cmd)return init(t[0]);let l={vars:[],out:[]},o=new Uint32Array(e.buffer,0,1),i=o[0];for(let o=0;o<t.length;o++)switch(t[o].cmd){case"ALLOCSET":l.vars[t[o].var]=function(t){let a=alloc(t.byteLength);return setBuffer(a,t),a}(t[o].buff);break;case"ALLOC":l.vars[t[o].var]=alloc(t[o].len);break;case"SET":setBuffer(l.vars[t[o].var],t[o].buff);break;case"CALL":{let e=[];for(let a=0;a<t[o].params.length;a++){let i=t[o].params[a];void 0!==i.var?e.push(l.vars[i.var]+(i.offset||0)):void 0!==i.val&&e.push(i.val)}a.exports[t[o].fnName](...e);break}case"GET":l.out[t[o].out]=(function(t,a){let l=new Uint8Array(e.buffer);return new Uint8Array(l.buffer,l.byteOffset+t,a)})(l.vars[t[o].var],t[o].len).slice();break;default:throw Error("Invalid cmd")}let c=new Uint32Array(e.buffer,0,1);return c[0]=i,l.out}return t&&(t.onmessage=function(a){let e;if("INIT"==(e=a.data?a.data:a)[0].cmd)init(e[0]).then(function(){t.postMessage(e.result)});else if("TERMINATE"==e[0].cmd)t.close();else{let a=runTask(e);t.postMessage(a)}}),runTask}(),await e.taskManager([{cmd:"INIT",init:25,code:e.code.slice()}]),e.concurrency=1;else{e.workers=[],e.pendingDeferreds=[],e.working=[];let a=2;"object"==typeof navigator&&navigator.hardwareConcurrency&&(a=navigator.hardwareConcurrency),0==a&&(a=2),a>64&&(a=64),e.concurrency=a;for(let t=0;t<a;t++)e.workers[t]=new O(M),e.workers[t].addEventListener("message",function(t){return function(a){let l;l=a&&a.data?a.data:a,e.working[t]=!1,e.pendingDeferreds[t].resolve(l),e.processWorks()}}(t)),e.working[t]=!1;let l=[];for(let a=0;a<e.workers.length;a++){let o=t.code.slice();l.push(e.postAction(a,[{cmd:"INIT",init:25,code:o}],[o.buffer]))}await Promise.all(l)}return e}let ThreadManager=class ThreadManager{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,a,e,l){if(this.working[t])throw Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=l||new Deferred,this.workers[t].postMessage(a,e),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(!1==this.working[t]){let a=this.actionQueue.shift();this.postAction(t,a.data,a.transfers,a.deferred)}}queueAction(t,a){let e=new Deferred;if(this.singleThread){let a=this.taskManager(t);e.resolve(a)}else this.actionQueue.push({data:t,transfers:a,deferred:e}),this.processWorks();return e.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){let a=this.alloc(t.byteLength);return this.setBuff(a,t),a}getBuff(t,a){return this.u8.slice(t,t+a)}setBuff(t,a){this.u8.set(new Uint8Array(a),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;let a=this.u32[0];return this.u32[0]+=t,a}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await new Promise(t=>setTimeout(t,200))}};function buildBatchApplyKey(t,a){let e=t[a],l=t.Fr,o=t.tm;t[a].batchApplyKey=async function(t,i,c,n,d){let r,s,_,u,f,g;if(n=n||"affine",d=d||"affine","G1"==a)"jacobian"==n?(_=3*e.F.n8,r="g1m_batchApplyKey"):(_=2*e.F.n8,r="g1m_batchApplyKeyMixed"),u=3*e.F.n8,"jacobian"==d?f=3*e.F.n8:(s="g1m_batchToAffine",f=2*e.F.n8);else if("G2"==a)"jacobian"==n?(_=3*e.F.n8,r="g2m_batchApplyKey"):(_=2*e.F.n8,r="g2m_batchApplyKeyMixed"),u=3*e.F.n8,"jacobian"==d?f=3*e.F.n8:(s="g2m_batchToAffine",f=2*e.F.n8);else if("Fr"==a)r="frm_batchApplyKey",_=e.n8,u=e.n8,f=e.n8;else throw Error("Invalid group: "+a);let p=Math.floor(t.byteLength/_),L=Math.floor(p/o.concurrency),m=[];c=l.e(c);let h=l.e(i);for(let a=0;a<o.concurrency;a++){let e;if(0==(e=a<o.concurrency-1?L:p-a*L))continue;let i=[];i.push({cmd:"ALLOCSET",var:0,buff:t.slice(a*L*_,a*L*_+e*_)}),i.push({cmd:"ALLOCSET",var:1,buff:h}),i.push({cmd:"ALLOCSET",var:2,buff:c}),i.push({cmd:"ALLOC",var:3,len:e*Math.max(u,f)}),i.push({cmd:"CALL",fnName:r,params:[{var:0},{val:e},{var:1},{var:2},{var:3}]}),s&&i.push({cmd:"CALL",fnName:s,params:[{var:3},{val:e},{var:3}]}),i.push({cmd:"GET",out:0,var:3,len:e*f}),m.push(o.queueAction(i)),h=l.mul(h,l.exp(c,e))}let b=await Promise.all(m);g=t instanceof BigBuffer?new BigBuffer(p*f):new Uint8Array(p*f);let x=0;for(let t=0;t<b.length;t++)g.set(b[t][0],x),x+=b[t][0].byteLength;return g}}let S=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function buildMultiexp(t,a){let e=t[a],l=e.tm;async function _multiExpChunk(t,l,o,i,c){let n,d;if(!(t instanceof Uint8Array))throw i&&i.error(`${c} _multiExpChunk buffBases is not Uint8Array`),Error(`${c} _multiExpChunk buffBases is not Uint8Array`);if(!(l instanceof Uint8Array))throw i&&i.error(`${c} _multiExpChunk buffScalars is not Uint8Array`),Error(`${c} _multiExpChunk buffScalars is not Uint8Array`);if(o=o||"affine","G1"==a)"affine"==o?(d="g1m_multiexpAffine_chunk",n=2*e.F.n8):(d="g1m_multiexp_chunk",n=3*e.F.n8);else if("G2"==a)"affine"==o?(d="g2m_multiexpAffine_chunk",n=2*e.F.n8):(d="g2m_multiexp_chunk",n=3*e.F.n8);else throw Error("Invalid group");let r=Math.floor(t.byteLength/n);if(0==r)return e.zero;let s=Math.floor(l.byteLength/r);if(s*r!=l.byteLength)throw Error("Scalar size does not match");let _=S[log2(r)],u=Math.floor((8*s-1)/_)+1,f=[];for(let a=0;a<u;a++){let o=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:l},{cmd:"ALLOC",var:2,len:3*e.F.n8},{cmd:"CALL",fnName:d,params:[{var:0},{var:1},{val:s},{val:r},{val:a*_},{val:Math.min(8*s-a*_,_)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*e.F.n8}];f.push(e.tm.queueAction(o))}let g=await Promise.all(f),p=e.zero;for(let t=g.length-1;t>=0;t--){if(!e.isZero(p))for(let t=0;t<_;t++)p=e.double(p);p=e.add(p,g[t][0])}return p}async function _multiExp(t,o,i,c,n){let d,r;if("G1"==a)d="affine"==i?2*e.F.n8:3*e.F.n8;else if("G2"==a)d="affine"==i?2*e.F.n8:3*e.F.n8;else throw Error("Invalid group");let s=Math.floor(t.byteLength/d),_=Math.floor(o.byteLength/s);if(_*s!=o.byteLength)throw Error("Scalar size does not match");let u=S[log2(s)],f=Math.floor((8*_-1)/u)+1;(r=Math.floor(s/(l.concurrency/f)))>4194304&&(r=4194304),r<1024&&(r=1024);let g=[];for(let a=0;a<s;a+=r){c&&c.debug(`Multiexp start: ${n}: ${a}/${s}`);let e=Math.min(s-a,r),l=t.slice(a*d,(a+e)*d),u=o.slice(a*_,(a+e)*_);g.push(_multiExpChunk(l,u,i,c,n).then(t=>(c&&c.debug(`Multiexp end: ${n}: ${a}/${s}`),t)))}let p=await Promise.all(g),L=e.zero;for(let t=p.length-1;t>=0;t--)L=e.add(L,p[t]);return L}e.multiExp=async function(t,a,e,l){return await _multiExp(t,a,"jacobian",e,l)},e.multiExpAffine=async function(t,a,e,l){return await _multiExp(t,a,"affine",e,l)}}function buildFFT(t,a){let e=t[a],l=t.Fr,o=e.tm;async function _fft(t,i,c,n,d,r){let s,_,u,f,g,p,L,m,h,b,x;c=c||"affine",n=n||"affine","G1"==a?("affine"==c?(s=2*e.F.n8,f="g1m_batchToJacobian"):s=3*e.F.n8,_=3*e.F.n8,i&&(m="g1m_fftFinal"),L="g1m_fftJoin",p="g1m_fftMix","affine"==n?(u=2*e.F.n8,g="g1m_batchToAffine"):u=3*e.F.n8):"G2"==a?("affine"==c?(s=2*e.F.n8,f="g2m_batchToJacobian"):s=3*e.F.n8,_=3*e.F.n8,i&&(m="g2m_fftFinal"),L="g2m_fftJoin",p="g2m_fftMix","affine"==n?(u=2*e.F.n8,g="g2m_batchToAffine"):u=3*e.F.n8):"Fr"==a&&(s=e.n8,_=e.n8,u=e.n8,i&&(m="frm_fftFinal"),p="frm_fftMix",L="frm_fftJoin");let y=!1;Array.isArray(t)?(t=array2buffer(t,s),y=!0):t=t.slice(0,t.byteLength);let F=t.byteLength/s,B=log2(F);if(1<<B!=F)throw Error("fft must be multiple of 2");if(B==l.s+1){let a;return(a=i?await _fftExtInv(t,c,n,d,r):await _fftExt(t,c,n,d,r),y)?buffer2array(a,u):a}i&&(h=l.inv(l.e(F))),buffReverseBits(t,s);let C=Math.min(16384,F),v=F/C;for(;v<o.concurrency&&C>=16;)v*=2,C/=2;let P=log2(C),q=[];for(let a=0;a<v;a++){d&&d.debug(`${r}: fft ${B} mix start: ${a}/${v}`);let e=[];e.push({cmd:"ALLOC",var:0,len:_*C});let l=t.slice(C*a*s,C*(a+1)*s);e.push({cmd:"SET",var:0,buff:l}),f&&e.push({cmd:"CALL",fnName:f,params:[{var:0},{val:C},{var:0}]});for(let t=1;t<=P;t++)e.push({cmd:"CALL",fnName:p,params:[{var:0},{val:C},{val:t}]});P==B?(m&&(e.push({cmd:"ALLOCSET",var:1,buff:h}),e.push({cmd:"CALL",fnName:m,params:[{var:0},{val:C},{var:1}]})),g&&e.push({cmd:"CALL",fnName:g,params:[{var:0},{val:C},{var:0}]}),e.push({cmd:"GET",out:0,var:0,len:C*u})):e.push({cmd:"GET",out:0,var:0,len:_*C}),q.push(o.queueAction(e).then(t=>(d&&d.debug(`${r}: fft ${B} mix end: ${a}/${v}`),t)))}x=await Promise.all(q);for(let t=0;t<v;t++)x[t]=x[t][0];for(let t=P+1;t<=B;t++){d&&d.debug(`${r}: fft  ${B}  join: ${t}/${B}`);let a=1<<B-t,e=v/a,i=[];for(let c=0;c<a;c++)for(let n=0;n<e/2;n++){let s=l.exp(l.w[t],n*C),f=l.w[t],p=c*e+n,b=c*e+n+e/2,y=[];y.push({cmd:"ALLOCSET",var:0,buff:x[p]}),y.push({cmd:"ALLOCSET",var:1,buff:x[b]}),y.push({cmd:"ALLOCSET",var:2,buff:s}),y.push({cmd:"ALLOCSET",var:3,buff:f}),y.push({cmd:"CALL",fnName:L,params:[{var:0},{var:1},{val:C},{var:2},{var:3}]}),t==B?(m&&(y.push({cmd:"ALLOCSET",var:4,buff:h}),y.push({cmd:"CALL",fnName:m,params:[{var:0},{val:C},{var:4}]}),y.push({cmd:"CALL",fnName:m,params:[{var:1},{val:C},{var:4}]})),g&&(y.push({cmd:"CALL",fnName:g,params:[{var:0},{val:C},{var:0}]}),y.push({cmd:"CALL",fnName:g,params:[{var:1},{val:C},{var:1}]})),y.push({cmd:"GET",out:0,var:0,len:C*u}),y.push({cmd:"GET",out:1,var:1,len:C*u})):(y.push({cmd:"GET",out:0,var:0,len:C*_}),y.push({cmd:"GET",out:1,var:1,len:C*_})),i.push(o.queueAction(y).then(l=>(d&&d.debug(`${r}: fft ${B} join  ${t}/${B}  ${c+1}/${a} ${n}/${e/2}`),l)))}let c=await Promise.all(i);for(let t=0;t<a;t++)for(let a=0;a<e/2;a++){let l=t*e+a,o=t*e+a+e/2,i=c.shift();x[l]=i[0],x[o]=i[1]}}if(b=t instanceof BigBuffer?new BigBuffer(F*u):new Uint8Array(F*u),i){b.set(x[0].slice((C-1)*u));let t=u;for(let a=v-1;a>0;a--)b.set(x[a],t),t+=C*u,delete x[a];b.set(x[0].slice(0,(C-1)*u),t),delete x[0]}else for(let t=0;t<v;t++)b.set(x[t],C*u*t),delete x[t];return y?buffer2array(b,u):b}async function _fftExt(t,a,e,o,i){let c,n,d;c=t.slice(0,t.byteLength/2),n=t.slice(t.byteLength/2,t.byteLength);let r=[];[c,n]=await _fftJoinExt(c,n,"fftJoinExt",l.one,l.shift,a,"jacobian",o,i),r.push(_fft(c,!1,"jacobian",e,o,i)),r.push(_fft(n,!1,"jacobian",e,o,i));let s=await Promise.all(r);return(d=s[0].byteLength>268435456?new BigBuffer(2*s[0].byteLength):new Uint8Array(2*s[0].byteLength)).set(s[0]),d.set(s[1],s[0].byteLength),d}async function _fftExtInv(t,a,e,o,i){let c,n,d;c=t.slice(0,t.byteLength/2),n=t.slice(t.byteLength/2,t.byteLength);let r=[];r.push(_fft(c,!0,a,"jacobian",o,i)),r.push(_fft(n,!0,a,"jacobian",o,i)),[c,n]=await Promise.all(r);let s=await _fftJoinExt(c,n,"fftJoinExtInv",l.one,l.shiftInv,"jacobian",e,o,i);return(d=s[0].byteLength>268435456?new BigBuffer(2*s[0].byteLength):new Uint8Array(2*s[0].byteLength)).set(s[0]),d.set(s[1],s[0].byteLength),d}async function _fftJoinExt(t,i,c,n,d,r,s,_,u){let f,g,p,L,m,h,b,x;if("G1"==a)"affine"==r?(m=2*e.F.n8,g="g1m_batchToJacobian"):m=3*e.F.n8,h=3*e.F.n8,f="g1m_"+c,"affine"==s?(p="g1m_batchToAffine",L=2*e.F.n8):L=3*e.F.n8;else if("G2"==a)"affine"==r?(m=2*e.F.n8,g="g2m_batchToJacobian"):m=3*e.F.n8,f="g2m_"+c,h=3*e.F.n8,"affine"==s?(p="g2m_batchToAffine",L=2*e.F.n8):L=3*e.F.n8;else if("Fr"==a)m=l.n8,L=l.n8,h=l.n8,f="frm_"+c;else throw Error("Invalid group");if(t.byteLength!=i.byteLength)throw Error("Invalid buffer size");let y=Math.floor(t.byteLength/m);if(y!=1<<log2(y))throw Error("Invalid number of points");let F=Math.floor(y/o.concurrency);F<16&&(F=16),F>65536&&(F=65536);let B=[];for(let a=0;a<y;a+=F){_&&_.debug(`${u}: fftJoinExt Start: ${a}/${y}`);let e=Math.min(y-a,F),c=l.mul(n,l.exp(d,a)),r=[],s=t.slice(a*m,(a+e)*m),b=i.slice(a*m,(a+e)*m);r.push({cmd:"ALLOC",var:0,len:h*e}),r.push({cmd:"SET",var:0,buff:s}),r.push({cmd:"ALLOC",var:1,len:h*e}),r.push({cmd:"SET",var:1,buff:b}),r.push({cmd:"ALLOCSET",var:2,buff:c}),r.push({cmd:"ALLOCSET",var:3,buff:d}),g&&(r.push({cmd:"CALL",fnName:g,params:[{var:0},{val:e},{var:0}]}),r.push({cmd:"CALL",fnName:g,params:[{var:1},{val:e},{var:1}]})),r.push({cmd:"CALL",fnName:f,params:[{var:0},{var:1},{val:e},{var:2},{var:3},{val:l.s}]}),p&&(r.push({cmd:"CALL",fnName:p,params:[{var:0},{val:e},{var:0}]}),r.push({cmd:"CALL",fnName:p,params:[{var:1},{val:e},{var:1}]})),r.push({cmd:"GET",out:0,var:0,len:e*L}),r.push({cmd:"GET",out:1,var:1,len:e*L}),B.push(o.queueAction(r).then(t=>(_&&_.debug(`${u}: fftJoinExt End: ${a}/${y}`),t)))}let C=await Promise.all(B);y*L>268435456?(b=new BigBuffer(y*L),x=new BigBuffer(y*L)):(b=new Uint8Array(y*L),x=new Uint8Array(y*L));let v=0;for(let t=0;t<C.length;t++)b.set(C[t][0],v),x.set(C[t][1],v),v+=C[t][0].byteLength;return[b,x]}e.fft=async function(t,a,e,l,o){return await _fft(t,!1,a,e,l,o)},e.ifft=async function(t,a,e,l,o){return await _fft(t,!0,a,e,l,o)},e.lagrangeEvaluations=async function(t,o,i,c,n){let d,r;if(o=o||"affine",i=i||"affine","G1"==a)d="affine"==o?2*e.F.n8:3*e.F.n8;else if("G2"==a)d="affine"==o?2*e.F.n8:3*e.F.n8;else if("Fr"==a)d=l.n8;else throw Error("Invalid group");let s=t.byteLength/d,_=log2(s);if(2**_*d!=t.byteLength)throw c&&c.error("lagrangeEvaluations iinvalid input size"),Error("lagrangeEvaluations invalid Input size");if(_<=l.s)return await e.ifft(t,o,i,c,n);if(_>l.s+1)throw c&&c.error("lagrangeEvaluations input too big"),Error("lagrangeEvaluations input too big");let u=t.slice(0,t.byteLength/2),f=t.slice(t.byteLength/2,t.byteLength),g=l.exp(l.shift,s/2),p=l.inv(l.sub(l.one,g));[u,f]=await _fftJoinExt(u,f,"prepareLagrangeEvaluation",p,l.shiftInv,o,"jacobian",c,n+" prep");let L=[];return L.push(_fft(u,!0,"jacobian",i,c,n+" t0")),L.push(_fft(f,!0,"jacobian",i,c,n+" t1")),[u,f]=await Promise.all(L),(r=u.byteLength>268435456?new BigBuffer(2*u.byteLength):new Uint8Array(2*u.byteLength)).set(u),r.set(f,u.byteLength),r},e.fftMix=async function(t){let i,c,n;let d=3*e.F.n8;if("G1"==a)i="g1m_fftMix",c="g1m_fftJoin";else if("G2"==a)i="g2m_fftMix",c="g2m_fftJoin";else if("Fr"==a)i="frm_fftMix",c="frm_fftJoin";else throw Error("Invalid group");let r=Math.floor(t.byteLength/d),s=log2(r),_=1<<log2(o.concurrency);r<=2*_&&(_=1);let u=r/_,f=log2(u),g=[];for(let a=0;a<_;a++){let e=[],l=t.slice(a*u*d,(a+1)*u*d);e.push({cmd:"ALLOCSET",var:0,buff:l});for(let t=1;t<=f;t++)e.push({cmd:"CALL",fnName:i,params:[{var:0},{val:u},{val:t}]});e.push({cmd:"GET",out:0,var:0,len:u*d}),g.push(o.queueAction(e))}let p=await Promise.all(g),L=[];for(let t=0;t<p.length;t++)L[t]=p[t][0];for(let t=f+1;t<=s;t++){let a=1<<s-t,e=_/a,i=[];for(let n=0;n<a;n++)for(let a=0;a<e/2;a++){let r=l.exp(l.w[t],a*u),s=l.w[t],_=n*e+a,f=n*e+a+e/2,g=[];g.push({cmd:"ALLOCSET",var:0,buff:L[_]}),g.push({cmd:"ALLOCSET",var:1,buff:L[f]}),g.push({cmd:"ALLOCSET",var:2,buff:r}),g.push({cmd:"ALLOCSET",var:3,buff:s}),g.push({cmd:"CALL",fnName:c,params:[{var:0},{var:1},{val:u},{var:2},{var:3}]}),g.push({cmd:"GET",out:0,var:0,len:u*d}),g.push({cmd:"GET",out:1,var:1,len:u*d}),i.push(o.queueAction(g))}let n=await Promise.all(i);for(let t=0;t<a;t++)for(let a=0;a<e/2;a++){let l=t*e+a,o=t*e+a+e/2,i=n.shift();L[l]=i[0],L[o]=i[1]}}n=t instanceof BigBuffer?new BigBuffer(r*d):new Uint8Array(r*d);let m=0;for(let t=0;t<_;t++)n.set(L[t],m),m+=L[t].byteLength;return n},e.fftJoin=async function(t,i,c,n){let d,r,s;let _=3*e.F.n8;if("G1"==a)d="g1m_fftJoin";else if("G2"==a)d="g2m_fftJoin";else if("Fr"==a)d="frm_fftJoin";else throw Error("Invalid group");if(t.byteLength!=i.byteLength)throw Error("Invalid buffer size");let u=Math.floor(t.byteLength/_);if(u!=1<<log2(u))throw Error("Invalid number of points");let f=1<<log2(o.concurrency);u<=2*f&&(f=1);let g=u/f,p=[];for(let a=0;a<f;a++){let e=[],r=l.mul(c,l.exp(n,a*g)),s=t.slice(a*g*_,(a+1)*g*_),u=i.slice(a*g*_,(a+1)*g*_);e.push({cmd:"ALLOCSET",var:0,buff:s}),e.push({cmd:"ALLOCSET",var:1,buff:u}),e.push({cmd:"ALLOCSET",var:2,buff:r}),e.push({cmd:"ALLOCSET",var:3,buff:n}),e.push({cmd:"CALL",fnName:d,params:[{var:0},{var:1},{val:g},{var:2},{var:3}]}),e.push({cmd:"GET",out:0,var:0,len:g*_}),e.push({cmd:"GET",out:1,var:1,len:g*_}),p.push(o.queueAction(e))}let L=await Promise.all(p);t instanceof BigBuffer?(r=new BigBuffer(u*_),s=new BigBuffer(u*_)):(r=new Uint8Array(u*_),s=new Uint8Array(u*_));let m=0;for(let t=0;t<L.length;t++)r.set(L[t][0],m),s.set(L[t][1],m),m+=L[t][0].byteLength;return[r,s]},e.fftFinal=async function(t,l){let i,c,n;let d=3*e.F.n8,r=2*e.F.n8;if("G1"==a)i="g1m_fftFinal",c="g1m_batchToAffine";else if("G2"==a)i="g2m_fftFinal",c="g2m_batchToAffine";else throw Error("Invalid group");let s=Math.floor(t.byteLength/d);if(s!=1<<log2(s))throw Error("Invalid number of points");let _=Math.floor(s/o.concurrency),u=[];for(let a=0;a<o.concurrency;a++){let e;if(0==(e=a<o.concurrency-1?_:s-a*_))continue;let n=[],f=t.slice(a*_*d,(a*_+e)*d);n.push({cmd:"ALLOCSET",var:0,buff:f}),n.push({cmd:"ALLOCSET",var:1,buff:l}),n.push({cmd:"CALL",fnName:i,params:[{var:0},{val:e},{var:1}]}),n.push({cmd:"CALL",fnName:c,params:[{var:0},{val:e},{var:0}]}),n.push({cmd:"GET",out:0,var:0,len:e*r}),u.push(o.queueAction(n))}let f=await Promise.all(u);n=t instanceof BigBuffer?new BigBuffer(s*r):new Uint8Array(s*r);let g=0;for(let t=f.length-1;t>=0;t--)n.set(f[t][0],g),g+=f[t][0].byteLength;return n}}async function buildEngine(t){let a=await buildThreadManager(t.wasm,t.singleThread),e={};return e.q=fromString(t.wasm.q.toString()),e.r=fromString(t.wasm.r.toString()),e.name=t.name,e.tm=a,e.prePSize=t.wasm.prePSize,e.preQSize=t.wasm.preQSize,e.Fr=new WasmField1(a,"frm",t.n8r,t.r),e.F1=new WasmField1(a,"f1m",t.n8q,t.q),e.F2=new WasmField2(a,"f2m",e.F1),e.G1=new WasmCurve(a,"g1m",e.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),e.G2=new WasmCurve(a,"g2m",e.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),e.F6=new WasmField3(a,"f6m",e.F2),e.F12=new WasmField2(a,"ftm",e.F6),e.Gt=e.F12,buildBatchApplyKey(e,"G1"),buildBatchApplyKey(e,"G2"),buildBatchApplyKey(e,"Fr"),buildMultiexp(e,"G1"),buildMultiexp(e,"G2"),buildFFT(e,"G1"),buildFFT(e,"G2"),buildFFT(e,"Fr"),!function(t){let a=t.tm;t.pairing=function(e,l){a.startSyncOp();let o=a.allocBuff(t.G1.toJacobian(e)),i=a.allocBuff(t.G2.toJacobian(l)),c=a.alloc(t.Gt.n8);a.instance.exports[t.name+"_pairing"](o,i,c);let n=a.getBuff(c,t.Gt.n8);return a.endSyncOp(),n},t.pairingEq=async function(){let e,l;arguments.length%2==1?(e=arguments[arguments.length-1],l=(arguments.length-1)/2):(e=t.Gt.one,l=arguments.length/2);let o=[];for(let e=0;e<l;e++){let l=[],i=t.G1.toJacobian(arguments[2*e]);l.push({cmd:"ALLOCSET",var:0,buff:i}),l.push({cmd:"ALLOC",var:1,len:t.prePSize});let c=t.G2.toJacobian(arguments[2*e+1]);l.push({cmd:"ALLOCSET",var:2,buff:c}),l.push({cmd:"ALLOC",var:3,len:t.preQSize}),l.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),l.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),l.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),l.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),l.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),o.push(a.queueAction(l))}let i=await Promise.all(o);a.startSyncOp();let c=a.alloc(t.Gt.n8);a.instance.exports.ftm_one(c);for(let t=0;t<i.length;t++){let e=a.allocBuff(i[t][0]);a.instance.exports.ftm_mul(c,e,c)}a.instance.exports[t.name+"_finalExponentiation"](c,c);let n=a.allocBuff(e),d=!!a.instance.exports.ftm_eq(c,n);return a.endSyncOp(),d},t.prepareG1=function(t){this.tm.startSyncOp();let a=this.tm.allocBuff(t),e=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](a,e);let l=this.tm.getBuff(e,this.prePSize);return this.tm.endSyncOp(),l},t.prepareG2=function(t){this.tm.startSyncOp();let a=this.tm.allocBuff(t),e=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](a,e);let l=this.tm.getBuff(e,this.preQSize);return this.tm.endSyncOp(),l},t.millerLoop=function(t,a){this.tm.startSyncOp();let e=this.tm.allocBuff(t),l=this.tm.allocBuff(a),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](e,l,o);let i=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),i},t.finalExponentiation=function(t){this.tm.startSyncOp();let a=this.tm.allocBuff(t),e=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](a,e);let l=this.tm.getBuff(e,this.Gt.n8);return this.tm.endSyncOp(),l}}(e),e.array2buffer=function(t,a){let e=new Uint8Array(a*t.length);for(let l=0;l<t.length;l++)e.set(t[l],l*a);return e},e.buffer2array=function(t,a){let e=t.byteLength/a,l=Array(e);for(let o=0;o<e;o++)l[o]=t.slice(o*a,o*a+a);return l},e}function toNumber(t){return BigInt(t)}function u32(t){let a=[],e=toNumber(t);return a.push(Number(255n&e)),a.push(Number(e>>8n&255n)),a.push(Number(e>>16n&255n)),a.push(Number(e>>24n&255n)),a}function string(t){let a=function(t){for(var a=[],e=0;e<t.length;e++){var l=t.charCodeAt(e);l<128?a.push(l):l<2048?a.push(192|l>>6,128|63&l):l<55296||l>=57344?a.push(224|l>>12,128|l>>6&63,128|63&l):(e++,l=65536+((1023&l)<<10|1023&t.charCodeAt(e)),a.push(240|l>>18,128|l>>12&63,128|l>>6&63,128|63&l))}return a}(t);return[...varuint32(a.length),...a]}function varuint(t){let a=[],e=toNumber(t);if(e<0n)throw Error("Number cannot be negative");for(;0n!==e;)a.push(Number(127n&e)),e>>=7n;0==a.length&&a.push(0);for(let t=0;t<a.length-1;t++)a[t]=128|a[t];return a}function varint(t){let a,e;let l=t<0n?t.toString(2).length-1:t.toString(2).length;t<0?(e=!0,a=(1n<<BigInt(l))+t):(e=!1,a=toNumber(t));let o=7-l%7,i=(1n<<BigInt(o))-1n<<BigInt(l),c=varuint(a+i);return e||(c[c.length-1]=c[c.length-1]&((1<<7-o)-1|128)),c}function varint32(t){let a=toNumber(t);if(a>4294967295n)throw Error("Number too big");if(a>2147483647n&&(a-=4294967296n),a<-2147483648n)throw Error("Number too small");return varint(a)}function varuint32(t){let a=toNumber(t);if(a>4294967295n)throw Error("Number too big");return varuint(a)}function toHexString(t){return Array.from(t,function(t){return("0"+(255&t).toString(16)).slice(-2)}).join("")}let CodeBuilder=class CodeBuilder{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,a){let e=this.func.localIdxByName[t];if(void 0===e)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...a,33,...varuint32(e)]}teeLocal(t,a){let e=this.func.localIdxByName[t];if(void 0===e)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...a,34,...varuint32(e)]}getLocal(t){let a=this.func.localIdxByName[t];if(void 0===a)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...varuint32(a)]}i64_load8_s(t,a,e){let l=a||0;return[...t,48,void 0===e?0:e,...varuint32(l)]}i64_load8_u(t,a,e){let l=a||0;return[...t,49,void 0===e?0:e,...varuint32(l)]}i64_load16_s(t,a,e){let l=a||0;return[...t,50,void 0===e?1:e,...varuint32(l)]}i64_load16_u(t,a,e){let l=a||0;return[...t,51,void 0===e?1:e,...varuint32(l)]}i64_load32_s(t,a,e){let l=a||0;return[...t,52,void 0===e?2:e,...varuint32(l)]}i64_load32_u(t,a,e){let l=a||0;return[...t,53,void 0===e?2:e,...varuint32(l)]}i64_load(t,a,e){let l=a||0;return[...t,41,void 0===e?3:e,...varuint32(l)]}i64_store(t,a,e,l){let o,i,c;return Array.isArray(a)?(o=0,i=3,c=a):Array.isArray(e)?(o=a,i=3,c=e):Array.isArray(l)&&(o=a,i=e,c=l),[...t,...c,55,i,...varuint32(o)]}i64_store32(t,a,e,l){let o,i,c;return Array.isArray(a)?(o=0,i=2,c=a):Array.isArray(e)?(o=a,i=2,c=e):Array.isArray(l)&&(o=a,i=e,c=l),[...t,...c,62,i,...varuint32(o)]}i64_store16(t,a,e,l){let o,i,c;return Array.isArray(a)?(o=0,i=1,c=a):Array.isArray(e)?(o=a,i=1,c=e):Array.isArray(l)&&(o=a,i=e,c=l),[...t,...c,61,i,...varuint32(o)]}i64_store8(t,a,e,l){let o,i,c;return Array.isArray(a)?(o=0,i=0,c=a):Array.isArray(e)?(o=a,i=0,c=e):Array.isArray(l)&&(o=a,i=e,c=l),[...t,...c,60,i,...varuint32(o)]}i32_load8_s(t,a,e){let l=a||0;return[...t,44,void 0===e?0:e,...varuint32(l)]}i32_load8_u(t,a,e){let l=a||0;return[...t,45,void 0===e?0:e,...varuint32(l)]}i32_load16_s(t,a,e){let l=a||0;return[...t,46,void 0===e?1:e,...varuint32(l)]}i32_load16_u(t,a,e){let l=a||0;return[...t,47,void 0===e?1:e,...varuint32(l)]}i32_load(t,a,e){let l=a||0;return[...t,40,void 0===e?2:e,...varuint32(l)]}i32_store(t,a,e,l){let o,i,c;return Array.isArray(a)?(o=0,i=2,c=a):Array.isArray(e)?(o=a,i=2,c=e):Array.isArray(l)&&(o=a,i=e,c=l),[...t,...c,54,i,...varuint32(o)]}i32_store16(t,a,e,l){let o,i,c;return Array.isArray(a)?(o=0,i=1,c=a):Array.isArray(e)?(o=a,i=1,c=e):Array.isArray(l)&&(o=a,i=e,c=l),[...t,...c,59,i,...varuint32(o)]}i32_store8(t,a,e,l){let o,i,c;return Array.isArray(a)?(o=0,i=0,c=a):Array.isArray(e)?(o=a,i=0,c=e):Array.isArray(l)&&(o=a,i=e,c=l),[...t,...c,58,i,...varuint32(o)]}call(t,...a){let e=this.module.functionIdxByName[t];if(void 0===e)throw Error(`Function not defined: Function: ${t}`);return[...[].concat(...a),16,...varuint32(e)]}call_indirect(t,...a){return[...[].concat(...a),...t,17,0,0]}if(t,a,e){return e?[...t,4,64,...a,5,...e,11]:[...t,4,64,...a,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...[...t]),11]}br_if(t,a){return[...a,13,...varuint32(t)]}br(t){return[12,...varuint32(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...function(t){let a=toNumber(t);if(a>0xffffffffffffffffn)throw Error("Number too big");if(a>0x7fffffffffffffffn&&(a-=0x10000000000000000n),a<-0x8000000000000000n)throw Error("Number too small");return varint(a)}(t)]}i32_const(t){return[65,...varint32(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,a){return[...t,...a,81]}i64_ne(t,a){return[...t,...a,82]}i64_lt_s(t,a){return[...t,...a,83]}i64_lt_u(t,a){return[...t,...a,84]}i64_gt_s(t,a){return[...t,...a,85]}i64_gt_u(t,a){return[...t,...a,86]}i64_le_s(t,a){return[...t,...a,87]}i64_le_u(t,a){return[...t,...a,88]}i64_ge_s(t,a){return[...t,...a,89]}i64_ge_u(t,a){return[...t,...a,90]}i64_add(t,a){return[...t,...a,124]}i64_sub(t,a){return[...t,...a,125]}i64_mul(t,a){return[...t,...a,126]}i64_div_s(t,a){return[...t,...a,127]}i64_div_u(t,a){return[...t,...a,128]}i64_rem_s(t,a){return[...t,...a,129]}i64_rem_u(t,a){return[...t,...a,130]}i64_and(t,a){return[...t,...a,131]}i64_or(t,a){return[...t,...a,132]}i64_xor(t,a){return[...t,...a,133]}i64_shl(t,a){return[...t,...a,134]}i64_shr_s(t,a){return[...t,...a,135]}i64_shr_u(t,a){return[...t,...a,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,a){return[...t,...a,70]}i32_ne(t,a){return[...t,...a,71]}i32_lt_s(t,a){return[...t,...a,72]}i32_lt_u(t,a){return[...t,...a,73]}i32_gt_s(t,a){return[...t,...a,74]}i32_gt_u(t,a){return[...t,...a,75]}i32_le_s(t,a){return[...t,...a,76]}i32_le_u(t,a){return[...t,...a,77]}i32_ge_s(t,a){return[...t,...a,78]}i32_ge_u(t,a){return[...t,...a,79]}i32_add(t,a){return[...t,...a,106]}i32_sub(t,a){return[...t,...a,107]}i32_mul(t,a){return[...t,...a,108]}i32_div_s(t,a){return[...t,...a,109]}i32_div_u(t,a){return[...t,...a,110]}i32_rem_s(t,a){return[...t,...a,111]}i32_rem_u(t,a){return[...t,...a,112]}i32_and(t,a){return[...t,...a,113]}i32_or(t,a){return[...t,...a,114]}i32_xor(t,a){return[...t,...a,115]}i32_shl(t,a){return[...t,...a,116]}i32_shr_s(t,a){return[...t,...a,117]}i32_shr_u(t,a){return[...t,...a,118]}i32_rotl(t,a){return[...t,...a,119]}i32_rotr(t,a){return[...t,...a,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}};let T={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};let FunctionBuilder=class FunctionBuilder{constructor(t,a,e,l,o){if("import"==e)this.fnType="import",this.moduleName=l,this.fieldName=o;else if("internal"==e)this.fnType="internal";else throw Error("Invalid function fnType: "+e);this.module=t,this.fnName=a,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,a){if(this.localIdxByName[t])throw Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);let e=this.nextLocal++;this.localIdxByName[t]=e,this.params.push({type:a})}addLocal(t,a,e){if(this.localIdxByName[t])throw Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);let l=this.nextLocal++;this.localIdxByName[t]=l,this.locals.push({type:a,length:e||1})}setReturnType(t){if(this.returnType)throw Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){let t=[...varuint32(this.params.length),...this.params.map(t=>T[t.type])],a=this.returnType?[1,T[this.returnType]]:[0];return[96,...t,...a]}getBody(){let t=this.locals.map(t=>[...varuint32(t.length),T[t.type]]),a=[...varuint32(this.locals.length),...[].concat(...t),...this.code,11];return[...varuint32(a.length),...a]}addCode(...t){this.code.push(...[].concat(...[...t]))}getCodeBuilder(){return new CodeBuilder(this)}};let ModuleBuilder=class ModuleBuilder{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...u32(1836278016),...u32(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(void 0!==this.functionIdxByName[t])throw Error(`Function already defined: ${t}`);let a=this.functions.length;return this.functionIdxByName[t]=a,this.functions.push(new FunctionBuilder(this,t,"internal")),this.nInternalFunctions++,this.functions[a]}addIimportFunction(t,a,e){if(void 0!==this.functionIdxByName[t])throw Error(`Function already defined: ${t}`);if(this.functions.length>0&&"internal"==this.functions[this.functions.length-1].type)throw Error(`Import functions must be declared before internal: ${t}`);let l=e||t,o=this.functions.length;return this.functionIdxByName[t]=o,this.functions.push(new FunctionBuilder(this,t,"import",a,l)),this.nImportFunctions++,this.functions[o]}setMemory(t,a,e){this.memory={pagesSize:t,moduleName:a||"env",fieldName:e||"memory"}}exportFunction(t,a){let e=a||t;if(void 0===this.functionIdxByName[t])throw Error(`Function not defined: ${t}`);let l=this.functionIdxByName[t];e!=t&&(this.functionIdxByName[e]=l),this.exports.push({exportName:e,idx:l})}addFunctionToTable(t){let a=this.functionIdxByName[t];this.functionsTable.push(a)}addData(t,a){this.datas.push({offset:t,bytes:a})}alloc(t,a){let e,l;(Array.isArray(t)||ArrayBuffer.isView(t))&&void 0===a?(e=t.length,l=t):(e=t,l=a),e=(e-1>>3)+1<<3;let o=this.free;return this.free+=e,l&&this.addData(o,l),o}allocString(t){let a=new globalThis.TextEncoder,e=a.encode(t);return this.alloc([...e,0])}_setSignatures(){this.signatures=[];let t={};if(this.functionsTable.length>0){let a=this.functions[this.functionsTable[0]].getSignature(),e="s_"+toHexString(a);t[e]=0,this.signatures.push(a)}for(let a=0;a<this.functions.length;a++){let e=this.functions[a].getSignature(),l="s_"+toHexString(e);void 0===t[l]&&(t[l]=this.signatures.length,this.signatures.push(e)),this.functions[a].signatureIdx=t[l]}}_buildSection(t,a){return[t,...varuint32(a.length),...a]}_buildType(){return this._buildSection(1,[...varuint32(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){let t=[];t.push([...string(this.memory.moduleName),...string(this.memory.fieldName),2,0,...varuint32(this.memory.pagesSize)]);for(let a=0;a<this.nImportFunctions;a++)t.push([...string(this.functions[a].moduleName),...string(this.functions[a].fieldName),0,...varuint32(this.functions[a].signatureIdx)]);return this._buildSection(2,varuint32(t.length).concat(...t))}_buildFunctionDeclarations(){let t=[];for(let a=this.nImportFunctions;a<this.nImportFunctions+this.nInternalFunctions;a++)t.push(...varuint32(this.functions[a].signatureIdx));return this._buildSection(3,[...varuint32(t.length),...t])}_buildFunctionsTable(){return 0==this.functionsTable.length?[]:this._buildSection(4,[...varuint32(1),112,0,...varuint32(this.functionsTable.length)])}_buildElements(){if(0==this.functionsTable.length)return[];let t=[];for(let a=0;a<this.functionsTable.length;a++)t.push(...varuint32(this.functionsTable[a]));return this._buildSection(9,[...varuint32(1),...varuint32(0),65,...varint32(0),11,...varuint32(this.functionsTable.length),...t])}_buildExports(){let t=[];for(let a=0;a<this.exports.length;a++)t.push([...string(this.exports[a].exportName),0,...varuint32(this.exports[a].idx)]);return this._buildSection(7,varuint32(t.length).concat(...t))}_buildCode(){let t=[];for(let a=this.nImportFunctions;a<this.nImportFunctions+this.nInternalFunctions;a++)t.push(this.functions[a].getBody());return this._buildSection(10,varuint32(t.length).concat(...t))}_buildData(){let t=[];t.push([0,65,0,11,4,...u32(this.free)]);for(let a=0;a<this.datas.length;a++)t.push([0,65,...varint32(this.datas[a].offset),11,...varuint32(this.datas[a].bytes.length),...this.datas[a].bytes]);return this._buildSection(11,varuint32(t.length).concat(...t))}};async function buildBn128(t,a){if(!t&&globalThis.curve_bn128)return globalThis.curve_bn128;let e=new ModuleBuilder;e.setMemory(25),buildBn128$1(e),a&&a(e);let l={};l.code=e.build(),l.pq=e.modules.f1m.pq,l.pr=e.modules.frm.pq,l.pG1gen=e.modules.bn128.pG1gen,l.pG1zero=e.modules.bn128.pG1zero,l.pG1b=e.modules.bn128.pG1b,l.pG2gen=e.modules.bn128.pG2gen,l.pG2zero=e.modules.bn128.pG2zero,l.pG2b=e.modules.bn128.pG2b,l.pOneT=e.modules.bn128.pOneT,l.prePSize=e.modules.bn128.prePSize,l.preQSize=e.modules.bn128.preQSize,l.n8q=32,l.n8r=32,l.q=e.modules.bn128.q,l.r=e.modules.bn128.r;let o={name:"bn128",wasm:l,q:fromString("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:fromString("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:fromString("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},i=await buildEngine(o);return i.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=i),i}async function buildBls12381(t,a){if(!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let e=new ModuleBuilder;e.setMemory(25),buildBls12381$1(e),a&&a(e);let l={};l.code=e.build(),l.pq=e.modules.f1m.pq,l.pr=e.modules.frm.pq,l.pG1gen=e.modules.bls12381.pG1gen,l.pG1zero=e.modules.bls12381.pG1zero,l.pG1b=e.modules.bls12381.pG1b,l.pG2gen=e.modules.bls12381.pG2gen,l.pG2zero=e.modules.bls12381.pG2zero,l.pG2b=e.modules.bls12381.pG2b,l.pOneT=e.modules.bls12381.pOneT,l.prePSize=e.modules.bls12381.prePSize,l.preQSize=e.modules.bls12381.preQSize,l.n8q=48,l.n8r=32,l.q=e.modules.bls12381.q,l.r=e.modules.bls12381.r;let o={name:"bls12381",wasm:l,q:fromString("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:fromString("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:fromString("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:fromString("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},i=await buildEngine(o);return i.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=i),i}async function getCurveFromName(t,a,e){let l;let o=t.toUpperCase().match(/[A-Za-z0-9]+/g).join("");if(["BN128","BN254","ALTBN128"].indexOf(o)>=0)l=await buildBn128(a,e);else if(["BLS12381"].indexOf(o)>=0)l=await buildBls12381(a,e);else throw Error(`Curve not supported: ${t}`);return l}globalThis.curve_bn128=null,globalThis.curve_bls12381=null,fromString("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),fromString("21888242871839275222246405745257275088548364400416034343698204186575808495617"),fromString("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),fromString("21888242871839275222246405745257275088696311157297823662689037894645226208583");let z=n,R=E}}]);